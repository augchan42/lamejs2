var I0=(x,F)=>()=>(F||x((F={exports:{}}).exports,F),F.exports);var k0=I0((an,ja)=>{"use strict";function wt(x){return new Int8Array(x)}function Da(x){return new Int16Array(x)}function Ga(x){return new Int32Array(x)}function Ua(x){return new Float32Array(x)}function Bt(x){return new Float64Array(x)}function Ka(x){if(x.length==1)return Ua(x[0]);var F=x[0];x=x.slice(1);for(var G=[],Y=0;Y<F;Y++)G.push(Ka(x));return G}function Za(x){if(x.length==1)return Ga(x[0]);var F=x[0];x=x.slice(1);for(var G=[],Y=0;Y<F;Y++)G.push(Za(x));return G}function Pa(x){if(x.length==1)return Da(x[0]);var F=x[0];x=x.slice(1);for(var G=[],Y=0;Y<F;Y++)G.push(Pa(x));return G}function Qa(x){if(x.length==1)return new Array(x[0]);var F=x[0];x=x.slice(1);for(var G=[],Y=0;Y<F;Y++)G.push(Qa(x));return G}var Wa={};Wa.fill=function(x,F,G,Y){if(arguments.length==2)for(var l0=0;l0<x.length;l0++)x[l0]=arguments[1];else for(var l0=F;l0<G;l0++)x[l0]=Y};var Ne={};Ne.arraycopy=function(x,F,G,Y,l0){for(var q=F+l0;F<q;)G[Y++]=x[F++]};Ne.out={};Ne.out.println=function(x){console.log(x)};Ne.out.printf=function(){console.log.apply(console,arguments)};var Ue={};Ue.SQRT2=1.4142135623730951;Ue.FAST_LOG10=function(x){return Math.log10(x)};Ue.FAST_LOG10_X=function(x,F){return Math.log10(x)*F};function ee(x){this.ordinal=x}ee.short_block_allowed=new ee(0);ee.short_block_coupled=new ee(1);ee.short_block_dispensed=new ee(2);ee.short_block_forced=new ee(3);var za={};za.MAX_VALUE=34028235e31;function F1(x){this.ordinal=x}F1.vbr_off=new F1(0);F1.vbr_mt=new F1(1);F1.vbr_rh=new F1(2);F1.vbr_abr=new F1(3);F1.vbr_mtrh=new F1(4);F1.vbr_default=F1.vbr_mtrh;var Et=function(x){};ja.exports={System:Ne,VbrMode:F1,Float:za,ShortBlock:ee,Util:Ue,Arrays:Wa,new_array_n:Qa,new_byte:wt,new_double:Bt,new_float:Ua,new_float_n:Ka,new_int:Ga,new_int_n:Za,new_short:Da,new_short_n:Pa,assert:Et}});var $a=I0((fn,Ja)=>{"use strict";var o1=k0(),yt=o1.System,rn=o1.VbrMode,tn=o1.Float,nn=o1.ShortBlock,G0=o1.Util,Tt=o1.Arrays,sn=o1.new_array_n,_n=o1.new_byte,ln=o1.new_double,It=o1.new_float,vn=o1.new_float_n,on=o1.new_int,un=o1.new_int_n,hn=o1.assert,k1=a1();function pt(){var x=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*G0.SQRT2*.5/2384e-9,.017876148*G0.SQRT2*.5/2384e-9,.003134727*G0.SQRT2*.5/2384e-9,.002457142*G0.SQRT2*.5/2384e-9,971317e-9*G0.SQRT2*.5/2384e-9,218868e-9*G0.SQRT2*.5/2384e-9,101566e-9*G0.SQRT2*.5/2384e-9,13828e-9*G0.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],F=12,G=36,Y=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],l0=Y[k1.SHORT_TYPE],q=Y[k1.SHORT_TYPE],r0=Y[k1.SHORT_TYPE],j=Y[k1.SHORT_TYPE],n0=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function o0(T,I,e){for(var R=10,m=I+238-14-286,c=-15;c<0;c++){var o,b,N;o=x[R+-10],b=T[m+-224]*o,N=T[I+224]*o,o=x[R+-9],b+=T[m+-160]*o,N+=T[I+160]*o,o=x[R+-8],b+=T[m+-96]*o,N+=T[I+96]*o,o=x[R+-7],b+=T[m+-32]*o,N+=T[I+32]*o,o=x[R+-6],b+=T[m+32]*o,N+=T[I+-32]*o,o=x[R+-5],b+=T[m+96]*o,N+=T[I+-96]*o,o=x[R+-4],b+=T[m+160]*o,N+=T[I+-160]*o,o=x[R+-3],b+=T[m+224]*o,N+=T[I+-224]*o,o=x[R+-2],b+=T[I+-256]*o,N-=T[m+256]*o,o=x[R+-1],b+=T[I+-192]*o,N-=T[m+192]*o,o=x[R+0],b+=T[I+-128]*o,N-=T[m+128]*o,o=x[R+1],b+=T[I+-64]*o,N-=T[m+64]*o,o=x[R+2],b+=T[I+0]*o,N-=T[m+0]*o,o=x[R+3],b+=T[I+64]*o,N-=T[m+-64]*o,o=x[R+4],b+=T[I+128]*o,N-=T[m+-128]*o,o=x[R+5],b+=T[I+192]*o,N-=T[m+-192]*o,b*=x[R+6],o=N-b,e[30+c*2]=N+b,e[31+c*2]=x[R+7]*o,R+=18,I--,m++}{var b,N,S,w;N=T[I+-16]*x[R+-10],b=T[I+-32]*x[R+-2],N+=(T[I+-48]-T[I+16])*x[R+-9],b+=T[I+-96]*x[R+-1],N+=(T[I+-80]+T[I+48])*x[R+-8],b+=T[I+-160]*x[R+0],N+=(T[I+-112]-T[I+80])*x[R+-7],b+=T[I+-224]*x[R+1],N+=(T[I+-144]+T[I+112])*x[R+-6],b-=T[I+32]*x[R+2],N+=(T[I+-176]-T[I+144])*x[R+-5],b-=T[I+96]*x[R+3],N+=(T[I+-208]+T[I+176])*x[R+-4],b-=T[I+160]*x[R+4],N+=(T[I+-240]-T[I+208])*x[R+-3],b-=T[I+224],S=b-N,w=b+N,N=e[14],b=e[15]-N,e[31]=w+N,e[30]=S+b,e[15]=S-b,e[14]=w-N}{var l;l=e[28]-e[0],e[0]+=e[28],e[28]=l*x[R+-2*18+7],l=e[29]-e[1],e[1]+=e[29],e[29]=l*x[R+-2*18+7],l=e[26]-e[2],e[2]+=e[26],e[26]=l*x[R+-4*18+7],l=e[27]-e[3],e[3]+=e[27],e[27]=l*x[R+-4*18+7],l=e[24]-e[4],e[4]+=e[24],e[24]=l*x[R+-6*18+7],l=e[25]-e[5],e[5]+=e[25],e[25]=l*x[R+-6*18+7],l=e[22]-e[6],e[6]+=e[22],e[22]=l*G0.SQRT2,l=e[23]-e[7],e[7]+=e[23],e[23]=l*G0.SQRT2-e[7],e[7]-=e[6],e[22]-=e[7],e[23]-=e[22],l=e[6],e[6]=e[31]-l,e[31]=e[31]+l,l=e[7],e[7]=e[30]-l,e[30]=e[30]+l,l=e[22],e[22]=e[15]-l,e[15]=e[15]+l,l=e[23],e[23]=e[14]-l,e[14]=e[14]+l,l=e[20]-e[8],e[8]+=e[20],e[20]=l*x[R+-10*18+7],l=e[21]-e[9],e[9]+=e[21],e[21]=l*x[R+-10*18+7],l=e[18]-e[10],e[10]+=e[18],e[18]=l*x[R+-12*18+7],l=e[19]-e[11],e[11]+=e[19],e[19]=l*x[R+-12*18+7],l=e[16]-e[12],e[12]+=e[16],e[16]=l*x[R+-14*18+7],l=e[17]-e[13],e[13]+=e[17],e[17]=l*x[R+-14*18+7],l=-e[20]+e[24],e[20]+=e[24],e[24]=l*x[R+-12*18+7],l=-e[21]+e[25],e[21]+=e[25],e[25]=l*x[R+-12*18+7],l=e[4]-e[8],e[4]+=e[8],e[8]=l*x[R+-12*18+7],l=e[5]-e[9],e[5]+=e[9],e[9]=l*x[R+-12*18+7],l=e[0]-e[12],e[0]+=e[12],e[12]=l*x[R+-4*18+7],l=e[1]-e[13],e[1]+=e[13],e[13]=l*x[R+-4*18+7],l=e[16]-e[28],e[16]+=e[28],e[28]=l*x[R+-4*18+7],l=-e[17]+e[29],e[17]+=e[29],e[29]=l*x[R+-4*18+7],l=G0.SQRT2*(e[2]-e[10]),e[2]+=e[10],e[10]=l,l=G0.SQRT2*(e[3]-e[11]),e[3]+=e[11],e[11]=l,l=G0.SQRT2*(-e[18]+e[26]),e[18]+=e[26],e[26]=l-e[18],l=G0.SQRT2*(-e[19]+e[27]),e[19]+=e[27],e[27]=l-e[19],l=e[2],e[19]-=e[3],e[3]-=l,e[2]=e[31]-l,e[31]+=l,l=e[3],e[11]-=e[19],e[18]-=l,e[3]=e[30]-l,e[30]+=l,l=e[18],e[27]-=e[11],e[19]-=l,e[18]=e[15]-l,e[15]+=l,l=e[19],e[10]-=l,e[19]=e[14]-l,e[14]+=l,l=e[10],e[11]-=l,e[10]=e[23]-l,e[23]+=l,l=e[11],e[26]-=l,e[11]=e[22]-l,e[22]+=l,l=e[26],e[27]-=l,e[26]=e[7]-l,e[7]+=l,l=e[27],e[27]=e[6]-l,e[6]+=l,l=G0.SQRT2*(e[0]-e[4]),e[0]+=e[4],e[4]=l,l=G0.SQRT2*(e[1]-e[5]),e[1]+=e[5],e[5]=l,l=G0.SQRT2*(e[16]-e[20]),e[16]+=e[20],e[20]=l,l=G0.SQRT2*(e[17]-e[21]),e[17]+=e[21],e[21]=l,l=-G0.SQRT2*(e[8]-e[12]),e[8]+=e[12],e[12]=l-e[8],l=-G0.SQRT2*(e[9]-e[13]),e[9]+=e[13],e[13]=l-e[9],l=-G0.SQRT2*(e[25]-e[29]),e[25]+=e[29],e[29]=l-e[25],l=-G0.SQRT2*(e[24]+e[28]),e[24]-=e[28],e[28]=l-e[24],l=e[24]-e[16],e[24]=l,l=e[20]-l,e[20]=l,l=e[28]-l,e[28]=l,l=e[25]-e[17],e[25]=l,l=e[21]-l,e[21]=l,l=e[29]-l,e[29]=l,l=e[17]-e[1],e[17]=l,l=e[9]-l,e[9]=l,l=e[25]-l,e[25]=l,l=e[5]-l,e[5]=l,l=e[21]-l,e[21]=l,l=e[13]-l,e[13]=l,l=e[29]-l,e[29]=l,l=e[1]-e[0],e[1]=l,l=e[16]-l,e[16]=l,l=e[17]-l,e[17]=l,l=e[8]-l,e[8]=l,l=e[9]-l,e[9]=l,l=e[24]-l,e[24]=l,l=e[25]-l,e[25]=l,l=e[4]-l,e[4]=l,l=e[5]-l,e[5]=l,l=e[20]-l,e[20]=l,l=e[21]-l,e[21]=l,l=e[12]-l,e[12]=l,l=e[13]-l,e[13]=l,l=e[28]-l,e[28]=l,l=e[29]-l,e[29]=l,l=e[0],e[0]+=e[31],e[31]-=l,l=e[1],e[1]+=e[30],e[30]-=l,l=e[16],e[16]+=e[15],e[15]-=l,l=e[17],e[17]+=e[14],e[14]-=l,l=e[8],e[8]+=e[23],e[23]-=l,l=e[9],e[9]+=e[22],e[22]-=l,l=e[24],e[24]+=e[7],e[7]-=l,l=e[25],e[25]+=e[6],e[6]-=l,l=e[4],e[4]+=e[27],e[27]-=l,l=e[5],e[5]+=e[26],e[26]-=l,l=e[20],e[20]+=e[11],e[11]-=l,l=e[21],e[21]+=e[10],e[10]-=l,l=e[12],e[12]+=e[19],e[19]-=l,l=e[13],e[13]+=e[18],e[18]-=l,l=e[28],e[28]+=e[3],e[3]-=l,l=e[29],e[29]+=e[2],e[2]-=l}}function V(T,I){for(var e=0;e<3;e++){var R,m,c,o,b,N;o=T[I+2*3]*Y[k1.SHORT_TYPE][0]-T[I+5*3],R=T[I+0*3]*Y[k1.SHORT_TYPE][2]-T[I+3*3],m=o+R,c=o-R,o=T[I+5*3]*Y[k1.SHORT_TYPE][0]+T[I+2*3],R=T[I+3*3]*Y[k1.SHORT_TYPE][2]+T[I+0*3],b=o+R,N=-o+R,R=(T[I+1*3]*Y[k1.SHORT_TYPE][1]-T[I+4*3])*2069978111953089e-26,o=(T[I+4*3]*Y[k1.SHORT_TYPE][1]+T[I+1*3])*2069978111953089e-26,T[I+3*0]=m*190752519173728e-25+R,T[I+3*5]=-b*190752519173728e-25+o,c=c*.8660254037844387*1907525191737281e-26,b=b*.5*1907525191737281e-26+o,T[I+3*1]=c-b,T[I+3*2]=c+b,m=m*.5*1907525191737281e-26-R,N=N*.8660254037844387*1907525191737281e-26,T[I+3*3]=m+N,T[I+3*4]=m-N,I++}}function U(T,I,e){var R,m;{var c,o,b,N,S,w,l,u;c=e[17]-e[9],b=e[15]-e[11],N=e[14]-e[12],S=e[0]+e[8],w=e[1]+e[7],l=e[2]+e[6],u=e[3]+e[5],T[I+17]=S+l-u-(w-e[4]),m=(S+l-u)*q[19]+(w-e[4]),R=(c-b-N)*q[18],T[I+5]=R+m,T[I+6]=R-m,o=(e[16]-e[10])*q[18],w=w*q[19]+e[4],R=c*q[12]+o+b*q[13]+N*q[14],m=-S*q[16]+w-l*q[17]+u*q[15],T[I+1]=R+m,T[I+2]=R-m,R=c*q[13]-o-b*q[14]+N*q[12],m=-S*q[17]+w-l*q[15]+u*q[16],T[I+9]=R+m,T[I+10]=R-m,R=c*q[14]-o+b*q[12]-N*q[13],m=S*q[15]-w+l*q[16]-u*q[17],T[I+13]=R+m,T[I+14]=R-m}{var B,s,_,a,r,n,i,d;B=e[8]-e[0],_=e[6]-e[2],a=e[5]-e[3],r=e[17]+e[9],n=e[16]+e[10],i=e[15]+e[11],d=e[14]+e[12],T[I+0]=r+i+d+(n+e[13]),R=(r+i+d)*q[19]-(n+e[13]),m=(B-_+a)*q[18],T[I+11]=R+m,T[I+12]=R-m,s=(e[7]-e[1])*q[18],n=e[13]-n*q[19],R=r*q[15]-n+i*q[16]+d*q[17],m=B*q[14]+s+_*q[12]+a*q[13],T[I+3]=R+m,T[I+4]=R-m,R=-r*q[17]+n-i*q[15]-d*q[16],m=B*q[13]+s-_*q[14]-a*q[12],T[I+7]=R+m,T[I+8]=R-m,R=-r*q[16]+n-i*q[17]-d*q[15],m=B*q[12]-s+_*q[13]-a*q[14],T[I+15]=R+m,T[I+16]=R-m}}this.mdct_sub48=function(T,I,e){for(var R=I,m=286,c=0;c<T.channels_out;c++){for(var o=0;o<T.mode_gr;o++){for(var b,N=T.l3_side.tt[o][c],S=N.xr,w=0,l=T.sb_sample[c][1-o],u=0,B=0;B<18/2;B++)for(o0(R,m,l[u]),o0(R,m+32,l[u+1]),u+=2,m+=64,b=1;b<32;b+=2)l[u-1][b]*=-1;for(b=0;b<32;b++,w+=18){var s=N.block_type,_=T.sb_sample[c][o],a=T.sb_sample[c][1-o];if(N.mixed_block_flag!=0&&b<2&&(s=0),T.amp_filter[b]<1e-12)Tt.fill(S,w+0,w+18,0);else{if(T.amp_filter[b]<1)for(var B=0;B<18;B++)a[B][n0[b]]*=T.amp_filter[b];if(s==k1.SHORT_TYPE){for(var B=-F/4;B<0;B++){var r=Y[k1.SHORT_TYPE][B+3];S[w+B*3+9]=_[9+B][n0[b]]*r-_[8-B][n0[b]],S[w+B*3+18]=_[14-B][n0[b]]*r+_[15+B][n0[b]],S[w+B*3+10]=_[15+B][n0[b]]*r-_[14-B][n0[b]],S[w+B*3+19]=a[2-B][n0[b]]*r+a[3+B][n0[b]],S[w+B*3+11]=a[3+B][n0[b]]*r-a[2-B][n0[b]],S[w+B*3+20]=a[8-B][n0[b]]*r+a[9+B][n0[b]]}V(S,w)}else{for(var n=It(18),B=-G/4;B<0;B++){var i,d;i=Y[s][B+27]*a[B+9][n0[b]]+Y[s][B+36]*a[8-B][n0[b]],d=Y[s][B+9]*_[B+9][n0[b]]-Y[s][B+18]*_[8-B][n0[b]],n[B+9]=i-d*l0[3+B+9],n[B+18]=i*l0[3+B+9]+d}U(S,w,n)}}if(s!=k1.SHORT_TYPE&&b!=0)for(var B=7;B>=0;--B){var E,M;E=S[w+B]*r0[20+B]+S[w+-1-B]*j[28+B],M=S[w+B]*j[28+B]-S[w+-1-B]*r0[20+B],S[w+-1-B]=E,S[w+B]=M}}}if(R=e,m=286,T.mode_gr==1)for(var L=0;L<18;L++)yt.arraycopy(T.sb_sample[c][1][L],0,T.sb_sample[c][0][L],0,32)}}}Ja.exports=pt});var ba=I0((En,ga)=>{"use strict";var Ke=a1(),u1=k0(),Lt=u1.System,bn=u1.VbrMode,mn=u1.Float,cn=u1.ShortBlock,Sn=u1.Util,dn=u1.Arrays,An=u1.new_array_n,xn=u1.new_byte,Mn=u1.new_double,Vt=u1.new_float,Nt=u1.new_float_n,Rn=u1.new_int,wn=u1.new_int_n,Bn=u1.assert;function Ht(){this.l=Vt(Ke.SBMAX_l),this.s=Nt([Ke.SBMAX_s,3]);var x=this;this.assign=function(F){Lt.arraycopy(F.l,0,x.l,0,Ke.SBMAX_l);for(var G=0;G<Ke.SBMAX_s;G++)for(var Y=0;Y<3;Y++)x.s[G][Y]=F.s[G][Y]}}ga.exports=Ht});var rr=I0((yn,ar)=>{"use strict";var er=ba();function Ot(){this.thm=new er,this.en=new er}ar.exports=Ot});var He=I0((Tn,tr)=>{"use strict";function W1(x){var F=x;this.ordinal=function(){return F}}W1.STEREO=new W1(0);W1.JOINT_STEREO=new W1(1);W1.DUAL_CHANNEL=new W1(2);W1.MONO=new W1(3);W1.NOT_SET=new W1(4);tr.exports=W1});var a1=I0((Cn,_r)=>{"use strict";var h1=k0(),nr=h1.System,Ze=h1.VbrMode,In=h1.Float,pn=h1.ShortBlock,Ln=h1.Util,Vn=h1.Arrays,ir=h1.new_array_n,Nn=h1.new_byte,Hn=h1.new_double,sr=h1.new_float,Ct=h1.new_float_n,Ft=h1.new_int,On=h1.new_int_n,Oe=h1.assert;E0.ENCDELAY=576;E0.POSTDELAY=1152;E0.MDCTDELAY=48;E0.FFTOFFSET=224+E0.MDCTDELAY;E0.DECDELAY=528;E0.SBLIMIT=32;E0.CBANDS=64;E0.SBPSY_l=21;E0.SBPSY_s=12;E0.SBMAX_l=22;E0.SBMAX_s=13;E0.PSFB21=6;E0.PSFB12=6;E0.BLKSIZE=1024;E0.HBLKSIZE=E0.BLKSIZE/2+1;E0.BLKSIZE_s=256;E0.HBLKSIZE_s=E0.BLKSIZE_s/2+1;E0.NORM_TYPE=0;E0.START_TYPE=1;E0.SHORT_TYPE=2;E0.STOP_TYPE=3;E0.MPG_MD_LR_LR=0;E0.MPG_MD_LR_I=1;E0.MPG_MD_MS_LR=2;E0.MPG_MD_MS_I=3;E0.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function E0(){var x=$a(),F=rr(),G=He(),Y=E0.FFTOFFSET,l0=E0.MPG_MD_MS_LR,q=null;this.psy=null;var r0=null,j=null,n0=null;this.setModules=function(I,e,R,m){q=I,this.psy=e,r0=e,j=m,n0=R};var o0=new x;function V(I){var e,R;if(I.ATH.useAdjust==0){I.ATH.adjust=1;return}if(R=I.loudness_sq[0][0],e=I.loudness_sq[1][0],I.channels_out==2?(R+=I.loudness_sq[0][1],e+=I.loudness_sq[1][1]):(R+=R,e+=e),I.mode_gr==2&&(R=Math.max(R,e)),R*=.5,R*=I.ATH.aaSensitivityP,R>.03125)I.ATH.adjust>=1?I.ATH.adjust=1:I.ATH.adjust<I.ATH.adjustLimit&&(I.ATH.adjust=I.ATH.adjustLimit),I.ATH.adjustLimit=1;else{var m=31.98*R+625e-6;I.ATH.adjust>=m?(I.ATH.adjust*=m*.075+.925,I.ATH.adjust<m&&(I.ATH.adjust=m)):I.ATH.adjustLimit>=m?I.ATH.adjust=m:I.ATH.adjust<I.ATH.adjustLimit&&(I.ATH.adjust=I.ATH.adjustLimit),I.ATH.adjustLimit=m}}function U(I){var e,R;for(Oe(0<=I.bitrate_index&&I.bitrate_index<16),Oe(0<=I.mode_ext&&I.mode_ext<4),I.bitrate_stereoMode_Hist[I.bitrate_index][4]++,I.bitrate_stereoMode_Hist[15][4]++,I.channels_out==2&&(I.bitrate_stereoMode_Hist[I.bitrate_index][I.mode_ext]++,I.bitrate_stereoMode_Hist[15][I.mode_ext]++),e=0;e<I.mode_gr;++e)for(R=0;R<I.channels_out;++R){var m=I.l3_side.tt[e][R].block_type|0;I.l3_side.tt[e][R].mixed_block_flag!=0&&(m=4),I.bitrate_blockType_Hist[I.bitrate_index][m]++,I.bitrate_blockType_Hist[I.bitrate_index][5]++,I.bitrate_blockType_Hist[15][m]++,I.bitrate_blockType_Hist[15][5]++}}function T(I,e){var R=I.internal_flags,m,c;if(R.lame_encode_frame_init==0){var o,b,N=sr(2014),S=sr(2014);for(R.lame_encode_frame_init=1,o=0,b=0;o<286+576*(1+R.mode_gr);++o)o<576*R.mode_gr?(N[o]=0,R.channels_out==2&&(S[o]=0)):(N[o]=e[0][b],R.channels_out==2&&(S[o]=e[1][b]),++b);for(c=0;c<R.mode_gr;c++)for(m=0;m<R.channels_out;m++)R.l3_side.tt[c][m].block_type=E0.SHORT_TYPE;o0.mdct_sub48(R,N,S),Oe(576>=E0.FFTOFFSET),Oe(R.mf_size>=E0.BLKSIZE+I.framesize-E0.FFTOFFSET),Oe(R.mf_size>=512+I.framesize-32)}}this.lame_encode_mp3_frame=function(I,e,R,m,c,o){var b,N=ir([2,2]);N[0][0]=new F,N[0][1]=new F,N[1][0]=new F,N[1][1]=new F;var S=ir([2,2]);S[0][0]=new F,S[0][1]=new F,S[1][0]=new F,S[1][1]=new F;var w,l=[null,null],u=I.internal_flags,B=Ct([2,4]),s=[.5,.5],_=[[0,0],[0,0]],a=[[0,0],[0,0]],r,n,i;if(l[0]=e,l[1]=R,u.lame_encode_frame_init==0&&T(I,l),u.padding=0,(u.slot_lag-=u.frac_SpF)<0&&(u.slot_lag+=I.out_samplerate,u.padding=1),u.psymodel!=0){var d,E=[null,null],M=0,L=Ft(2);for(i=0;i<u.mode_gr;i++){for(n=0;n<u.channels_out;n++)E[n]=l[n],M=576+i*576-E0.FFTOFFSET;if(I.VBR==Ze.vbr_mtrh||I.VBR==Ze.vbr_mt?d=r0.L3psycho_anal_vbr(I,E,M,i,N,S,_[i],a[i],B[i],L):d=r0.L3psycho_anal_ns(I,E,M,i,N,S,_[i],a[i],B[i],L),d!=0)return-4;for(I.mode==G.JOINT_STEREO&&(s[i]=B[i][2]+B[i][3],s[i]>0&&(s[i]=B[i][3]/s[i])),n=0;n<u.channels_out;n++){var Q=u.l3_side.tt[i][n];Q.block_type=L[n],Q.mixed_block_flag=0}}}else for(i=0;i<u.mode_gr;i++)for(n=0;n<u.channels_out;n++)u.l3_side.tt[i][n].block_type=E0.NORM_TYPE,u.l3_side.tt[i][n].mixed_block_flag=0,a[i][n]=_[i][n]=700;if(V(u),o0.mdct_sub48(u,l[0],l[1]),u.mode_ext=E0.MPG_MD_LR_LR,I.force_ms)u.mode_ext=E0.MPG_MD_MS_LR;else if(I.mode==G.JOINT_STEREO){var t0=0,t=0;for(i=0;i<u.mode_gr;i++)for(n=0;n<u.channels_out;n++)t0+=a[i][n],t+=_[i][n];if(t0<=1*t){var v=u.l3_side.tt[0],z=u.l3_side.tt[u.mode_gr-1];v[0].block_type==v[1].block_type&&z[0].block_type==z[1].block_type&&(u.mode_ext=E0.MPG_MD_MS_LR)}}if(u.mode_ext==l0?(w=S,r=a):(w=N,r=_),I.analysis&&u.pinfo!=null)for(i=0;i<u.mode_gr;i++)for(n=0;n<u.channels_out;n++)u.pinfo.ms_ratio[i]=u.ms_ratio[i],u.pinfo.ms_ener_ratio[i]=s[i],u.pinfo.blocktype[i][n]=u.l3_side.tt[i][n].block_type,u.pinfo.pe[i][n]=r[i][n],nr.arraycopy(u.l3_side.tt[i][n].xr,0,u.pinfo.xr[i][n],0,576),u.mode_ext==l0&&(u.pinfo.ers[i][n]=u.pinfo.ers[i][n+2],nr.arraycopy(u.pinfo.energy[i][n+2],0,u.pinfo.energy[i][n],0,u.pinfo.energy[i][n].length));if(I.VBR==Ze.vbr_off||I.VBR==Ze.vbr_abr){var W,e0;for(W=0;W<18;W++)u.nsPsy.pefirbuf[W]=u.nsPsy.pefirbuf[W+1];for(e0=0,i=0;i<u.mode_gr;i++)for(n=0;n<u.channels_out;n++)e0+=r[i][n];for(u.nsPsy.pefirbuf[18]=e0,e0=u.nsPsy.pefirbuf[9],W=0;W<9;W++)e0+=(u.nsPsy.pefirbuf[W]+u.nsPsy.pefirbuf[18-W])*E0.fircoef[W];for(e0=670*5*u.mode_gr*u.channels_out/e0,i=0;i<u.mode_gr;i++)for(n=0;n<u.channels_out;n++)r[i][n]*=e0}if(u.iteration_loop.iteration_loop(I,r,s,w),q.format_bitstream(I),b=q.copy_buffer(u,m,c,o,1),I.bWriteVbrTag&&j.addVbrFrame(I),I.analysis&&u.pinfo!=null){for(n=0;n<u.channels_out;n++){var s0;for(s0=0;s0<Y;s0++)u.pinfo.pcmdata[n][s0]=u.pinfo.pcmdata[n][s0+I.framesize];for(s0=Y;s0<1600;s0++)u.pinfo.pcmdata[n][s0]=l[n][s0-Y]}n0.set_frame_pinfo(I,w)}return U(u),b}}_r.exports=E0});var ur=I0((Wn,or)=>{"use strict";var f1=k0(),Fn=f1.System,kn=f1.VbrMode,qn=f1.Float,Xn=f1.ShortBlock,lr=f1.Util,Yn=f1.Arrays,Dn=f1.new_array_n,Gn=f1.new_byte,Un=f1.new_double,vr=f1.new_float,Kn=f1.new_float_n,Zn=f1.new_int,Pn=f1.new_int_n,Qn=f1.assert,W0=a1();function kt(){var x=vr(W0.BLKSIZE),F=vr(W0.BLKSIZE_s/2),G=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function Y(q,r0,j){var n0=0,o0,V,U;j<<=1;var T=r0+j;o0=4;do{var I,e,R,m,c,o,b;b=o0>>1,m=o0,c=o0<<1,o=c+m,o0=c<<1,V=r0,U=V+b;do{var N,S,w,l;S=q[V+0]-q[V+m],N=q[V+0]+q[V+m],l=q[V+c]-q[V+o],w=q[V+c]+q[V+o],q[V+c]=N-w,q[V+0]=N+w,q[V+o]=S-l,q[V+m]=S+l,S=q[U+0]-q[U+m],N=q[U+0]+q[U+m],l=lr.SQRT2*q[U+o],w=lr.SQRT2*q[U+c],q[U+c]=N-w,q[U+0]=N+w,q[U+o]=S-l,q[U+m]=S+l,U+=o0,V+=o0}while(V<T);for(e=G[n0+0],I=G[n0+1],R=1;R<b;R++){var u,B;u=1-2*I*I,B=2*I*e,V=r0+R,U=r0+m-R;do{var s,_,a,N,S,r,w,n,l,i;_=B*q[V+m]-u*q[U+m],s=u*q[V+m]+B*q[U+m],S=q[V+0]-s,N=q[V+0]+s,r=q[U+0]-_,a=q[U+0]+_,_=B*q[V+o]-u*q[U+o],s=u*q[V+o]+B*q[U+o],l=q[V+c]-s,w=q[V+c]+s,i=q[U+c]-_,n=q[U+c]+_,_=I*w-e*i,s=e*w+I*i,q[V+c]=N-s,q[V+0]=N+s,q[U+o]=r-_,q[U+m]=r+_,_=e*n-I*l,s=I*n+e*l,q[U+c]=a-s,q[U+0]=a+s,q[V+o]=S-_,q[V+m]=S+_,U+=o0,V+=o0}while(V<T);u=e,e=u*G[n0+0]-I*G[n0+1],I=u*G[n0+1]+I*G[n0+0]}n0+=2}while(o0<j)}var l0=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(q,r0,j,n0,o0){for(var V=0;V<3;V++){var U=W0.BLKSIZE_s/2,T=65535&576/3*(V+1),I=W0.BLKSIZE_s/8-1;do{var e,R,m,c,o,b=l0[I<<2]&255;e=F[b]*n0[j][o0+b+T],o=F[127-b]*n0[j][o0+b+T+128],R=e-o,e=e+o,m=F[b+64]*n0[j][o0+b+T+64],o=F[63-b]*n0[j][o0+b+T+192],c=m-o,m=m+o,U-=4,r0[V][U+0]=e+m,r0[V][U+2]=e-m,r0[V][U+1]=R+c,r0[V][U+3]=R-c,e=F[b+1]*n0[j][o0+b+T+1],o=F[126-b]*n0[j][o0+b+T+129],R=e-o,e=e+o,m=F[b+65]*n0[j][o0+b+T+65],o=F[62-b]*n0[j][o0+b+T+193],c=m-o,m=m+o,r0[V][U+W0.BLKSIZE_s/2+0]=e+m,r0[V][U+W0.BLKSIZE_s/2+2]=e-m,r0[V][U+W0.BLKSIZE_s/2+1]=R+c,r0[V][U+W0.BLKSIZE_s/2+3]=R-c}while(--I>=0);Y(r0[V],U,W0.BLKSIZE_s/2)}},this.fft_long=function(q,r0,j,n0,o0){var V=W0.BLKSIZE/8-1,U=W0.BLKSIZE/2;do{var T,I,e,R,m,c=l0[V]&255;T=x[c]*n0[j][o0+c],m=x[c+512]*n0[j][o0+c+512],I=T-m,T=T+m,e=x[c+256]*n0[j][o0+c+256],m=x[c+768]*n0[j][o0+c+768],R=e-m,e=e+m,U-=4,r0[U+0]=T+e,r0[U+2]=T-e,r0[U+1]=I+R,r0[U+3]=I-R,T=x[c+1]*n0[j][o0+c+1],m=x[c+513]*n0[j][o0+c+513],I=T-m,T=T+m,e=x[c+257]*n0[j][o0+c+257],m=x[c+769]*n0[j][o0+c+769],R=e-m,e=e+m,r0[U+W0.BLKSIZE/2+0]=T+e,r0[U+W0.BLKSIZE/2+2]=T-e,r0[U+W0.BLKSIZE/2+1]=I+R,r0[U+W0.BLKSIZE/2+3]=I-R}while(--V>=0);Y(r0,U,W0.BLKSIZE/2)},this.init_fft=function(q){for(var r0=0;r0<W0.BLKSIZE;r0++)x[r0]=.42-.5*Math.cos(2*Math.PI*(r0+.5)/W0.BLKSIZE)+.08*Math.cos(4*Math.PI*(r0+.5)/W0.BLKSIZE);for(var r0=0;r0<W0.BLKSIZE_s/2;r0++)F[r0]=.5*(1-Math.cos(2*Math.PI*(r0+.5)/W0.BLKSIZE_s))}}or.exports=kt});var br=I0((ei,fr)=>{"use strict";var m1=k0(),zn=m1.System,Be=m1.VbrMode,hr=m1.Float,Ee=m1.ShortBlock,b1=m1.Util,qt=m1.Arrays,jn=m1.new_array_n,Jn=m1.new_byte,$n=m1.new_double,z0=m1.new_float,Y1=m1.new_float_n,ue=m1.new_int,gn=m1.new_int_n,f0=m1.assert,Xt=ur(),K=a1();function Yt(){var x=He(),F=new Xt,G=2.302585092994046,Y=2,l0=16,q=2,r0=16,j=.34,n0=1/(14752*14752)/(K.BLKSIZE/2),o0=.01,V=.8,U=.6,T=.3,I=3.5,e=4.4,R=25,m=21,c=.2302585093;function o(h){return h}function b(h,f){for(var y=0,p=0;p<K.BLKSIZE/2;++p)y+=h[p]*f.ATH.eql_w[p];return y*=n0,y}function N(h,f,y,p,C,A,O,k,H,Z,X){var P=h.internal_flags;if(H<2)F.fft_long(P,p[C],H,Z,X),F.fft_short(P,A[O],H,Z,X);else if(H==2){for(var _0=K.BLKSIZE-1;_0>=0;--_0){var x0=p[C+0][_0],J=p[C+1][_0];p[C+0][_0]=(x0+J)*b1.SQRT2*.5,p[C+1][_0]=(x0-J)*b1.SQRT2*.5}for(var S0=2;S0>=0;--S0)for(var _0=K.BLKSIZE_s-1;_0>=0;--_0){var x0=A[O+0][S0][_0],J=A[O+1][S0][_0];A[O+0][S0][_0]=(x0+J)*b1.SQRT2*.5,A[O+1][S0][_0]=(x0-J)*b1.SQRT2*.5}}f[0]=p[C+0][0],f[0]*=f[0];for(var _0=K.BLKSIZE/2-1;_0>=0;--_0){var D=p[C+0][K.BLKSIZE/2-_0],h0=p[C+0][K.BLKSIZE/2+_0];f[K.BLKSIZE/2-_0]=(D*D+h0*h0)*.5}for(var S0=2;S0>=0;--S0){y[S0][0]=A[O+0][S0][0],y[S0][0]*=y[S0][0];for(var _0=K.BLKSIZE_s/2-1;_0>=0;--_0){var D=A[O+0][S0][K.BLKSIZE_s/2-_0],h0=A[O+0][S0][K.BLKSIZE_s/2+_0];y[S0][K.BLKSIZE_s/2-_0]=(D*D+h0*h0)*.5}}{for(var w0=0,_0=11;_0<K.HBLKSIZE;_0++)w0+=f[_0];P.tot_ener[H]=w0}if(h.analysis){for(var _0=0;_0<K.HBLKSIZE;_0++)P.pinfo.energy[k][H][_0]=P.pinfo.energy_save[H][_0],P.pinfo.energy_save[H][_0]=f[_0];P.pinfo.pe[k][H]=P.pe[H]}h.athaa_loudapprox==2&&H<2&&(P.loudness_sq[k][H]=P.loudness_sq_save[H],P.loudness_sq_save[H]=b(f,P))}var S=8,w=23,l=15,u,B,s,_=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function a(){u=Math.pow(10,(S+1)/16),B=Math.pow(10,(w+1)/16),s=Math.pow(10,l/10)}var r=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],n=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],i=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function d(h,f,y,p,C,A){var O;if(f>h)if(f<h*B)O=f/h;else return h+f;else{if(h>=f*B)return h+f;O=h/f}if(f0(h>=0),f0(f>=0),h+=f,p+3<=6){if(O>=u)return h;var k=0|b1.FAST_LOG10_X(O,16);return h*n[k]}var k=0|b1.FAST_LOG10_X(O,16);if(A!=0?f=C.ATH.cb_s[y]*C.ATH.adjust:f=C.ATH.cb_l[y]*C.ATH.adjust,f0(f>=0),h<s*f){if(h>f){var H,Z;return H=1,k<=13&&(H=i[k]),Z=b1.FAST_LOG10_X(h/f,10/15),h*((r[k]-H)*Z+H)}return k>13?h:h*i[k]}return h*r[k]}var E=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function M(h,f,y){var p;if(h<0&&(h=0),f<0&&(f=0),h<=0)return f;if(f<=0)return h;if(f>h?p=f/h:p=h/f,-2<=y&&y<=2){if(p>=u)return h+f;var C=0|b1.FAST_LOG10_X(p,16);return(h+f)*E[C]}return p<B?h+f:(h<f&&(h=f),h)}function L(h,f){var y=h.internal_flags;if(y.channels_out>1){for(var p=0;p<K.SBMAX_l;p++){var C=y.thm[0].l[p],A=y.thm[1].l[p];y.thm[0].l[p]+=A*f,y.thm[1].l[p]+=C*f}for(var p=0;p<K.SBMAX_s;p++)for(var O=0;O<3;O++){var C=y.thm[0].s[p][O],A=y.thm[1].s[p][O];y.thm[0].s[p][O]+=A*f,y.thm[1].s[p][O]+=C*f}}}function Q(h){for(var f=0;f<K.SBMAX_l;f++)if(!(h.thm[0].l[f]>1.58*h.thm[1].l[f]||h.thm[1].l[f]>1.58*h.thm[0].l[f])){var y=h.mld_l[f]*h.en[3].l[f],p=Math.max(h.thm[2].l[f],Math.min(h.thm[3].l[f],y));y=h.mld_l[f]*h.en[2].l[f];var C=Math.max(h.thm[3].l[f],Math.min(h.thm[2].l[f],y));h.thm[2].l[f]=p,h.thm[3].l[f]=C}for(var f=0;f<K.SBMAX_s;f++)for(var A=0;A<3;A++)if(!(h.thm[0].s[f][A]>1.58*h.thm[1].s[f][A]||h.thm[1].s[f][A]>1.58*h.thm[0].s[f][A])){var y=h.mld_s[f]*h.en[3].s[f][A],p=Math.max(h.thm[2].s[f][A],Math.min(h.thm[3].s[f][A],y));y=h.mld_s[f]*h.en[2].s[f][A];var C=Math.max(h.thm[3].s[f][A],Math.min(h.thm[2].s[f][A],y));h.thm[2].s[f][A]=p,h.thm[3].s[f][A]=C}}function t0(h,f,y){var p=f,C=Math.pow(10,y);f*=2,p*=2;for(var A=0;A<K.SBMAX_l;A++){var O,k,H,Z;if(Z=h.ATH.cb_l[h.bm_l[A]]*C,O=Math.min(Math.max(h.thm[0].l[A],Z),Math.max(h.thm[1].l[A],Z)),k=Math.max(h.thm[2].l[A],Z),H=Math.max(h.thm[3].l[A],Z),O*f<k+H){var X=O*p/(k+H);k*=X,H*=X,f0(k+H>0)}h.thm[2].l[A]=Math.min(k,h.thm[2].l[A]),h.thm[3].l[A]=Math.min(H,h.thm[3].l[A])}C*=K.BLKSIZE_s/K.BLKSIZE;for(var A=0;A<K.SBMAX_s;A++)for(var P=0;P<3;P++){var O,k,H,Z;if(Z=h.ATH.cb_s[h.bm_s[A]]*C,O=Math.min(Math.max(h.thm[0].s[A][P],Z),Math.max(h.thm[1].s[A][P],Z)),k=Math.max(h.thm[2].s[A][P],Z),H=Math.max(h.thm[3].s[A][P],Z),O*f<k+H){var X=O*f/(k+H);k*=X,H*=X,f0(k+H>0)}h.thm[2].s[A][P]=Math.min(h.thm[2].s[A][P],k),h.thm[3].s[A][P]=Math.min(h.thm[3].s[A][P],H)}}function t(h,f,y,p,C){var A,O,k=0,H=0;for(A=O=0;A<K.SBMAX_s;++O,++A){for(var Z=h.bo_s[A],X=h.npart_s,P=Z<X?Z:X;O<P;)f0(f[O]>=0),f0(y[O]>=0),k+=f[O],H+=y[O],O++;if(h.en[p].s[A][C]=k,h.thm[p].s[A][C]=H,O>=X){++A;break}f0(f[O]>=0),f0(y[O]>=0);{var _0=h.PSY.bo_s_weight[A],x0=1-_0;k=_0*f[O],H=_0*y[O],h.en[p].s[A][C]+=k,h.thm[p].s[A][C]+=H,k=x0*f[O],H=x0*y[O]}}for(;A<K.SBMAX_s;++A)h.en[p].s[A][C]=0,h.thm[p].s[A][C]=0}function v(h,f,y,p){var C,A,O=0,k=0;for(C=A=0;C<K.SBMAX_l;++A,++C){for(var H=h.bo_l[C],Z=h.npart_l,X=H<Z?H:Z;A<X;)f0(f[A]>=0),f0(y[A]>=0),O+=f[A],k+=y[A],A++;if(h.en[p].l[C]=O,h.thm[p].l[C]=k,A>=Z){++C;break}f0(f[A]>=0),f0(y[A]>=0);{var P=h.PSY.bo_l_weight[C],_0=1-P;O=P*f[A],k=P*y[A],h.en[p].l[C]+=O,h.thm[p].l[C]+=k,O=_0*f[A],k=_0*y[A]}}for(;C<K.SBMAX_l;++C)h.en[p].l[C]=0,h.thm[p].l[C]=0}function z(h,f,y,p,C,A){var O=h.internal_flags,k,H;for(H=k=0;H<O.npart_s;++H){for(var Z=0,X=0,P=O.numlines_s[H],_0=0;_0<P;++_0,++k){var x0=f[A][k];Z+=x0,X<x0&&(X=x0)}y[H]=Z}for(f0(H==O.npart_s),f0(k==129),k=H=0;H<O.npart_s;H++){var J=O.s3ind_s[H][0],S0=O.s3_ss[k++]*y[J];for(++J;J<=O.s3ind_s[H][1];)S0+=O.s3_ss[k]*y[J],++k,++J;{var D=q*O.nb_s1[C][H];p[H]=Math.min(S0,D)}if(O.blocktype_old[C&1]==K.SHORT_TYPE){var D=r0*O.nb_s2[C][H],h0=p[H];p[H]=Math.min(D,h0)}O.nb_s2[C][H]=O.nb_s1[C][H],O.nb_s1[C][H]=S0,f0(p[H]>=0)}for(;H<=K.CBANDS;++H)y[H]=0,p[H]=0}function W(h,f,y,p){var C=h.internal_flags;h.short_blocks==Ee.short_block_coupled&&!(f[0]!=0&&f[1]!=0)&&(f[0]=f[1]=0);for(var A=0;A<C.channels_out;A++)p[A]=K.NORM_TYPE,h.short_blocks==Ee.short_block_dispensed&&(f[A]=1),h.short_blocks==Ee.short_block_forced&&(f[A]=0),f[A]!=0?(f0(C.blocktype_old[A]!=K.START_TYPE),C.blocktype_old[A]==K.SHORT_TYPE&&(p[A]=K.STOP_TYPE)):(p[A]=K.SHORT_TYPE,C.blocktype_old[A]==K.NORM_TYPE&&(C.blocktype_old[A]=K.START_TYPE),C.blocktype_old[A]==K.STOP_TYPE&&(C.blocktype_old[A]=K.SHORT_TYPE)),y[A]=C.blocktype_old[A],C.blocktype_old[A]=p[A]}function e0(h,f,y){return y>=1?h:y<=0?f:f>0?Math.pow(h/f,y)*f:0}var s0=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function b0(h,f){for(var y=309.07,p=0;p<K.SBMAX_s-1;p++)for(var C=0;C<3;C++){var A=h.thm.s[p][C];if(f0(p<s0.length),A>0){var O=A*f,k=h.en.s[p][C];k>O&&(k>O*1e10?y+=s0[p]*(10*G):(f0(O>0),y+=s0[p]*b1.FAST_LOG10(k/O)))}}return y}var u0=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function d0(h,f){for(var y=281.0575,p=0;p<K.SBMAX_l-1;p++){var C=h.thm.l[p];if(f0(p<u0.length),C>0){var A=C*f,O=h.en.l[p];O>A&&(O>A*1e10?y+=u0[p]*(10*G):(f0(A>0),y+=u0[p]*b1.FAST_LOG10(O/A)))}}return y}function c0(h,f,y,p,C){var A,O;for(A=O=0;A<h.npart_l;++A){var k=0,H=0,Z;for(Z=0;Z<h.numlines_l[A];++Z,++O){var X=f[O];f0(X>=0),k+=X,H<X&&(H=X)}y[A]=k,p[A]=H,C[A]=k*h.rnumlines_l[A],f0(h.rnumlines_l[A]>=0),f0(k>=0),f0(y[A]>=0),f0(p[A]>=0),f0(C[A]>=0)}}function i0(h,f,y,p){var C=_.length-1,A=0,O=y[A]+y[A+1];if(f0(O>=0),O>0){var k=f[A];k<f[A+1]&&(k=f[A+1]),f0(h.numlines_l[A]+h.numlines_l[A+1]-1>0),O=20*(k*2-O)/(O*(h.numlines_l[A]+h.numlines_l[A+1]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;for(A=1;A<h.npart_l-1;A++)if(O=y[A-1]+y[A]+y[A+1],f0(O>=0),O>0){var k=f[A-1];k<f[A]&&(k=f[A]),k<f[A+1]&&(k=f[A+1]),f0(h.numlines_l[A-1]+h.numlines_l[A]+h.numlines_l[A+1]-1>0),O=20*(k*3-O)/(O*(h.numlines_l[A-1]+h.numlines_l[A]+h.numlines_l[A+1]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;if(f0(A>0),f0(A==h.npart_l-1),O=y[A-1]+y[A],f0(O>=0),O>0){var k=f[A-1];k<f[A]&&(k=f[A]),f0(h.numlines_l[A-1]+h.numlines_l[A]-1>0),O=20*(k*2-O)/(O*(h.numlines_l[A-1]+h.numlines_l[A]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;f0(A==h.npart_l-1)}var y0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(h,f,y,p,C,A,O,k,H,Z){var X=h.internal_flags,P=Y1([2,K.BLKSIZE]),_0=Y1([2,3,K.BLKSIZE_s]),x0=z0(K.CBANDS+1),J=z0(K.CBANDS+1),S0=z0(K.CBANDS+2),D=ue(2),h0=ue(2),w0,g,m0,$,A0,N0,v0,M0,B0=Y1([2,576]),C0,H1=ue(K.CBANDS+2),Q0=ue(K.CBANDS+2);for(qt.fill(Q0,0),w0=X.channels_out,h.mode==x.JOINT_STEREO&&(w0=4),h.VBR==Be.vbr_off?C0=X.ResvMax==0?0:X.ResvSize/X.ResvMax*.5:h.VBR==Be.vbr_rh||h.VBR==Be.vbr_mtrh||h.VBR==Be.vbr_mt?C0=.6:C0=1,g=0;g<X.channels_out;g++){var H0=f[g],l1=y+576-350-m+192;for(f0(y0.length==(m-1)/2),$=0;$<576;$++){var O1,C1;for(O1=H0[l1+$+10],C1=0,A0=0;A0<(m-1)/2-1;A0+=2)O1+=y0[A0]*(H0[l1+$+A0]+H0[l1+$+m-A0]),C1+=y0[A0+1]*(H0[l1+$+A0+1]+H0[l1+$+m-A0-1]);B0[g][$]=O1+C1}C[p][g].en.assign(X.en[g]),C[p][g].thm.assign(X.thm[g]),w0>2&&(A[p][g].en.assign(X.en[g+2]),A[p][g].thm.assign(X.thm[g+2]))}for(g=0;g<w0;g++){var P1,Q1,e1=z0(12),j1=[0,0,0,0],we=z0(12),ia=1,Ca,Fa=z0(K.CBANDS),ka=z0(K.CBANDS),F0=[0,0,0,0],qa=z0(K.HBLKSIZE),Xa=Y1([3,K.HBLKSIZE_s]);for(f0(X.npart_s<=K.CBANDS),f0(X.npart_l<=K.CBANDS),$=0;$<3;$++)e1[$]=X.nsPsy.last_en_subshort[g][$+6],f0(X.nsPsy.last_en_subshort[g][$+4]>0),we[$]=e1[$]/X.nsPsy.last_en_subshort[g][$+4],j1[0]+=e1[$];if(g==2)for($=0;$<576;$++){var sa,_a;sa=B0[0][$],_a=B0[1][$],B0[0][$]=sa+_a,B0[1][$]=sa-_a}{var Ya=B0[g&1],Ie=0;for($=0;$<9;$++){for(var Rt=Ie+64,J0=1;Ie<Rt;Ie++)J0<Math.abs(Ya[Ie])&&(J0=Math.abs(Ya[Ie]));X.nsPsy.last_en_subshort[g][$]=e1[$+3]=J0,j1[1+$/3]+=J0,J0>e1[$+3-2]?(f0(e1[$+3-2]>0),J0=J0/e1[$+3-2]):e1[$+3-2]>J0*10?(f0(J0>0),J0=e1[$+3-2]/(J0*10)):J0=0,we[$+3]=J0}}if(h.analysis){var la=we[0];for($=1;$<12;$++)la<we[$]&&(la=we[$]);X.pinfo.ers[p][g]=X.pinfo.ers_save[g],X.pinfo.ers_save[g]=la}for(Ca=g==3?X.nsPsy.attackthre_s:X.nsPsy.attackthre,$=0;$<12;$++)F0[$/3]==0&&we[$]>Ca&&(F0[$/3]=$%3+1);for($=1;$<4;$++){var va;j1[$-1]>j1[$]?(f0(j1[$]>0),va=j1[$-1]/j1[$]):(f0(j1[$-1]>0),va=j1[$]/j1[$-1]),va<1.7&&(F0[$]=0,$==1&&(F0[0]=0))}for(F0[0]!=0&&X.nsPsy.lastAttacks[g]!=0&&(F0[0]=0),(X.nsPsy.lastAttacks[g]==3||F0[0]+F0[1]+F0[2]+F0[3]!=0)&&(ia=0,F0[1]!=0&&F0[0]!=0&&(F0[1]=0),F0[2]!=0&&F0[1]!=0&&(F0[2]=0),F0[3]!=0&&F0[2]!=0&&(F0[3]=0)),g<2?h0[g]=ia:ia==0&&(h0[0]=h0[1]=0),H[g]=X.tot_ener[g],Q1=_0,P1=P,N(h,qa,Xa,P1,g&1,Q1,g&1,p,g,f,y),c0(X,qa,x0,Fa,ka),i0(X,Fa,ka,H1),M0=0;M0<3;M0++){var oa,v1;for(z(h,Xa,J,S0,g,M0),t(X,J,S0,g,M0),v0=0;v0<K.SBMAX_s;v0++){if(v1=X.thm[g].s[v0][M0],v1*=V,F0[M0]>=2||F0[M0+1]==1){var pe=M0!=0?M0-1:2,J0=e0(X.thm[g].s[v0][pe],v1,U*C0);v1=Math.min(v1,J0)}if(F0[M0]==1){var pe=M0!=0?M0-1:2,J0=e0(X.thm[g].s[v0][pe],v1,T*C0);v1=Math.min(v1,J0)}else if(M0!=0&&F0[M0-1]==3||M0==0&&X.nsPsy.lastAttacks[g]==3){var pe=M0!=2?M0+1:0,J0=e0(X.thm[g].s[v0][pe],v1,T*C0);v1=Math.min(v1,J0)}oa=e1[M0*3+3]+e1[M0*3+4]+e1[M0*3+5],e1[M0*3+5]*6<oa&&(v1*=.5,e1[M0*3+4]*6<oa&&(v1*=.5)),X.thm[g].s[v0][M0]=v1}}for(X.nsPsy.lastAttacks[g]=F0[2],N0=0,m0=0;m0<X.npart_l;m0++){for(var ve=X.s3ind[m0][0],ua=x0[ve]*_[H1[ve]],oe=X.s3_ll[N0++]*ua;++ve<=X.s3ind[m0][1];)ua=x0[ve]*_[H1[ve]],oe=d(oe,X.s3_ll[N0++]*ua,ve,ve-m0,X,0);oe*=.158489319246111,X.blocktype_old[g&1]==K.SHORT_TYPE?S0[m0]=oe:S0[m0]=e0(Math.min(oe,Math.min(Y*X.nb_1[g][m0],l0*X.nb_2[g][m0])),oe,C0),X.nb_2[g][m0]=X.nb_1[g][m0],X.nb_1[g][m0]=oe}for(;m0<=K.CBANDS;++m0)x0[m0]=0,S0[m0]=0;v(X,x0,S0,g)}if((h.mode==x.STEREO||h.mode==x.JOINT_STEREO)&&h.interChRatio>0&&L(h,h.interChRatio),h.mode==x.JOINT_STEREO){var ha;Q(X),ha=h.msfix,Math.abs(ha)>0&&t0(X,ha,h.ATHlower*X.ATH.adjust)}for(W(h,h0,Z,D),g=0;g<w0;g++){var Le,Ve=0,De,Ge;g>1?(Le=k,Ve=-2,De=K.NORM_TYPE,(Z[0]==K.SHORT_TYPE||Z[1]==K.SHORT_TYPE)&&(De=K.SHORT_TYPE),Ge=A[p][g-2]):(Le=O,Ve=0,De=Z[g],Ge=C[p][g]),De==K.SHORT_TYPE?Le[Ve+g]=b0(Ge,X.masking_lower):Le[Ve+g]=d0(Ge,X.masking_lower),h.analysis&&(X.pinfo.pe[p][g]=Le[Ve+g])}return 0};function Z0(h,f,y,p,C,A,O,k){var H=h.internal_flags;if(p<2)F.fft_long(H,O[k],p,f,y);else if(p==2)for(var Z=K.BLKSIZE-1;Z>=0;--Z){var X=O[k+0][Z],P=O[k+1][Z];O[k+0][Z]=(X+P)*b1.SQRT2*.5,O[k+1][Z]=(X-P)*b1.SQRT2*.5}A[0]=O[k+0][0],A[0]*=A[0];for(var Z=K.BLKSIZE/2-1;Z>=0;--Z){var _0=O[k+0][K.BLKSIZE/2-Z],x0=O[k+0][K.BLKSIZE/2+Z];A[K.BLKSIZE/2-Z]=(_0*_0+x0*x0)*.5}{for(var J=0,Z=11;Z<K.HBLKSIZE;Z++)J+=A[Z];H.tot_ener[p]=J}if(h.analysis){for(var Z=0;Z<K.HBLKSIZE;Z++)H.pinfo.energy[C][p][Z]=H.pinfo.energy_save[p][Z],H.pinfo.energy_save[p][Z]=A[Z];H.pinfo.pe[C][p]=H.pe[p]}}function T0(h,f,y,p,C,A,O,k){var H=h.internal_flags;if(C==0&&p<2&&F.fft_short(H,O[k],p,f,y),p==2)for(var Z=K.BLKSIZE_s-1;Z>=0;--Z){var X=O[k+0][C][Z],P=O[k+1][C][Z];O[k+0][C][Z]=(X+P)*b1.SQRT2*.5,O[k+1][C][Z]=(X-P)*b1.SQRT2*.5}A[C][0]=O[k+0][C][0],A[C][0]*=A[C][0];for(var Z=K.BLKSIZE_s/2-1;Z>=0;--Z){var _0=O[k+0][C][K.BLKSIZE_s/2-Z],x0=O[k+0][C][K.BLKSIZE_s/2+Z];A[C][K.BLKSIZE_s/2-Z]=(_0*_0+x0*x0)*.5}}function q0(h,f,y,p){var C=h.internal_flags;h.athaa_loudapprox==2&&y<2&&(C.loudness_sq[f][y]=C.loudness_sq_save[y],C.loudness_sq_save[y]=b(p,C))}var X0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function P0(h,f,y,p,C,A,O,k,H,Z){for(var X=Y1([2,576]),P=h.internal_flags,_0=P.channels_out,x0=h.mode==x.JOINT_STEREO?4:_0,J=0;J<_0;J++){firbuf=f[J];var S0=y+576-350-m+192;f0(X0.length==(m-1)/2);for(var D=0;D<576;D++){var h0,w0;h0=firbuf[S0+D+10],w0=0;for(var g=0;g<(m-1)/2-1;g+=2)h0+=X0[g]*(firbuf[S0+D+g]+firbuf[S0+D+m-g]),w0+=X0[g+1]*(firbuf[S0+D+g+1]+firbuf[S0+D+m-g-1]);X[J][D]=h0+w0}C[p][J].en.assign(P.en[J]),C[p][J].thm.assign(P.thm[J]),x0>2&&(A[p][J].en.assign(P.en[J+2]),A[p][J].thm.assign(P.thm[J+2]))}for(var J=0;J<x0;J++){var m0=z0(12),$=z0(12),A0=[0,0,0,0],N0=X[J&1],v0=0,M0=J==3?P.nsPsy.attackthre_s:P.nsPsy.attackthre,B0=1;if(J==2)for(var D=0,g=576;g>0;++D,--g){var C0=X[0][D],H1=X[1][D];X[0][D]=C0+H1,X[1][D]=C0-H1}for(var D=0;D<3;D++)$[D]=P.nsPsy.last_en_subshort[J][D+6],f0(P.nsPsy.last_en_subshort[J][D+4]>0),m0[D]=$[D]/P.nsPsy.last_en_subshort[J][D+4],A0[0]+=$[D];for(var D=0;D<9;D++){for(var Q0=v0+64,H0=1;v0<Q0;v0++)H0<Math.abs(N0[v0])&&(H0=Math.abs(N0[v0]));P.nsPsy.last_en_subshort[J][D]=$[D+3]=H0,A0[1+D/3]+=H0,H0>$[D+3-2]?(f0($[D+3-2]>0),H0=H0/$[D+3-2]):$[D+3-2]>H0*10?(f0(H0>0),H0=$[D+3-2]/(H0*10)):H0=0,m0[D+3]=H0}for(var D=0;D<3;++D){var l1=$[D*3+3]+$[D*3+4]+$[D*3+5],O1=1;$[D*3+5]*6<l1&&(O1*=.5,$[D*3+4]*6<l1&&(O1*=.5)),k[J][D]=O1}if(h.analysis){for(var C1=m0[0],D=1;D<12;D++)C1<m0[D]&&(C1=m0[D]);P.pinfo.ers[p][J]=P.pinfo.ers_save[J],P.pinfo.ers_save[J]=C1}for(var D=0;D<12;D++)H[J][D/3]==0&&m0[D]>M0&&(H[J][D/3]=D%3+1);for(var D=1;D<4;D++){var P1=A0[D-1],Q1=A0[D],e1=Math.max(P1,Q1);e1<4e4&&P1<1.7*Q1&&Q1<1.7*P1&&(D==1&&H[J][0]<=H[J][D]&&(H[J][0]=0),H[J][D]=0)}H[J][0]<=P.nsPsy.lastAttacks[J]&&(H[J][0]=0),(P.nsPsy.lastAttacks[J]==3||H[J][0]+H[J][1]+H[J][2]+H[J][3]!=0)&&(B0=0,H[J][1]!=0&&H[J][0]!=0&&(H[J][1]=0),H[J][2]!=0&&H[J][1]!=0&&(H[J][2]=0),H[J][3]!=0&&H[J][2]!=0&&(H[J][3]=0)),J<2?Z[J]=B0:B0==0&&(Z[0]=Z[1]=0),O[J]=P.tot_ener[J]}}function $0(h,f,y){if(y==0)for(var p=0;p<h.npart_s;p++)h.nb_s2[f][p]=h.nb_s1[f][p],h.nb_s1[f][p]=0}function K1(h,f){for(var y=0;y<h.npart_l;y++)h.nb_2[f][y]=h.nb_1[f][y],h.nb_1[f][y]=0}function n1(h,f,y,p){var C=_.length-1,A=0,O=y[A]+y[A+1];if(f0(O>=0),O>0){var k=f[A];k<f[A+1]&&(k=f[A+1]),f0(h.numlines_s[A]+h.numlines_s[A+1]-1>0),O=20*(k*2-O)/(O*(h.numlines_s[A]+h.numlines_s[A+1]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;for(A=1;A<h.npart_s-1;A++)if(O=y[A-1]+y[A]+y[A+1],f0(A+1<h.npart_s),f0(O>=0),O>0){var k=f[A-1];k<f[A]&&(k=f[A]),k<f[A+1]&&(k=f[A+1]),f0(h.numlines_s[A-1]+h.numlines_s[A]+h.numlines_s[A+1]-1>0),O=20*(k*3-O)/(O*(h.numlines_s[A-1]+h.numlines_s[A]+h.numlines_s[A+1]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;if(f0(A>0),f0(A==h.npart_s-1),O=y[A-1]+y[A],f0(O>=0),O>0){var k=f[A-1];k<f[A]&&(k=f[A]),f0(h.numlines_s[A-1]+h.numlines_s[A]-1>0),O=20*(k*2-O)/(O*(h.numlines_s[A-1]+h.numlines_s[A]-1));var H=0|O;H>C&&(H=C),p[A]=H}else p[A]=0;f0(A==h.npart_s-1)}function i1(h,f,y,p,C,A){var O=h.internal_flags,k=new float[K.CBANDS],H=z0(K.CBANDS),Z,X,P,_0=new int[K.CBANDS];for(P=X=0;P<O.npart_s;++P){var x0=0,J=0,S0=O.numlines_s[P];for(Z=0;Z<S0;++Z,++X){var D=f[A][X];x0+=D,J<D&&(J=D)}y[P]=x0,f0(x0>=0),k[P]=J,f0(S0>0),H[P]=x0/S0,f0(H[P]>=0)}for(f0(P==O.npart_s),f0(X==129);P<K.CBANDS;++P)k[P]=0,H[P]=0;for(n1(O,k,H,_0),X=P=0;P<O.npart_s;P++){var h0=O.s3ind_s[P][0],w0=O.s3ind_s[P][1],g,m0,$,A0,N0;for(g=_0[h0],m0=1,A0=O.s3_ss[X]*y[h0]*_[_0[h0]],++X,++h0;h0<=w0;)g+=_0[h0],m0+=1,$=O.s3_ss[X]*y[h0]*_[_0[h0]],A0=M(A0,$,h0-P),++X,++h0;g=(1+2*g)/(2*m0),N0=_[g]*.5,A0*=N0,p[P]=A0,O.nb_s2[C][P]=O.nb_s1[C][P],O.nb_s1[C][P]=A0,$=k[P],$*=O.minval_s[P],$*=N0,p[P]>$&&(p[P]=$),O.masking_lower>1&&(p[P]*=O.masking_lower),p[P]>y[P]&&(p[P]=y[P]),O.masking_lower<1&&(p[P]*=O.masking_lower),f0(p[P]>=0)}for(;P<K.CBANDS;++P)y[P]=0,p[P]=0}function Z1(h,f,y,p,C){var A=z0(K.CBANDS),O=z0(K.CBANDS),k=ue(K.CBANDS+2),H;c0(h,f,y,A,O),i0(h,A,O,k);var Z=0;for(H=0;H<h.npart_l;H++){var X,P,_0,x0,J=h.s3ind[H][0],S0=h.s3ind[H][1],D=0,h0=0;for(D=k[J],h0+=1,P=h.s3_ll[Z]*y[J]*_[k[J]],++Z,++J;J<=S0;)D+=k[J],h0+=1,X=h.s3_ll[Z]*y[J]*_[k[J]],x0=M(P,X,J-H),P=x0,++Z,++J;if(D=(1+2*D)/(2*h0),_0=_[D]*.5,P*=_0,h.blocktype_old[C&1]==K.SHORT_TYPE){var w0=Y*h.nb_1[C][H];w0>0?p[H]=Math.min(P,w0):p[H]=Math.min(P,y[H]*T)}else{var g=l0*h.nb_2[C][H],m0=Y*h.nb_1[C][H],w0;g<=0&&(g=P),m0<=0&&(m0=P),h.blocktype_old[C&1]==K.NORM_TYPE?w0=Math.min(m0,g):w0=m0,p[H]=Math.min(P,w0)}h.nb_2[C][H]=h.nb_1[C][H],h.nb_1[C][H]=P,X=A[H],X*=h.minval_l[H],X*=_0,p[H]>X&&(p[H]=X),h.masking_lower>1&&(p[H]*=h.masking_lower),p[H]>y[H]&&(p[H]=y[H]),h.masking_lower<1&&(p[H]*=h.masking_lower),f0(p[H]>=0)}for(;H<K.CBANDS;++H)y[H]=0,p[H]=0}function se(h,f){var y=h.internal_flags;h.short_blocks==Ee.short_block_coupled&&!(f[0]!=0&&f[1]!=0)&&(f[0]=f[1]=0);for(var p=0;p<y.channels_out;p++)h.short_blocks==Ee.short_block_dispensed&&(f[p]=1),h.short_blocks==Ee.short_block_forced&&(f[p]=0)}function _e(h,f,y){for(var p=h.internal_flags,C=0;C<p.channels_out;C++){var A=K.NORM_TYPE;f[C]!=0?(f0(p.blocktype_old[C]!=K.START_TYPE),p.blocktype_old[C]==K.SHORT_TYPE&&(A=K.STOP_TYPE)):(A=K.SHORT_TYPE,p.blocktype_old[C]==K.NORM_TYPE&&(p.blocktype_old[C]=K.START_TYPE),p.blocktype_old[C]==K.STOP_TYPE&&(p.blocktype_old[C]=K.SHORT_TYPE)),y[C]=p.blocktype_old[C],p.blocktype_old[C]=A}}function s1(h,f,y,p,C,A,O){for(var k=A*2,H=A>0?Math.pow(10,C):1,Z,X,P=0;P<O;++P){var _0=h[2][P],x0=h[3][P],J=f[0][P],S0=f[1][P],D=f[2][P],h0=f[3][P];if(J<=1.58*S0&&S0<=1.58*J){var w0=y[P]*x0,g=y[P]*_0;X=Math.max(D,Math.min(h0,w0)),Z=Math.max(h0,Math.min(D,g))}else X=D,Z=h0;if(A>0){var m0,$,A0=p[P]*H;if(m0=Math.min(Math.max(J,A0),Math.max(S0,A0)),D=Math.max(X,A0),h0=Math.max(Z,A0),$=D+h0,$>0&&m0*k<$){var N0=m0*k/$;D*=N0,h0*=N0,f0($>0)}X=Math.min(D,X),Z=Math.min(h0,Z)}X>_0&&(X=_0),Z>x0&&(Z=x0),f[2][P]=X,f[3][P]=Z}}this.L3psycho_anal_vbr=function(h,f,y,p,C,A,O,k,H,Z){var X=h.internal_flags,P,_0,x0=z0(K.HBLKSIZE),J=Y1([3,K.HBLKSIZE_s]),S0=Y1([2,K.BLKSIZE]),D=Y1([2,3,K.BLKSIZE_s]),h0=Y1([4,K.CBANDS]),w0=Y1([4,K.CBANDS]),g=Y1([4,3]),m0=.6,$=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],A0=ue(2),N0=h.mode==x.JOINT_STEREO?4:X.channels_out;P0(h,f,y,p,C,A,H,g,$,A0),se(h,A0);{for(var v0=0;v0<N0;v0++){var M0=v0&1;P=S0,Z0(h,f,y,v0,p,x0,P,M0),q0(h,p,v0,x0),A0[M0]!=0?Z1(X,x0,h0[v0],w0[v0],v0):K1(X,v0)}A0[0]+A0[1]==2&&h.mode==x.JOINT_STEREO&&s1(h0,w0,X.mld_cb_l,X.ATH.cb_l,h.ATHlower*X.ATH.adjust,h.msfix,X.npart_l);for(var v0=0;v0<N0;v0++){var M0=v0&1;A0[M0]!=0&&v(X,h0[v0],w0[v0],v0)}}{for(var B0=0;B0<3;B0++){for(var v0=0;v0<N0;++v0){var M0=v0&1;A0[M0]!=0?$0(X,v0,B0):(_0=D,T0(h,f,y,v0,B0,J,_0,M0),i1(h,J,h0[v0],w0[v0],v0,B0))}A0[0]+A0[1]==0&&h.mode==x.JOINT_STEREO&&s1(h0,w0,X.mld_cb_s,X.ATH.cb_s,h.ATHlower*X.ATH.adjust,h.msfix,X.npart_s);for(var v0=0;v0<N0;++v0){var M0=v0&1;A0[M0]==0&&t(X,h0[v0],w0[v0],v0,B0)}}for(var v0=0;v0<N0;v0++){var M0=v0&1;if(A0[M0]==0)for(var C0=0;C0<K.SBMAX_s;C0++){for(var H1=z0(3),B0=0;B0<3;B0++){var Q0=X.thm[v0].s[C0][B0];if(Q0*=V,$[v0][B0]>=2||$[v0][B0+1]==1){var H0=B0!=0?B0-1:2,l1=e0(X.thm[v0].s[C0][H0],Q0,U*m0);Q0=Math.min(Q0,l1)}else if($[v0][B0]==1){var H0=B0!=0?B0-1:2,l1=e0(X.thm[v0].s[C0][H0],Q0,T*m0);Q0=Math.min(Q0,l1)}else if(B0!=0&&$[v0][B0-1]==3||B0==0&&X.nsPsy.lastAttacks[v0]==3){var H0=B0!=2?B0+1:0,l1=e0(X.thm[v0].s[C0][H0],Q0,T*m0);Q0=Math.min(Q0,l1)}Q0*=g[v0][B0],H1[B0]=Q0}for(var B0=0;B0<3;B0++)X.thm[v0].s[C0][B0]=H1[B0]}}}for(var v0=0;v0<N0;v0++)X.nsPsy.lastAttacks[v0]=$[v0][2];_e(h,A0,Z);for(var v0=0;v0<N0;v0++){var O1,C1,P1,Q1;v0>1?(O1=k,C1=-2,P1=K.NORM_TYPE,(Z[0]==K.SHORT_TYPE||Z[1]==K.SHORT_TYPE)&&(P1=K.SHORT_TYPE),Q1=A[p][v0-2]):(O1=O,C1=0,P1=Z[v0],Q1=C[p][v0]),P1==K.SHORT_TYPE?O1[C1+v0]=b0(Q1,X.masking_lower):O1[C1+v0]=d0(Q1,X.masking_lower),h.analysis&&(X.pinfo.pe[p][v0]=O1[C1+v0])}return 0};function _1(h,f){var y=h,p;return y>=0?p=-y*27:p=y*f,p<=-72?0:Math.exp(p*c)}function le(h){var f=0,y=0;{var p=0,C,A;for(p=0;_1(p,h)>1e-20;p-=1);for(C=p,A=0;Math.abs(A-C)>1e-12;)p=(A+C)/2,_1(p,h)>0?A=p:C=p;f=C}{var p=0,C,A;for(p=0;_1(p,h)>1e-20;p+=1);for(C=0,A=p;Math.abs(A-C)>1e-12;)p=(A+C)/2,_1(p,h)>0?C=p:A=p;y=A}{var O=0,k=1e3,H;for(H=0;H<=k;++H){var p=f+H*(y-f)/k,Z=_1(p,h);O+=Z}{var X=(k+1)/(O*(y-f));return X}}}function Mt(h){var f,y,p,C;return f=h,f>=0?f*=3:f*=1.5,f>=.5&&f<=2.5?(C=f-.5,y=8*(C*C-2*C)):y=0,f+=.474,p=15.811389+7.5*f-17.5*Math.sqrt(1+f*f),p<=-60?0:(f=Math.exp((y+p)*c),f/=.6609193,f)}function ne(h){return h<0&&(h=0),h=h*.001,13*Math.atan(.76*h)+3.5*Math.atan(h*h/(7.5*7.5))}function Na(h,f,y,p,C,A,O,k,H,Z,X,P){var _0=z0(K.CBANDS+1),x0=k/(P>15?2*576:2*192),J=ue(K.HBLKSIZE),S0;k/=H;var D=0,h0=0;for(S0=0;S0<K.CBANDS;S0++){var w0,g;for(w0=ne(k*D),_0[S0]=k*D,g=D;ne(k*g)-w0<j&&g<=H/2;g++);for(h[S0]=g-D,h0=S0+1;D<g;)f0(D<K.HBLKSIZE),J[D++]=S0;if(D>H/2){D=H/2,++S0;break}}f0(S0<K.CBANDS),_0[S0]=k*D;for(var m0=0;m0<P;m0++){var $,A0,N0,v0,M0;N0=Z[m0],v0=Z[m0+1],$=0|Math.floor(.5+X*(N0-.5)),$<0&&($=0),A0=0|Math.floor(.5+X*(v0-.5)),A0>H/2&&(A0=H/2),y[m0]=(J[$]+J[A0])/2,f[m0]=J[A0];var B0=x0*v0;O[m0]=(B0-_0[f[m0]])/(_0[f[m0]+1]-_0[f[m0]]),O[m0]<0?O[m0]=0:O[m0]>1&&(O[m0]=1),M0=ne(k*Z[m0]*X),M0=Math.min(M0,15.5)/15.5,A[m0]=Math.pow(10,1.25*(1-Math.cos(Math.PI*M0))-2.5)}D=0;for(var C0=0;C0<h0;C0++){var H1=h[C0],w0,Q0;w0=ne(k*D),Q0=ne(k*(D+H1-1)),p[C0]=.5*(w0+Q0),w0=ne(k*(D-.5)),Q0=ne(k*(D+H1-.5)),C[C0]=Q0-w0,D+=H1}return h0}function Ha(h,f,y,p,C,A){var O=Y1([K.CBANDS,K.CBANDS]),k,H=0;if(A)for(var Z=0;Z<f;Z++)for(k=0;k<f;k++){var X=Mt(y[Z]-y[k])*p[k];O[Z][k]=X*C[Z]}else for(k=0;k<f;k++)for(var P=15+Math.min(21/y[k],12),_0=le(P),Z=0;Z<f;Z++){var X=_0*_1(y[Z]-y[k],P)*p[k];O[Z][k]=X*C[Z]}for(var Z=0;Z<f;Z++){for(k=0;k<f&&!(O[Z][k]>0);k++);for(h[Z][0]=k,k=f-1;k>0&&!(O[Z][k]>0);k--);h[Z][1]=k,H+=h[Z][1]-h[Z][0]+1}for(var x0=z0(H),J=0,Z=0;Z<f;Z++)for(k=h[Z][0];k<=h[Z][1];k++)x0[J++]=O[Z][k];return x0}function Oa(h){var f=ne(h);return f=Math.min(f,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*f))-2.5)}this.psymodel_init=function(h){var f=h.internal_flags,y,p=!0,C=13,A=24,O=0,k=0,H=-8.25,Z=-4.5,X=z0(K.CBANDS),P=z0(K.CBANDS),_0=z0(K.CBANDS),x0=h.out_samplerate;switch(h.experimentalZ){default:case 0:p=!0;break;case 1:p=!(h.VBR==Be.vbr_mtrh||h.VBR==Be.vbr_mt);break;case 2:p=!1;break;case 3:C=8,O=-1.75,k=-.0125,H=-8.25,Z=-2.25;break}for(f.ms_ener_ratio_old=.25,f.blocktype_old[0]=f.blocktype_old[1]=K.NORM_TYPE,y=0;y<4;++y){for(var D=0;D<K.CBANDS;++D)f.nb_1[y][D]=1e20,f.nb_2[y][D]=1e20,f.nb_s1[y][D]=f.nb_s2[y][D]=1;for(var J=0;J<K.SBMAX_l;J++)f.en[y].l[J]=1e20,f.thm[y].l[J]=1e20;for(var D=0;D<3;++D){for(var J=0;J<K.SBMAX_s;J++)f.en[y].s[J][D]=1e20,f.thm[y].s[J][D]=1e20;f.nsPsy.lastAttacks[y]=0}for(var D=0;D<9;D++)f.nsPsy.last_en_subshort[y][D]=10}for(f.loudness_sq_save[0]=f.loudness_sq_save[1]=0,f.npart_l=Na(f.numlines_l,f.bo_l,f.bm_l,X,P,f.mld_l,f.PSY.bo_l_weight,x0,K.BLKSIZE,f.scalefac_band.l,K.BLKSIZE/(2*576),K.SBMAX_l),f0(f.npart_l<K.CBANDS),y=0;y<f.npart_l;y++){var S0=O;X[y]>=C&&(S0=k*(X[y]-C)/(A-C)+O*(A-X[y])/(A-C)),_0[y]=Math.pow(10,S0/10),f.numlines_l[y]>0?f.rnumlines_l[y]=1/f.numlines_l[y]:f.rnumlines_l[y]=0}f.s3_ll=Ha(f.s3ind,f.npart_l,X,P,_0,p);var D=0;for(y=0;y<f.npart_l;y++){var h0;h0=hr.MAX_VALUE;for(var w0=0;w0<f.numlines_l[y];w0++,D++){var g=x0*D/(1e3*K.BLKSIZE),m0;m0=this.ATHformula(g*1e3,h)-20,m0=Math.pow(10,.1*m0),m0*=f.numlines_l[y],h0>m0&&(h0=m0)}f.ATH.cb_l[y]=h0,h0=-20+X[y]*20/10,h0>6&&(h0=100),h0<-15&&(h0=-15),h0-=8,f.minval_l[y]=Math.pow(10,h0/10)*f.numlines_l[y]}for(f.npart_s=Na(f.numlines_s,f.bo_s,f.bm_s,X,P,f.mld_s,f.PSY.bo_s_weight,x0,K.BLKSIZE_s,f.scalefac_band.s,K.BLKSIZE_s/(2*192),K.SBMAX_s),f0(f.npart_s<K.CBANDS),D=0,y=0;y<f.npart_s;y++){var h0,S0=H;X[y]>=C&&(S0=Z*(X[y]-C)/(A-C)+H*(A-X[y])/(A-C)),_0[y]=Math.pow(10,S0/10),h0=hr.MAX_VALUE;for(var w0=0;w0<f.numlines_s[y];w0++,D++){var g=x0*D/(1e3*K.BLKSIZE_s),m0;m0=this.ATHformula(g*1e3,h)-20,m0=Math.pow(10,.1*m0),m0*=f.numlines_s[y],h0>m0&&(h0=m0)}f.ATH.cb_s[y]=h0,h0=-7+X[y]*7/12,X[y]>12&&(h0*=1+Math.log(1+h0)*3.1),X[y]<12&&(h0*=1+Math.log(1-h0)*2.3),h0<-15&&(h0=-15),h0-=8,f.minval_s[y]=Math.pow(10,h0/10)*f.numlines_s[y]}f.s3_ss=Ha(f.s3ind_s,f.npart_s,X,P,_0,p),a(),F.init_fft(f),f.decay=Math.exp(-1*G/(o0*x0/192));{var $;$=I,(h.exp_nspsytune&2)!=0&&($=1),Math.abs(h.msfix)>0&&($=h.msfix),h.msfix=$;for(var A0=0;A0<f.npart_l;A0++)f.s3ind[A0][1]>f.npart_l-1&&(f.s3ind[A0][1]=f.npart_l-1)}var N0=576*f.mode_gr/x0;if(f.ATH.decay=Math.pow(10,-12/10*N0),f.ATH.adjust=.01,f.ATH.adjustLimit=1,f0(f.bo_l[K.SBMAX_l-1]<=f.npart_l),f0(f.bo_s[K.SBMAX_s-1]<=f.npart_s),h.ATHtype!=-1){var g,v0=h.out_samplerate/K.BLKSIZE,M0=0;for(g=0,y=0;y<K.BLKSIZE/2;++y)g+=v0,f.ATH.eql_w[y]=1/Math.pow(10,this.ATHformula(g,h)/10),M0+=f.ATH.eql_w[y];for(M0=1/M0,y=K.BLKSIZE/2;--y>=0;)f.ATH.eql_w[y]*=M0}{for(var A0=D=0;A0<f.npart_s;++A0)for(y=0;y<f.numlines_s[A0];++y)++D;f0(D==129);for(var A0=D=0;A0<f.npart_l;++A0)for(y=0;y<f.numlines_l[A0];++y)++D;f0(D==513)}for(D=0,y=0;y<f.npart_l;y++){var g=x0*(D+f.numlines_l[y]/2)/(1*K.BLKSIZE);f.mld_cb_l[y]=Oa(g),D+=f.numlines_l[y]}for(;y<K.CBANDS;++y)f.mld_cb_l[y]=1;for(D=0,y=0;y<f.npart_s;y++){var g=x0*(D+f.numlines_s[y]/2)/(1*K.BLKSIZE_s);f.mld_cb_s[y]=Oa(g),D+=f.numlines_s[y]}for(;y<K.CBANDS;++y)f.mld_cb_s[y]=1;return 0};function Re(h,f){h<-.3&&(h=3410),h/=1e3,h=Math.max(.1,h);var y=3.64*Math.pow(h,-.8)-6.8*Math.exp(-.6*Math.pow(h-3.4,2))+6*Math.exp(-.15*Math.pow(h-8.7,2))+(.6+.04*f)*.001*Math.pow(h,4);return y}this.ATHformula=function(h,f){var y;switch(f.ATHtype){case 0:y=Re(h,9);break;case 1:y=Re(h,-1);break;case 2:y=Re(h,0);break;case 3:y=Re(h,1)+6;break;case 4:y=Re(h,f.ATHcurve);break;default:y=Re(h,0);break}return y}}fr.exports=Yt});var cr=I0((ai,mr)=>{"use strict";var Dt=He();function Gt(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Dt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}mr.exports=Gt});var Ce=I0((ri,dr)=>{"use strict";var Ut=a1(),Sr={};Sr.SFBMAX=Ut.SBMAX_s*3;dr.exports=Sr});var Pe=I0((mi,Ar)=>{"use strict";var c1=k0(),ti=c1.System,ni=c1.VbrMode,ii=c1.Float,si=c1.ShortBlock,_i=c1.Util,li=c1.Arrays,vi=c1.new_array_n,oi=c1.new_byte,ui=c1.new_double,Kt=c1.new_float,hi=c1.new_float_n,he=c1.new_int,fi=c1.new_int_n,bi=c1.assert,ma=Ce();function Zt(){this.xr=Kt(576),this.l3_enc=he(576),this.scalefac=he(ma.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=he(3),this.subblock_gain=he(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=he(ma.SFBMAX),this.window=he(ma.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=he(4),this.max_nonzero_coeff=0;var x=this;function F(Y){return new Int32Array(Y)}function G(Y){return new Float32Array(Y)}this.assign=function(Y){x.xr=G(Y.xr),x.l3_enc=F(Y.l3_enc),x.scalefac=F(Y.scalefac),x.xrpow_max=Y.xrpow_max,x.part2_3_length=Y.part2_3_length,x.big_values=Y.big_values,x.count1=Y.count1,x.global_gain=Y.global_gain,x.scalefac_compress=Y.scalefac_compress,x.block_type=Y.block_type,x.mixed_block_flag=Y.mixed_block_flag,x.table_select=F(Y.table_select),x.subblock_gain=F(Y.subblock_gain),x.region0_count=Y.region0_count,x.region1_count=Y.region1_count,x.preflag=Y.preflag,x.scalefac_scale=Y.scalefac_scale,x.count1table_select=Y.count1table_select,x.part2_length=Y.part2_length,x.sfb_lmax=Y.sfb_lmax,x.sfb_smin=Y.sfb_smin,x.psy_lmax=Y.psy_lmax,x.sfbmax=Y.sfbmax,x.psymax=Y.psymax,x.sfbdivide=Y.sfbdivide,x.width=F(Y.width),x.window=F(Y.window),x.count1bits=Y.count1bits,x.sfb_partition_table=Y.sfb_partition_table.slice(0),x.slen=F(Y.slen),x.max_nonzero_coeff=Y.max_nonzero_coeff}}Ar.exports=Zt});var Rr=I0((pi,Mr)=>{"use strict";var S1=k0(),ci=S1.System,Si=S1.VbrMode,di=S1.Float,Ai=S1.ShortBlock,xi=S1.Util,Mi=S1.Arrays,Ri=S1.new_array_n,wi=S1.new_byte,Bi=S1.new_double,Ei=S1.new_float,yi=S1.new_float_n,xr=S1.new_int,Ti=S1.new_int_n,Ii=S1.assert,Pt=Pe();function Qt(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[xr(4),xr(4)];for(var x=0;x<2;x++)for(var F=0;F<2;F++)this.tt[x][F]=new Pt}Mr.exports=Qt});var ca=I0((Gi,wr)=>{"use strict";var d1=k0(),Qe=d1.System,Li=d1.VbrMode,Vi=d1.Float,Ni=d1.ShortBlock,Hi=d1.Util,Oi=d1.Arrays,Ci=d1.new_array_n,Fi=d1.new_byte,ki=d1.new_double,qi=d1.new_float,Xi=d1.new_float_n,We=d1.new_int,Yi=d1.new_int_n,Di=d1.assert,ze=a1();function Wt(x,F,G,Y){this.l=We(1+ze.SBMAX_l),this.s=We(1+ze.SBMAX_s),this.psfb21=We(1+ze.PSFB21),this.psfb12=We(1+ze.PSFB12);var l0=this.l,q=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Qe.arraycopy(this.arrL,0,l0,0,Math.min(this.arrL.length,this.l.length)),Qe.arraycopy(this.arrS,0,q,0,Math.min(this.arrS.length,this.s.length)),Qe.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Qe.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}wr.exports=Wt});var yr=I0((es,Er)=>{"use strict";var A1=k0(),Ui=A1.System,Ki=A1.VbrMode,Zi=A1.Float,Pi=A1.ShortBlock,Qi=A1.Util,Wi=A1.Arrays,zi=A1.new_array_n,ji=A1.new_byte,Ji=A1.new_double,Sa=A1.new_float,zt=A1.new_float_n,jt=A1.new_int,$i=A1.new_int_n,gi=A1.assert,Br=a1();function Jt(){this.last_en_subshort=zt([4,9]),this.lastAttacks=jt(4),this.pefirbuf=Sa(19),this.longfact=Sa(Br.SBMAX_l),this.shortfact=Sa(Br.SBMAX_s),this.attackthre=0,this.attackthre_s=0}Er.exports=Jt});var Ir=I0((as,Tr)=>{"use strict";function $t(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}Tr.exports=$t});var Fe=I0((os,Lr)=>{"use strict";var x1=k0(),rs=x1.System,ts=x1.VbrMode,ns=x1.Float,is=x1.ShortBlock,ss=x1.Util,_s=x1.Arrays,ls=x1.new_array_n,gt=x1.new_byte,e2=x1.new_double,D1=x1.new_float,fe=x1.new_float_n,z1=x1.new_int,je=x1.new_int_n,vs=x1.assert,a2=Rr(),r2=ca(),t2=yr(),n2=Ir(),pr=ba(),U0=a1(),i2=Ce();ae.MFSIZE=3*1152+U0.ENCDELAY-U0.MDCTDELAY;ae.MAX_HEADER_BUF=256;ae.MAX_BITS_PER_CHANNEL=4095;ae.MAX_BITS_PER_GRANULE=7680;ae.BPC=320;function ae(){var x=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=fe([2,ae.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new a2,this.ms_ratio=D1(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=z1(2),this.CurrentStep=z1(2),this.masking_lower=0,this.bv_scf=z1(576),this.pseudohalf=z1(i2.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*ae.BPC+1),this.itime=e2(2),this.sideinfo_len=0,this.sb_sample=fe([2,2,18,U0.SBLIMIT]),this.amp_filter=D1(32);function F(){this.write_timing=0,this.ptr=0,this.buf=gt(x)}this.header=new Array(ae.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new r2,this.minval_l=D1(U0.CBANDS),this.minval_s=D1(U0.CBANDS),this.nb_1=fe([4,U0.CBANDS]),this.nb_2=fe([4,U0.CBANDS]),this.nb_s1=fe([4,U0.CBANDS]),this.nb_s2=fe([4,U0.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=D1(4),this.loudness_sq=fe([2,2]),this.loudness_sq_save=D1(2),this.mld_l=D1(U0.SBMAX_l),this.mld_s=D1(U0.SBMAX_s),this.bm_l=z1(U0.SBMAX_l),this.bo_l=z1(U0.SBMAX_l),this.bm_s=z1(U0.SBMAX_s),this.bo_s=z1(U0.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=je([U0.CBANDS,2]),this.s3ind_s=je([U0.CBANDS,2]),this.numlines_s=z1(U0.CBANDS),this.numlines_l=z1(U0.CBANDS),this.rnumlines_l=D1(U0.CBANDS),this.mld_cb_l=D1(U0.CBANDS),this.mld_cb_s=D1(U0.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=D1(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=z1(2),this.nsPsy=new t2,this.VBR_seek_table=new n2,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=je([16,5]),this.bitrate_blockType_Hist=je([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var G=0;G<this.en.length;G++)this.en[G]=new pr;for(var G=0;G<this.thm.length;G++)this.thm[G]=new pr;for(var G=0;G<this.header.length;G++)this.header[G]=new F}Lr.exports=ae});var Nr=I0((Bs,Vr)=>{"use strict";var M1=k0(),us=M1.System,hs=M1.VbrMode,fs=M1.Float,bs=M1.ShortBlock,ms=M1.Util,cs=M1.Arrays,Ss=M1.new_array_n,ds=M1.new_byte,As=M1.new_double,be=M1.new_float,xs=M1.new_float_n,Ms=M1.new_int,Rs=M1.new_int_n,ws=M1.assert,me=a1();function s2(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=be(me.SBMAX_l),this.s=be(me.SBMAX_s),this.psfb21=be(me.PSFB21),this.psfb12=be(me.PSFB12),this.cb_l=be(me.CBANDS),this.cb_s=be(me.CBANDS),this.eql_w=be(me.BLKSIZE/2)}Vr.exports=s2});var da=I0((ks,Or)=>{"use strict";var w1=k0(),R1=w1.System,Es=w1.VbrMode,ys=w1.Float,Ts=w1.ShortBlock,Is=w1.Util,Hr=w1.Arrays,ps=w1.new_array_n,Ls=w1.new_byte,Vs=w1.new_double,Ns=w1.new_float,Hs=w1.new_float_n,Os=w1.new_int,Cs=w1.new_int_n,Fs=w1.assert;O0.STEPS_per_dB=100;O0.MAX_dB=120;O0.GAIN_NOT_ENOUGH_SAMPLES=-24601;O0.GAIN_ANALYSIS_ERROR=0;O0.GAIN_ANALYSIS_OK=1;O0.INIT_GAIN_ANALYSIS_ERROR=0;O0.INIT_GAIN_ANALYSIS_OK=1;O0.YULE_ORDER=10;O0.MAX_ORDER=O0.YULE_ORDER;O0.MAX_SAMP_FREQ=48e3;O0.RMS_WINDOW_TIME_NUMERATOR=1;O0.RMS_WINDOW_TIME_DENOMINATOR=20;O0.MAX_SAMPLES_PER_WINDOW=O0.MAX_SAMP_FREQ*O0.RMS_WINDOW_TIME_NUMERATOR/O0.RMS_WINDOW_TIME_DENOMINATOR+1;function O0(){var x=64.82,F=O0.YULE_ORDER,G=.95,Y=O0.MAX_SAMP_FREQ,l0=O0.RMS_WINDOW_TIME_NUMERATOR,q=O0.RMS_WINDOW_TIME_DENOMINATOR,r0=O0.MAX_SAMPLES_PER_WINDOW,j=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],n0=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o0(e,R,m,c,o,b){for(;o--!=0;)m[c]=1e-10+e[R+0]*b[0]-m[c-1]*b[1]+e[R-1]*b[2]-m[c-2]*b[3]+e[R-2]*b[4]-m[c-3]*b[5]+e[R-3]*b[6]-m[c-4]*b[7]+e[R-4]*b[8]-m[c-5]*b[9]+e[R-5]*b[10]-m[c-6]*b[11]+e[R-6]*b[12]-m[c-7]*b[13]+e[R-7]*b[14]-m[c-8]*b[15]+e[R-8]*b[16]-m[c-9]*b[17]+e[R-9]*b[18]-m[c-10]*b[19]+e[R-10]*b[20],++c,++R}function V(e,R,m,c,o,b){for(;o--!=0;)m[c]=e[R+0]*b[0]-m[c-1]*b[1]+e[R-1]*b[2]-m[c-2]*b[3]+e[R-2]*b[4],++c,++R}function U(e,R){for(var m=0;m<MAX_ORDER;m++)e.linprebuf[m]=e.lstepbuf[m]=e.loutbuf[m]=e.rinprebuf[m]=e.rstepbuf[m]=e.routbuf[m]=0;switch(0|R){case 48e3:e.reqindex=0;break;case 44100:e.reqindex=1;break;case 32e3:e.reqindex=2;break;case 24e3:e.reqindex=3;break;case 22050:e.reqindex=4;break;case 16e3:e.reqindex=5;break;case 12e3:e.reqindex=6;break;case 11025:e.reqindex=7;break;case 8e3:e.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return e.sampleWindow=0|(R*l0+q-1)/q,e.lsum=0,e.rsum=0,e.totsamp=0,Hr.ill(e.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(e,R){return U(e,R)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(e.linpre=MAX_ORDER,e.rinpre=MAX_ORDER,e.lstep=MAX_ORDER,e.rstep=MAX_ORDER,e.lout=MAX_ORDER,e.rout=MAX_ORDER,Hr.fill(e.B,0),INIT_GAIN_ANALYSIS_OK)};function T(e){return e*e}this.AnalyzeSamples=function(e,R,m,c,o,b,N){var S,w,l,u,B,s,_;if(b==0)return GAIN_ANALYSIS_OK;switch(_=0,B=b,N){case 1:c=R,o=m;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(b<MAX_ORDER?(R1.arraycopy(R,m,e.linprebuf,MAX_ORDER,b),R1.arraycopy(c,o,e.rinprebuf,MAX_ORDER,b)):(R1.arraycopy(R,m,e.linprebuf,MAX_ORDER,MAX_ORDER),R1.arraycopy(c,o,e.rinprebuf,MAX_ORDER,MAX_ORDER));B>0;){s=B>e.sampleWindow-e.totsamp?e.sampleWindow-e.totsamp:B,_<MAX_ORDER?(S=e.linpre+_,w=e.linprebuf,l=e.rinpre+_,u=e.rinprebuf,s>MAX_ORDER-_&&(s=MAX_ORDER-_)):(S=m+_,w=R,l=o+_,u=c),o0(w,S,e.lstepbuf,e.lstep+e.totsamp,s,j[e.reqindex]),o0(u,l,e.rstepbuf,e.rstep+e.totsamp,s,j[e.reqindex]),V(e.lstepbuf,e.lstep+e.totsamp,e.loutbuf,e.lout+e.totsamp,s,n0[e.reqindex]),V(e.rstepbuf,e.rstep+e.totsamp,e.routbuf,e.rout+e.totsamp,s,n0[e.reqindex]),S=e.lout+e.totsamp,w=e.loutbuf,l=e.rout+e.totsamp,u=e.routbuf;for(var a=s%8;a--!=0;)e.lsum+=T(w[S++]),e.rsum+=T(u[l++]);for(a=s/8;a--!=0;)e.lsum+=T(w[S+0])+T(w[S+1])+T(w[S+2])+T(w[S+3])+T(w[S+4])+T(w[S+5])+T(w[S+6])+T(w[S+7]),S+=8,e.rsum+=T(u[l+0])+T(u[l+1])+T(u[l+2])+T(u[l+3])+T(u[l+4])+T(u[l+5])+T(u[l+6])+T(u[l+7]),l+=8;if(B-=s,_+=s,e.totsamp+=s,e.totsamp==e.sampleWindow){var r=O0.STEPS_per_dB*10*Math.log10((e.lsum+e.rsum)/e.totsamp*.5+1e-37),n=r<=0?0:0|r;n>=e.A.length&&(n=e.A.length-1),e.A[n]++,e.lsum=e.rsum=0,R1.arraycopy(e.loutbuf,e.totsamp,e.loutbuf,0,MAX_ORDER),R1.arraycopy(e.routbuf,e.totsamp,e.routbuf,0,MAX_ORDER),R1.arraycopy(e.lstepbuf,e.totsamp,e.lstepbuf,0,MAX_ORDER),R1.arraycopy(e.rstepbuf,e.totsamp,e.rstepbuf,0,MAX_ORDER),e.totsamp=0}if(e.totsamp>e.sampleWindow)return GAIN_ANALYSIS_ERROR}return b<MAX_ORDER?(R1.arraycopy(e.linprebuf,b,e.linprebuf,0,MAX_ORDER-b),R1.arraycopy(e.rinprebuf,b,e.rinprebuf,0,MAX_ORDER-b),R1.arraycopy(R,m,e.linprebuf,MAX_ORDER-b,b),R1.arraycopy(c,o,e.rinprebuf,MAX_ORDER-b,b)):(R1.arraycopy(R,m+b-MAX_ORDER,e.linprebuf,0,MAX_ORDER),R1.arraycopy(c,o+b-MAX_ORDER,e.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function I(e,R){var m,c=0;for(m=0;m<R;m++)c+=e[m];if(c==0)return GAIN_NOT_ENOUGH_SAMPLES;var o=0|Math.ceil(c*(1-G));for(m=R;m-- >0&&!((o-=e[m])<=0););return x-m/O0.STEPS_per_dB}this.GetTitleGain=function(e){for(var R=I(e.A,e.A.length),m=0;m<e.A.length;m++)e.B[m]+=e.A[m],e.A[m]=0;for(var m=0;m<MAX_ORDER;m++)e.linprebuf[m]=e.lstepbuf[m]=e.loutbuf[m]=e.rinprebuf[m]=e.rstepbuf[m]=e.routbuf[m]=0;return e.totsamp=0,e.lsum=e.rsum=0,R}}Or.exports=O0});var kr=I0((js,Fr)=>{"use strict";var E1=k0(),qs=E1.System,Xs=E1.VbrMode,Ys=E1.Float,Ds=E1.ShortBlock,Gs=E1.Util,Us=E1.Arrays,Ks=E1.new_array_n,Zs=E1.new_byte,Ps=E1.new_double,ye=E1.new_float,Qs=E1.new_float_n,Cr=E1.new_int,Ws=E1.new_int_n,zs=E1.assert,B1=da();function _2(){this.linprebuf=ye(B1.MAX_ORDER*2),this.linpre=0,this.lstepbuf=ye(B1.MAX_SAMPLES_PER_WINDOW+B1.MAX_ORDER),this.lstep=0,this.loutbuf=ye(B1.MAX_SAMPLES_PER_WINDOW+B1.MAX_ORDER),this.lout=0,this.rinprebuf=ye(B1.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=ye(B1.MAX_SAMPLES_PER_WINDOW+B1.MAX_ORDER),this.rstep=0,this.routbuf=ye(B1.MAX_SAMPLES_PER_WINDOW+B1.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=Cr(0|B1.STEPS_per_dB*B1.MAX_dB),this.B=Cr(0|B1.STEPS_per_dB*B1.MAX_dB)}Fr.exports=_2});var Aa=I0((Js,qr)=>{"use strict";function l2(x){this.bits=x}qr.exports=l2});var Ur=I0((v_,Gr)=>{"use strict";var y1=k0(),$s=y1.System,gs=y1.VbrMode,e_=y1.Float,a_=y1.ShortBlock,r_=y1.Util,t_=y1.Arrays,n_=y1.new_array_n,i_=y1.new_byte,s_=y1.new_double,Xr=y1.new_float,__=y1.new_float_n,v2=y1.new_int,l_=y1.new_int_n,Yr=y1.assert,o2=Aa(),Dr=a1(),u2=Ce(),h2=Fe();function f2(x){var F=x;this.quantize=F,this.iteration_loop=function(G,Y,l0,q){var r0=G.internal_flags,j=Xr(u2.SFBMAX),n0=Xr(576),o0=v2(2),V=0,U,T=r0.l3_side,I=new o2(V);this.quantize.rv.ResvFrameBegin(G,I),V=I.bits;for(var e=0;e<r0.mode_gr;e++){U=this.quantize.qupvt.on_pe(G,Y,o0,V,e,e),r0.mode_ext==Dr.MPG_MD_MS_LR&&(this.quantize.ms_convert(r0.l3_side,e),this.quantize.qupvt.reduce_side(o0,l0[e],V,U));for(var R=0;R<r0.channels_out;R++){var m,c,o=T.tt[e][R];o.block_type!=Dr.SHORT_TYPE?(m=0,c=r0.PSY.mask_adjust-m):(m=0,c=r0.PSY.mask_adjust_short-m),r0.masking_lower=Math.pow(10,c*.1),this.quantize.init_outer_loop(r0,o),this.quantize.init_xrpow(r0,o,n0)&&(this.quantize.qupvt.calc_xmin(G,q[e][R],o,j),this.quantize.outer_loop(G,o,j,n0,R,o0[R])),this.quantize.iteration_finish_one(r0,e,R),Yr(o.part2_3_length<=h2.MAX_BITS_PER_CHANNEL),Yr(o.part2_3_length<=o0[R])}}this.quantize.rv.ResvFrameEnd(r0,V)}}Gr.exports=f2});var Je=I0((o_,Kr)=>{"use strict";function p0(x,F,G,Y){this.xlen=x,this.linmax=F,this.table=G,this.hlen=Y}var a0={};a0.t1HB=[1,1,1,0];a0.t2HB=[1,2,1,3,1,1,3,2,0];a0.t3HB=[3,2,1,1,1,1,3,2,0];a0.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];a0.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];a0.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];a0.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];a0.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];a0.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];a0.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];a0.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];a0.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];a0.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];a0.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];a0.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];a0.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];a0.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];a0.t1l=[1,4,3,5];a0.t2l=[1,4,7,4,5,7,6,7,8];a0.t3l=[2,3,7,4,4,7,6,7,8];a0.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];a0.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];a0.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];a0.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];a0.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];a0.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];a0.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];a0.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];a0.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];a0.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];a0.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];a0.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];a0.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];a0.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10];a0.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8];a0.ht=[new p0(0,0,null,null),new p0(2,0,a0.t1HB,a0.t1l),new p0(3,0,a0.t2HB,a0.t2l),new p0(3,0,a0.t3HB,a0.t3l),new p0(0,0,null,null),new p0(4,0,a0.t5HB,a0.t5l),new p0(4,0,a0.t6HB,a0.t6l),new p0(6,0,a0.t7HB,a0.t7l),new p0(6,0,a0.t8HB,a0.t8l),new p0(6,0,a0.t9HB,a0.t9l),new p0(8,0,a0.t10HB,a0.t10l),new p0(8,0,a0.t11HB,a0.t11l),new p0(8,0,a0.t12HB,a0.t12l),new p0(16,0,a0.t13HB,a0.t13l),new p0(0,0,null,a0.t16_5l),new p0(16,0,a0.t15HB,a0.t15l),new p0(1,1,a0.t16HB,a0.t16l),new p0(2,3,a0.t16HB,a0.t16l),new p0(3,7,a0.t16HB,a0.t16l),new p0(4,15,a0.t16HB,a0.t16l),new p0(6,63,a0.t16HB,a0.t16l),new p0(8,255,a0.t16HB,a0.t16l),new p0(10,1023,a0.t16HB,a0.t16l),new p0(13,8191,a0.t16HB,a0.t16l),new p0(4,15,a0.t24HB,a0.t24l),new p0(5,31,a0.t24HB,a0.t24l),new p0(6,63,a0.t24HB,a0.t24l),new p0(7,127,a0.t24HB,a0.t24l),new p0(8,255,a0.t24HB,a0.t24l),new p0(9,511,a0.t24HB,a0.t24l),new p0(11,2047,a0.t24HB,a0.t24l),new p0(13,8191,a0.t24HB,a0.t24l),new p0(0,0,a0.t32HB,a0.t32l),new p0(0,0,a0.t33HB,a0.t33l)];a0.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];a0.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];a0.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];a0.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];a0.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];a0.scfsi_band=[0,6,11,16,21];Kr.exports=a0});var Ma=I0((d_,Qr)=>{"use strict";var re=ca(),T1=k0(),Zr=T1.System,ce=T1.VbrMode,$e=T1.Float,u_=T1.ShortBlock,xa=T1.Util,h_=T1.Arrays,f_=T1.new_array_n,b_=T1.new_byte,m_=T1.new_double,Se=T1.new_float,c_=T1.new_float_n,Pr=T1.new_int,S_=T1.new_int_n,te=T1.assert,g0=a1(),b2=Aa(),r1=Fe();q1.Q_MAX=257;q1.Q_MAX2=116;q1.LARGE_BITS=1e5;q1.IXMAX_VAL=8206;function q1(){var x=ge(),F=null,G=null,Y=null;this.setModules=function(S,w,l){F=S,G=w,Y=l};function l0(S){return te(0<=S+q1.Q_MAX2&&S<q1.Q_MAX),I[S+q1.Q_MAX2]}this.IPOW20=function(S){return te(0<=S&&S<q1.Q_MAX),e[S]};var q=2220446049250313e-31,r0=q1.IXMAX_VAL,j=r0+2,n0=q1.Q_MAX,o0=q1.Q_MAX2,V=q1.LARGE_BITS,U=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var T=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=T,this.sfBandIndex=[new re([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new re([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var I=Se(n0+o0+1),e=Se(n0),R=Se(j),m=Se(j);this.adj43=m;function c(S,w){var l=Y.ATHformula(w,S);return l-=U,l=Math.pow(10,l/10+S.ATHlower),l}function o(S){for(var w=S.internal_flags.ATH.l,l=S.internal_flags.ATH.psfb21,u=S.internal_flags.ATH.s,B=S.internal_flags.ATH.psfb12,s=S.internal_flags,_=S.out_samplerate,a=0;a<g0.SBMAX_l;a++){var r=s.scalefac_band.l[a],n=s.scalefac_band.l[a+1];w[a]=$e.MAX_VALUE;for(var i=r;i<n;i++){var d=i*_/1152,E=c(S,d);w[a]=Math.min(w[a],E)}}for(var a=0;a<g0.PSFB21;a++){var r=s.scalefac_band.psfb21[a],n=s.scalefac_band.psfb21[a+1];l[a]=$e.MAX_VALUE;for(var i=r;i<n;i++){var d=i*_/1152,E=c(S,d);l[a]=Math.min(l[a],E)}}for(var a=0;a<g0.SBMAX_s;a++){var r=s.scalefac_band.s[a],n=s.scalefac_band.s[a+1];u[a]=$e.MAX_VALUE;for(var i=r;i<n;i++){var d=i*_/384,E=c(S,d);u[a]=Math.min(u[a],E)}u[a]*=s.scalefac_band.s[a+1]-s.scalefac_band.s[a]}for(var a=0;a<g0.PSFB12;a++){var r=s.scalefac_band.psfb12[a],n=s.scalefac_band.psfb12[a+1];B[a]=$e.MAX_VALUE;for(var i=r;i<n;i++){var d=i*_/384,E=c(S,d);B[a]=Math.min(B[a],E)}B[a]*=s.scalefac_band.s[13]-s.scalefac_band.s[12]}if(S.noATH){for(var a=0;a<g0.SBMAX_l;a++)w[a]=1e-20;for(var a=0;a<g0.PSFB21;a++)l[a]=1e-20;for(var a=0;a<g0.SBMAX_s;a++)u[a]=1e-20;for(var a=0;a<g0.PSFB12;a++)B[a]=1e-20}s.ATH.floor=10*Math.log10(c(S,-1))}this.iteration_init=function(S){var w=S.internal_flags,l=w.l3_side,u;if(w.iteration_init_init==0){for(w.iteration_init_init=1,l.main_data_begin=0,o(S),R[0]=0,u=1;u<j;u++)R[u]=Math.pow(u,4/3);for(u=0;u<j-1;u++)m[u]=u+1-Math.pow(.5*(R[u]+R[u+1]),.75);for(m[u]=.5,u=0;u<n0;u++)e[u]=Math.pow(2,(u-210)*-.1875);for(u=0;u<=n0+o0;u++)I[u]=Math.pow(2,(u-210-o0)*.25);F.huffman_init(w);{var B,s,_,a;for(u=S.exp_nspsytune>>2&63,u>=32&&(u-=64),B=Math.pow(10,u/4/10),u=S.exp_nspsytune>>8&63,u>=32&&(u-=64),s=Math.pow(10,u/4/10),u=S.exp_nspsytune>>14&63,u>=32&&(u-=64),_=Math.pow(10,u/4/10),u=S.exp_nspsytune>>20&63,u>=32&&(u-=64),a=_*Math.pow(10,u/4/10),u=0;u<g0.SBMAX_l;u++){var r;u<=6?r=B:u<=13?r=s:u<=20?r=_:r=a,w.nsPsy.longfact[u]=r}for(u=0;u<g0.SBMAX_s;u++){var r;u<=5?r=B:u<=10?r=s:u<=11?r=_:r=a,w.nsPsy.shortfact[u]=r}}}},this.on_pe=function(S,w,l,u,B,s){var _=S.internal_flags,a=0,r,n=Pr(2),i,d=new b2(a),E=G.ResvMaxBits(S,u,d,s);a=d.bits;var M=a+E;for(M>r1.MAX_BITS_PER_GRANULE&&(M=r1.MAX_BITS_PER_GRANULE),r=0,i=0;i<_.channels_out;++i)l[i]=Math.min(r1.MAX_BITS_PER_CHANNEL,a/_.channels_out),n[i]=0|l[i]*w[B][i]/700-l[i],n[i]>u*3/4&&(n[i]=u*3/4),n[i]<0&&(n[i]=0),n[i]+l[i]>r1.MAX_BITS_PER_CHANNEL&&(n[i]=Math.max(0,r1.MAX_BITS_PER_CHANNEL-l[i])),r+=n[i];if(r>E)for(i=0;i<_.channels_out;++i)n[i]=E*n[i]/r;for(i=0;i<_.channels_out;++i)l[i]+=n[i],E-=n[i];for(r=0,i=0;i<_.channels_out;++i)r+=l[i];if(r>r1.MAX_BITS_PER_GRANULE){var L=0;for(i=0;i<_.channels_out;++i)l[i]*=r1.MAX_BITS_PER_GRANULE,l[i]/=r,L+=l[i];te(L<=r1.MAX_BITS_PER_GRANULE)}return M},this.reduce_side=function(S,w,l,u){te(u<=r1.MAX_BITS_PER_GRANULE),te(S[0]+S[1]<=r1.MAX_BITS_PER_GRANULE);var B=.33*(.5-w)/.5;B<0&&(B=0),B>.5&&(B=.5);var s=0|B*.5*(S[0]+S[1]);s>r1.MAX_BITS_PER_CHANNEL-S[0]&&(s=r1.MAX_BITS_PER_CHANNEL-S[0]),s<0&&(s=0),S[1]>=125&&(S[1]-s>125?(S[0]<l&&(S[0]+=s),S[1]-=s):(S[0]+=S[1]-125,S[1]=125)),s=S[0]+S[1],s>u&&(S[0]=u*S[0]/s,S[1]=u*S[1]/s),te(S[0]<=r1.MAX_BITS_PER_CHANNEL),te(S[1]<=r1.MAX_BITS_PER_CHANNEL),te(S[0]+S[1]<=r1.MAX_BITS_PER_GRANULE)},this.athAdjust=function(S,w,l){var u=90.30873362,B=94.82444863,s=xa.FAST_LOG10_X(w,10),_=S*S,a=0;return s-=l,_>1e-20&&(a=1+xa.FAST_LOG10_X(_,10/u)),a<0&&(a=0),s*=a,s+=l+u-B,Math.pow(10,.1*s)},this.calc_xmin=function(S,w,l,u){var B=0,s=S.internal_flags,_,a=0,r=0,n=s.ATH,i=l.xr,d=S.VBR==ce.vbr_mtrh?1:0,E=s.masking_lower;for((S.VBR==ce.vbr_mtrh||S.VBR==ce.vbr_mt)&&(E=1),_=0;_<l.psy_lmax;_++){var M,L,Q,t0,t,v;S.VBR==ce.vbr_rh||S.VBR==ce.vbr_mtrh?L=athAdjust(n.adjust,n.l[_],n.floor):L=n.adjust*n.l[_],t=l.width[_],Q=L/t,t0=q,v=t>>1,M=0;do{var z,W;z=i[a]*i[a],M+=z,t0+=z<Q?z:Q,a++,W=i[a]*i[a],M+=W,t0+=W<Q?W:Q,a++}while(--v>0);if(M>L&&r++,_==g0.SBPSY_l){var e0=L*s.nsPsy.longfact[_];t0<e0&&(t0=e0)}if(d!=0&&(L=t0),!S.ATHonly){var s0=w.en.l[_];if(s0>0){var e0;e0=M*w.thm.l[_]*E/s0,d!=0&&(e0*=s.nsPsy.longfact[_]),L<e0&&(L=e0)}}d!=0?u[B++]=L:u[B++]=L*s.nsPsy.longfact[_]}var b0=575;if(l.block_type!=g0.SHORT_TYPE)for(var u0=576;u0--!=0&&x.EQ(i[u0],0);)b0=u0;l.max_nonzero_coeff=b0;for(var d0=l.sfb_smin;_<l.psymax;d0++,_+=3){var t,c0,i0;for(S.VBR==ce.vbr_rh||S.VBR==ce.vbr_mtrh?i0=athAdjust(n.adjust,n.s[d0],n.floor):i0=n.adjust*n.s[d0],t=l.width[_],c0=0;c0<3;c0++){var M=0,L,Q,t0,v=t>>1;Q=i0/t,t0=q;do{var z,W;z=i[a]*i[a],M+=z,t0+=z<Q?z:Q,a++,W=i[a]*i[a],M+=W,t0+=W<Q?W:Q,a++}while(--v>0);if(M>i0&&r++,d0==g0.SBPSY_s){var e0=i0*s.nsPsy.shortfact[d0];t0<e0&&(t0=e0)}if(d!=0?L=t0:L=i0,!S.ATHonly&&!S.ATHshort){var s0=w.en.s[d0][c0];if(s0>0){var e0;e0=M*w.thm.s[d0][c0]*E/s0,d!=0&&(e0*=s.nsPsy.shortfact[d0]),L<e0&&(L=e0)}}d!=0?u[B++]=L:u[B++]=L*s.nsPsy.shortfact[d0]}S.useTemporal&&(u[B-3]>u[B-3+1]&&(u[B-3+1]+=(u[B-3]-u[B-3+1])*s.decay),u[B-3+1]>u[B-3+2]&&(u[B-3+2]+=(u[B-3+1]-u[B-3+2])*s.decay))}return r};function b(S){this.s=S}this.calc_noise_core=function(S,w,l,u){var B=0,s=w.s,_=S.l3_enc;if(s>S.count1)for(;l--!=0;){var a;a=S.xr[s],s++,B+=a*a,a=S.xr[s],s++,B+=a*a}else if(s>S.big_values){var r=Se(2);for(r[0]=0,r[1]=u;l--!=0;){var a;a=Math.abs(S.xr[s])-r[_[s]],s++,B+=a*a,a=Math.abs(S.xr[s])-r[_[s]],s++,B+=a*a}}else for(;l--!=0;){var a;a=Math.abs(S.xr[s])-R[_[s]]*u,s++,B+=a*a,a=Math.abs(S.xr[s])-R[_[s]]*u,s++,B+=a*a}return w.s=s,B},this.calc_noise=function(S,w,l,u,B){var s=0,_=0,a,r,n=0,i=0,d=0,E=-20,M=0,L=S.scalefac,Q=0;for(u.over_SSD=0,a=0;a<S.psymax;a++){var t0=S.global_gain-(L[Q++]+(S.preflag!=0?T[a]:0)<<S.scalefac_scale+1)-S.subblock_gain[S.window[a]]*8,t=0;if(B!=null&&B.step[a]==t0)t=B.noise[a],M+=S.width[a],l[s++]=t/w[_++],t=B.noise_log[a];else{var v=l0(t0);if(r=S.width[a]>>1,M+S.width[a]>S.max_nonzero_coeff){var z;z=S.max_nonzero_coeff-M+1,z>0?r=z>>1:r=0}var W=new b(M);t=this.calc_noise_core(S,W,r,v),M=W.s,B!=null&&(B.step[a]=t0,B.noise[a]=t),t=l[s++]=t/w[_++],t=xa.FAST_LOG10(Math.max(t,1e-20)),B!=null&&(B.noise_log[a]=t)}if(B!=null&&(B.global_gain=S.global_gain),d+=t,t>0){var e0;e0=Math.max(0|t*10+.5,1),u.over_SSD+=e0*e0,n++,i+=t}E=Math.max(E,t)}return u.over_count=n,u.tot_noise=d,u.over_noise=i,u.max_noise=E,n},this.set_pinfo=function(S,w,l,u,B){var s=S.internal_flags,_,a,r,n,i,d=w.scalefac_scale==0?.5:1,E=w.scalefac,M=Se(L3Side.SFBMAX),L=Se(L3Side.SFBMAX),Q=new CalcNoiseResult;calc_xmin(S,l,w,M),calc_noise(w,M,L,Q,null);var t0=0;for(a=w.sfb_lmax,w.block_type!=g0.SHORT_TYPE&&w.mixed_block_flag==0&&(a=22),_=0;_<a;_++){var t=s.scalefac_band.l[_],v=s.scalefac_band.l[_+1],z=v-t;for(n=0;t0<v;t0++)n+=w.xr[t0]*w.xr[t0];n/=z,i=1e15,s.pinfo.en[u][B][_]=i*n,s.pinfo.xfsf[u][B][_]=i*M[_]*L[_]/z,l.en.l[_]>0&&!S.ATHonly?n=n/l.en.l[_]:n=0,s.pinfo.thr[u][B][_]=i*Math.max(n*l.thm.l[_],s.ATH.l[_]),s.pinfo.LAMEsfb[u][B][_]=0,w.preflag!=0&&_>=11&&(s.pinfo.LAMEsfb[u][B][_]=-d*T[_]),_<g0.SBPSY_l&&(te(E[_]>=0),s.pinfo.LAMEsfb[u][B][_]-=d*E[_])}if(w.block_type==g0.SHORT_TYPE)for(a=_,_=w.sfb_smin;_<g0.SBMAX_s;_++)for(var t=s.scalefac_band.s[_],v=s.scalefac_band.s[_+1],z=v-t,W=0;W<3;W++){for(n=0,r=t;r<v;r++)n+=w.xr[t0]*w.xr[t0],t0++;n=Math.max(n/z,1e-20),i=1e15,s.pinfo.en_s[u][B][3*_+W]=i*n,s.pinfo.xfsf_s[u][B][3*_+W]=i*M[a]*L[a]/z,l.en.s[_][W]>0?n=n/l.en.s[_][W]:n=0,(S.ATHonly||S.ATHshort)&&(n=0),s.pinfo.thr_s[u][B][3*_+W]=i*Math.max(n*l.thm.s[_][W],s.ATH.s[_]),s.pinfo.LAMEsfb_s[u][B][3*_+W]=-2*w.subblock_gain[W],_<g0.SBPSY_s&&(s.pinfo.LAMEsfb_s[u][B][3*_+W]-=d*E[a]),a++}s.pinfo.LAMEqss[u][B]=w.global_gain,s.pinfo.LAMEmainbits[u][B]=w.part2_3_length+w.part2_length,s.pinfo.LAMEsfbits[u][B]=w.part2_length,s.pinfo.over[u][B]=Q.over_count,s.pinfo.max_noise[u][B]=Q.max_noise*10,s.pinfo.over_noise[u][B]=Q.over_noise*10,s.pinfo.tot_noise[u][B]=Q.tot_noise*10,s.pinfo.over_SSD[u][B]=Q.over_SSD};function N(S,w){var l=S.internal_flags;l.masking_lower=1;for(var u=0;u<l.mode_gr;u++)for(var B=0;B<l.channels_out;B++){var s=l.l3_side.tt[u][B],_=Pr(L3Side.SFBMAX);if(Zr.arraycopy(s.scalefac,0,_,0,_.length),u==1){var a;for(a=0;a<s.sfb_lmax;a++)s.scalefac[a]<0&&(s.scalefac[a]=l.l3_side.tt[0][B].scalefac[a])}set_pinfo(S,s,w[u][B],u,B),Zr.arraycopy(_,0,s.scalefac,0,_.length)}}}Qr.exports=q1});var wa=I0((p_,Wr)=>{"use strict";var I1=k0(),m2=I1.System,A_=I1.VbrMode,x_=I1.Float,M_=I1.ShortBlock,R_=I1.Util,c2=I1.Arrays,w_=I1.new_array_n,B_=I1.new_byte,E_=I1.new_double,y_=I1.new_float,T_=I1.new_float_n,ke=I1.new_int,I_=I1.new_int_n,G1=I1.assert,Y0=a1(),D0=Je(),S2=Pe(),de=Ma();function Ra(){var x=null;this.qupvt=null,this.setModules=function(s){this.qupvt=s,x=s};function F(s){this.bits=0|s}var G=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function Y(s,_,a,r,n,i){var d=.5946/_;for(G1(s>0),s=s>>1;s--!=0;)n[i++]=d>a[r++]?0:1,n[i++]=d>a[r++]?0:1}function l0(s,_,a,r,n,i){G1(s>0),s=s>>1;var d=s%2;for(s=s>>1;s--!=0;){var E,M,L,Q,t0,t,v,z;E=a[r++]*_,M=a[r++]*_,t0=0|E,L=a[r++]*_,t=0|M,Q=a[r++]*_,v=0|L,E+=x.adj43[t0],z=0|Q,M+=x.adj43[t],n[i++]=0|E,L+=x.adj43[v],n[i++]=0|M,Q+=x.adj43[z],n[i++]=0|L,n[i++]=0|Q}if(d!=0){var E,M,t0,t;E=a[r++]*_,M=a[r++]*_,t0=0|E,t=0|M,E+=x.adj43[t0],M+=x.adj43[t],n[i++]=0|E,n[i++]=0|M}}function q(s,_,a,r,n){var i,d,E=0,M,L=0,Q=0,t0=0,t=_,v=0,z=t,W=0,e0=s,s0=0;for(M=n!=null&&r.global_gain==n.global_gain,r.block_type==Y0.SHORT_TYPE?d=38:d=21,i=0;i<=d;i++){var b0=-1;if((M||r.block_type==Y0.NORM_TYPE)&&(b0=r.global_gain-(r.scalefac[i]+(r.preflag!=0?x.pretab[i]:0)<<r.scalefac_scale+1)-r.subblock_gain[r.window[i]]*8),G1(r.width[i]>=0),M&&n.step[i]==b0)L!=0&&(l0(L,a,e0,s0,z,W),L=0),Q!=0&&(Y(Q,a,e0,s0,z,W),Q=0);else{var u0=r.width[i];if(E+r.width[i]>r.max_nonzero_coeff){var d0;d0=r.max_nonzero_coeff-E+1,c2.fill(_,r.max_nonzero_coeff,576,0),u0=d0,u0<0&&(u0=0),i=d+1}if(L==0&&Q==0&&(z=t,W=v,e0=s,s0=t0),n!=null&&n.sfb_count1>0&&i>=n.sfb_count1&&n.step[i]>0&&b0>=n.step[i]?(L!=0&&(l0(L,a,e0,s0,z,W),L=0,z=t,W=v,e0=s,s0=t0),Q+=u0):(Q!=0&&(Y(Q,a,e0,s0,z,W),Q=0,z=t,W=v,e0=s,s0=t0),L+=u0),u0<=0){Q!=0&&(Y(Q,a,e0,s0,z,W),Q=0),L!=0&&(l0(L,a,e0,s0,z,W),L=0);break}}i<=d&&(v+=r.width[i],t0+=r.width[i],E+=r.width[i])}L!=0&&(l0(L,a,e0,s0,z,W),L=0),Q!=0&&(Y(Q,a,e0,s0,z,W),Q=0)}function r0(s,_,a){var r=0,n=0;do{var i=s[_++],d=s[_++];r<i&&(r=i),n<d&&(n=d)}while(_<a);return r<n&&(r=n),r}function j(s,_,a,r,n,i){var d=D0.ht[r].xlen*65536+D0.ht[n].xlen,E=0,M;do{var L=s[_++],Q=s[_++];L!=0&&(L>14&&(L=15,E+=d),L*=16),Q!=0&&(Q>14&&(Q=15,E+=d),L+=Q),E+=D0.largetbl[L]}while(_<a);return M=E&65535,E>>=16,E>M&&(E=M,r=n),i.bits+=E,r}function n0(s,_,a,r){var n=0,i=D0.ht[1].hlen;do{var d=s[_+0]*2+s[_+1];_+=2,n+=i[d]}while(_<a);return r.bits+=n,1}function o0(s,_,a,r,n){var i=0,d,E=D0.ht[r].xlen,M;r==2?M=D0.table23:M=D0.table56;do{var L=s[_+0]*E+s[_+1];_+=2,i+=M[L]}while(_<a);return d=i&65535,i>>=16,i>d&&(i=d,r++),n.bits+=i,r}function V(s,_,a,r,n){var i=0,d=0,E=0,M=D0.ht[r].xlen,L=D0.ht[r].hlen,Q=D0.ht[r+1].hlen,t0=D0.ht[r+2].hlen;do{var t=s[_+0]*M+s[_+1];_+=2,i+=L[t],d+=Q[t],E+=t0[t]}while(_<a);var v=r;return i>d&&(i=d,v++),i>E&&(i=E,v=r+2),n.bits+=i,v}var U=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function T(s,_,a,r){var n=r0(s,_,a);switch(n){case 0:return n;case 1:return n0(s,_,a,r);case 2:case 3:return o0(s,_,a,U[n-1],r);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return V(s,_,a,U[n-1],r);default:if(n>de.IXMAX_VAL)return r.bits=de.LARGE_BITS,-1;n-=15;var i;for(i=24;i<32&&!(D0.ht[i].linmax>=n);i++);var d;for(d=i-8;d<24&&!(D0.ht[d].linmax>=n);d++);return j(s,_,a,d,i,r)}}this.noquant_count_bits=function(s,_,a){var r=_.l3_enc,n=Math.min(576,_.max_nonzero_coeff+2>>1<<1);for(a!=null&&(a.sfb_count1=0);n>1&&(r[n-1]|r[n-2])==0;n-=2);_.count1=n;for(var i=0,d=0;n>3;n-=4){var E;if(((r[n-1]|r[n-2]|r[n-3]|r[n-4])&2147483647)>1)break;E=((r[n-4]*2+r[n-3])*2+r[n-2])*2+r[n-1],i+=D0.t32l[E],d+=D0.t33l[E]}var M=i;if(_.count1table_select=0,i>d&&(M=d,_.count1table_select=1),_.count1bits=M,_.big_values=n,n==0)return M;if(_.block_type==Y0.SHORT_TYPE)i=3*s.scalefac_band.s[3],i>_.big_values&&(i=_.big_values),d=_.big_values;else if(_.block_type==Y0.NORM_TYPE){if(G1(n<=576),i=_.region0_count=s.bv_scf[n-2],d=_.region1_count=s.bv_scf[n-1],G1(i+d+2<Y0.SBPSY_l),d=s.scalefac_band.l[i+d+2],i=s.scalefac_band.l[i+1],d<n){var L=new F(M);_.table_select[2]=T(r,d,n,L),M=L.bits}}else _.region0_count=7,_.region1_count=Y0.SBMAX_l-1-7-1,i=s.scalefac_band.l[8],d=n,i>d&&(i=d);if(i=Math.min(i,n),d=Math.min(d,n),G1(i>=0),G1(d>=0),0<i){var L=new F(M);_.table_select[0]=T(r,0,i,L),M=L.bits}if(i<d){var L=new F(M);_.table_select[1]=T(r,i,d,L),M=L.bits}if(s.use_best_huffman==2&&(_.part2_3_length=M,best_huffman_divide(s,_),M=_.part2_3_length),a!=null&&_.block_type==Y0.NORM_TYPE){for(var Q=0;s.scalefac_band.l[Q]<_.big_values;)Q++;a.sfb_count1=Q}return M},this.count_bits=function(s,_,a,r){var n=a.l3_enc,i=de.IXMAX_VAL/x.IPOW20(a.global_gain);if(a.xrpow_max>i)return de.LARGE_BITS;if(q(_,n,x.IPOW20(a.global_gain),a,r),(s.substep_shaping&2)!=0)for(var d=0,E=a.global_gain+a.scalefac_scale,M=.634521682242439/x.IPOW20(E),L=0;L<a.sfbmax;L++){var Q=a.width[L];if(G1(Q>=0),s.pseudohalf[L]==0)d+=Q;else{var t0;for(t0=d,d+=Q;t0<d;++t0)n[t0]=_[t0]>=M?n[t0]:0}}return this.noquant_count_bits(s,a,r)};function I(s,_,a,r,n,i,d){for(var E=_.big_values,M=0;M<=22;M++)r[M]=de.LARGE_BITS;for(var M=0;M<16;M++){var L=s.scalefac_band.l[M+1];if(L>=E)break;var Q=0,t0=new F(Q),t=T(a,0,L,t0);Q=t0.bits;for(var v=0;v<8;v++){var z=s.scalefac_band.l[M+v+2];if(z>=E)break;var W=Q;t0=new F(W);var e0=T(a,L,z,t0);W=t0.bits,r[M+v]>W&&(r[M+v]=W,n[M+v]=M,i[M+v]=t,d[M+v]=e0)}}}function e(s,_,a,r,n,i,d,E){for(var M=_.big_values,L=2;L<Y0.SBMAX_l+1;L++){var Q=s.scalefac_band.l[L];if(Q>=M)break;var t0=n[L-2]+_.count1bits;if(a.part2_3_length<=t0)break;var t=new F(t0),v=T(r,Q,M,t);t0=t.bits,!(a.part2_3_length<=t0)&&(a.assign(_),a.part2_3_length=t0,a.region0_count=i[L-2],a.region1_count=L-2-i[L-2],a.table_select[0]=d[L-2],a.table_select[1]=E[L-2],a.table_select[2]=v)}}this.best_huffman_divide=function(s,_){var a=new S2,r=_.l3_enc,n=ke(23),i=ke(23),d=ke(23),E=ke(23);if(!(_.block_type==Y0.SHORT_TYPE&&s.mode_gr==1)){a.assign(_),_.block_type==Y0.NORM_TYPE&&(I(s,_,r,n,i,d,E),e(s,a,_,r,n,i,d,E));var M=a.big_values;if(!(M==0||(r[M-2]|r[M-1])>1)&&(M=_.count1+2,!(M>576))){a.assign(_),a.count1=M;var L=0,Q=0;for(G1(M<=576);M>a.big_values;M-=4){var t0=((r[M-4]*2+r[M-3])*2+r[M-2])*2+r[M-1];L+=D0.t32l[t0],Q+=D0.t33l[t0]}if(a.big_values=M,a.count1table_select=0,L>Q&&(L=Q,a.count1table_select=1),a.count1bits=L,a.block_type==Y0.NORM_TYPE)e(s,a,_,r,n,i,d,E);else{if(a.part2_3_length=L,L=s.scalefac_band.l[8],L>M&&(L=M),L>0){var t=new F(a.part2_3_length);a.table_select[0]=T(r,0,L,t),a.part2_3_length=t.bits}if(M>L){var t=new F(a.part2_3_length);a.table_select[1]=T(r,L,M,t),a.part2_3_length=t.bits}_.part2_3_length>a.part2_3_length&&_.assign(a)}}}};var R=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],m=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],c=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],o=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];Ra.slen1_tab=c,Ra.slen2_tab=o;function b(s,_){for(var a,r=_.tt[1][s],n=_.tt[0][s],i=0;i<D0.scfsi_band.length-1;i++){for(a=D0.scfsi_band[i];a<D0.scfsi_band[i+1]&&!(n.scalefac[a]!=r.scalefac[a]&&r.scalefac[a]>=0);a++);if(a==D0.scfsi_band[i+1]){for(a=D0.scfsi_band[i];a<D0.scfsi_band[i+1];a++)r.scalefac[a]=-1;_.scfsi[s][i]=1}}var d=0,E=0;for(a=0;a<11;a++)r.scalefac[a]!=-1&&(E++,d<r.scalefac[a]&&(d=r.scalefac[a]));for(var M=0,L=0;a<Y0.SBPSY_l;a++)r.scalefac[a]!=-1&&(L++,M<r.scalefac[a]&&(M=r.scalefac[a]));for(var i=0;i<16;i++)if(d<R[i]&&M<m[i]){var Q=c[i]*E+o[i]*L;r.part2_length>Q&&(r.part2_length=Q,r.scalefac_compress=i)}}this.best_scalefac_store=function(s,_,a,r){var n=r.tt[_][a],i,d,E,M,L=0;for(E=0,i=0;i<n.sfbmax;i++){var Q=n.width[i];for(G1(Q>=0),E+=Q,M=-Q;M<0&&n.l3_enc[M+E]==0;M++);M==0&&(n.scalefac[i]=L=-2)}if(n.scalefac_scale==0&&n.preflag==0){var t0=0;for(i=0;i<n.sfbmax;i++)n.scalefac[i]>0&&(t0|=n.scalefac[i]);if((t0&1)==0&&t0!=0){for(i=0;i<n.sfbmax;i++)n.scalefac[i]>0&&(n.scalefac[i]>>=1);n.scalefac_scale=L=1}}if(n.preflag==0&&n.block_type!=Y0.SHORT_TYPE&&s.mode_gr==2){for(i=11;i<Y0.SBPSY_l&&!(n.scalefac[i]<x.pretab[i]&&n.scalefac[i]!=-2);i++);if(i==Y0.SBPSY_l){for(i=11;i<Y0.SBPSY_l;i++)n.scalefac[i]>0&&(n.scalefac[i]-=x.pretab[i]);n.preflag=L=1}}for(d=0;d<4;d++)r.scfsi[a][d]=0;for(s.mode_gr==2&&_==1&&r.tt[0][a].block_type!=Y0.SHORT_TYPE&&r.tt[1][a].block_type!=Y0.SHORT_TYPE&&(b(a,r),L=0),i=0;i<n.sfbmax;i++)n.scalefac[i]==-2&&(n.scalefac[i]=0);L!=0&&(s.mode_gr==2?this.scale_bitcount(n):this.scale_bitcount_lsf(s,n))};function N(s,_){for(var a=0;a<_;++a)if(s[a]<0)return!1;return!0}var S=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],w=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],l=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(s){var _,a,r=0,n=0,i,d=s.scalefac;if(G1(N(d,s.sfbmax)),s.block_type==Y0.SHORT_TYPE)i=S,s.mixed_block_flag!=0&&(i=w);else if(i=l,s.preflag==0){for(a=11;a<Y0.SBPSY_l&&!(d[a]<x.pretab[a]);a++);if(a==Y0.SBPSY_l)for(s.preflag=1,a=11;a<Y0.SBPSY_l;a++)d[a]-=x.pretab[a]}for(a=0;a<s.sfbdivide;a++)r<d[a]&&(r=d[a]);for(;a<s.sfbmax;a++)n<d[a]&&(n=d[a]);for(s.part2_length=de.LARGE_BITS,_=0;_<16;_++)r<R[_]&&n<m[_]&&s.part2_length>i[_]&&(s.part2_length=i[_],s.scalefac_compress=_);return s.part2_length==de.LARGE_BITS};var u=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(s,_){var a,r,n,i,d,E,M,L,Q=ke(4),t0=_.scalefac;for(_.preflag!=0?a=2:a=0,M=0;M<4;M++)Q[M]=0;if(_.block_type==Y0.SHORT_TYPE){r=1;var t=x.nr_of_sfb_block[a][r];for(L=0,n=0;n<4;n++)for(i=t[n]/3,M=0;M<i;M++,L++)for(d=0;d<3;d++)t0[L*3+d]>Q[n]&&(Q[n]=t0[L*3+d])}else{r=0;var t=x.nr_of_sfb_block[a][r];for(L=0,n=0;n<4;n++)for(i=t[n],M=0;M<i;M++,L++)t0[L]>Q[n]&&(Q[n]=t0[L])}for(E=!1,n=0;n<4;n++)Q[n]>u[a][n]&&(E=!0);if(!E){var v,z,W,e0;for(_.sfb_partition_table=x.nr_of_sfb_block[a][r],n=0;n<4;n++)_.slen[n]=B[Q[n]];switch(v=_.slen[0],z=_.slen[1],W=_.slen[2],e0=_.slen[3],a){case 0:_.scalefac_compress=(v*5+z<<4)+(W<<2)+e0;break;case 1:_.scalefac_compress=400+(v*5+z<<2)+W;break;case 2:_.scalefac_compress=500+v*3+z;break;default:m2.err.printf(`intensity stereo not implemented yet
`);break}}if(!E)for(G1(_.sfb_partition_table!=null),_.part2_length=0,n=0;n<4;n++)_.part2_length+=_.slen[n]*_.sfb_partition_table[n];return E};var B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(s){for(var _=2;_<=576;_+=2){for(var a=0,r;s.scalefac_band.l[++a]<_;);for(r=G[a][0];s.scalefac_band.l[r+1]>_;)r--;for(r<0&&(r=G[a][0]),s.bv_scf[_-2]=r,r=G[a][1];s.scalefac_band.l[r+s.bv_scf[_-2]+2]>_;)r--;r<0&&(r=G[a][1]),s.bv_scf[_-1]=r}}}Wr.exports=Ra});var ge=I0((q_,jr)=>{"use strict";var p1=k0(),J1=p1.System,L_=p1.VbrMode,V_=p1.Float,N_=p1.ShortBlock,H_=p1.Util,d2=p1.Arrays,O_=p1.new_array_n,A2=p1.new_byte,C_=p1.new_double,F_=p1.new_float,x2=p1.new_float_n,M2=p1.new_int,k_=p1.new_int_n,R0=p1.assert,zr=wa(),Ba=Je(),ea=a1(),Ae=Fe();aa.EQ=function(x,F){return Math.abs(x)>Math.abs(F)?Math.abs(x-F)<=Math.abs(x)*1e-6:Math.abs(x-F)<=Math.abs(F)*1e-6};aa.NEQ=function(x,F){return!aa.EQ(x,F)};function aa(){var x=ra(),F=this,G=32773,Y=32,l0=null,q=null,r0=null,j=null;this.setModules=function(s,_,a,r){l0=s,q=_,r0=a,j=r};var n0=null,o0=0,V=0,U=0;this.getframebits=function(s){var _=s.internal_flags,a;_.bitrate_index!=0?a=Ba.bitrate_table[s.version][_.bitrate_index]:a=s.brate,R0(8<=a&&a<=640);var r=0|(s.version+1)*72e3*a/s.out_samplerate+_.padding;return 8*r};function T(s){J1.arraycopy(s.header[s.w_ptr].buf,0,n0,V,s.sideinfo_len),V+=s.sideinfo_len,o0+=s.sideinfo_len*8,s.w_ptr=s.w_ptr+1&Ae.MAX_HEADER_BUF-1}function I(s,_,a){for(R0(a<Y-2);a>0;){var r;U==0&&(U=8,V++,R0(V<x.LAME_MAXMP3BUFFER),R0(s.header[s.w_ptr].write_timing>=o0),s.header[s.w_ptr].write_timing==o0&&T(s),n0[V]=0),r=Math.min(a,U),a-=r,U-=r,R0(a<Y),R0(U<Y),n0[V]|=_>>a<<U,o0+=r}}function e(s,_,a){for(R0(a<Y-2);a>0;){var r;U==0&&(U=8,V++,R0(V<x.LAME_MAXMP3BUFFER),n0[V]=0),r=Math.min(a,U),a-=r,U-=r,R0(a<Y),R0(U<Y),n0[V]|=_>>a<<U,o0+=r}}function R(s,_){var a=s.internal_flags,r;if(R0(_>=0),_>=8&&(I(a,76,8),_-=8),_>=8&&(I(a,65,8),_-=8),_>=8&&(I(a,77,8),_-=8),_>=8&&(I(a,69,8),_-=8),_>=32){var n=r0.getLameShortVersion();if(_>=32)for(r=0;r<n.length&&_>=8;++r)_-=8,I(a,n.charAt(r),8)}for(;_>=1;_-=1)I(a,a.ancillary_flag,1),a.ancillary_flag^=s.disable_reservoir?0:1;R0(_==0)}function m(s,_,a){for(var r=s.header[s.h_ptr].ptr;a>0;){var n=Math.min(a,8-(r&7));a-=n,R0(a<Y),s.header[s.h_ptr].buf[r>>3]|=_>>a<<8-(r&7)-n,r+=n}s.header[s.h_ptr].ptr=r}function c(s,_){s<<=8;for(var a=0;a<8;a++)s<<=1,_<<=1,((_^s)&65536)!=0&&(_^=G);return _}this.CRC_writeheader=function(s,_){var a=65535;a=c(_[2]&255,a),a=c(_[3]&255,a);for(var r=6;r<s.sideinfo_len;r++)a=c(_[r]&255,a);_[4]=byte(a>>8),_[5]=byte(a&255)};function o(s,_){var a=s.internal_flags,r,n,i;if(r=a.l3_side,a.header[a.h_ptr].ptr=0,d2.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0),s.out_samplerate<16e3?m(a,4094,12):m(a,4095,12),m(a,s.version,1),m(a,1,2),m(a,s.error_protection?0:1,1),m(a,a.bitrate_index,4),m(a,a.samplerate_index,2),m(a,a.padding,1),m(a,s.extension,1),m(a,s.mode.ordinal(),2),m(a,a.mode_ext,2),m(a,s.copyright,1),m(a,s.original,1),m(a,s.emphasis,2),s.error_protection&&m(a,0,16),s.version==1){for(R0(r.main_data_begin>=0),m(a,r.main_data_begin,9),a.channels_out==2?m(a,r.private_bits,3):m(a,r.private_bits,5),i=0;i<a.channels_out;i++){var d;for(d=0;d<4;d++)m(a,r.scfsi[i][d],1)}for(n=0;n<2;n++)for(i=0;i<a.channels_out;i++){var E=r.tt[n][i];m(a,E.part2_3_length+E.part2_length,12),m(a,E.big_values/2,9),m(a,E.global_gain,8),m(a,E.scalefac_compress,4),E.block_type!=ea.NORM_TYPE?(m(a,1,1),m(a,E.block_type,2),m(a,E.mixed_block_flag,1),E.table_select[0]==14&&(E.table_select[0]=16),m(a,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),m(a,E.table_select[1],5),m(a,E.subblock_gain[0],3),m(a,E.subblock_gain[1],3),m(a,E.subblock_gain[2],3)):(m(a,0,1),E.table_select[0]==14&&(E.table_select[0]=16),m(a,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),m(a,E.table_select[1],5),E.table_select[2]==14&&(E.table_select[2]=16),m(a,E.table_select[2],5),R0(0<=E.region0_count&&E.region0_count<16),R0(0<=E.region1_count&&E.region1_count<8),m(a,E.region0_count,4),m(a,E.region1_count,3)),m(a,E.preflag,1),m(a,E.scalefac_scale,1),m(a,E.count1table_select,1)}}else for(R0(r.main_data_begin>=0),m(a,r.main_data_begin,8),m(a,r.private_bits,a.channels_out),n=0,i=0;i<a.channels_out;i++){var E=r.tt[n][i];m(a,E.part2_3_length+E.part2_length,12),m(a,E.big_values/2,9),m(a,E.global_gain,8),m(a,E.scalefac_compress,9),E.block_type!=ea.NORM_TYPE?(m(a,1,1),m(a,E.block_type,2),m(a,E.mixed_block_flag,1),E.table_select[0]==14&&(E.table_select[0]=16),m(a,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),m(a,E.table_select[1],5),m(a,E.subblock_gain[0],3),m(a,E.subblock_gain[1],3),m(a,E.subblock_gain[2],3)):(m(a,0,1),E.table_select[0]==14&&(E.table_select[0]=16),m(a,E.table_select[0],5),E.table_select[1]==14&&(E.table_select[1]=16),m(a,E.table_select[1],5),E.table_select[2]==14&&(E.table_select[2]=16),m(a,E.table_select[2],5),R0(0<=E.region0_count&&E.region0_count<16),R0(0<=E.region1_count&&E.region1_count<8),m(a,E.region0_count,4),m(a,E.region1_count,3)),m(a,E.scalefac_scale,1),m(a,E.count1table_select,1)}s.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);{var M=a.h_ptr;R0(a.header[M].ptr==a.sideinfo_len*8),a.h_ptr=M+1&Ae.MAX_HEADER_BUF-1,a.header[a.h_ptr].write_timing=a.header[M].write_timing+_,a.h_ptr==a.w_ptr&&J1.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function b(s,_){var a=Ba.ht[_.count1table_select+32],r,n=0,i=_.big_values,d=_.big_values;for(R0(_.count1table_select<2),r=(_.count1-_.big_values)/4;r>0;--r){var E=0,M=0,L;L=_.l3_enc[i+0],L!=0&&(M+=8,_.xr[d+0]<0&&E++,R0(L<=1)),L=_.l3_enc[i+1],L!=0&&(M+=4,E*=2,_.xr[d+1]<0&&E++,R0(L<=1)),L=_.l3_enc[i+2],L!=0&&(M+=2,E*=2,_.xr[d+2]<0&&E++,R0(L<=1)),L=_.l3_enc[i+3],L!=0&&(M++,E*=2,_.xr[d+3]<0&&E++,R0(L<=1)),i+=4,d+=4,I(s,E+a.table[M],a.hlen[M]),n+=a.hlen[M]}return n}function N(s,_,a,r,n){var i=Ba.ht[_],d=0;if(R0(_<32),_==0)return d;for(var E=a;E<r;E+=2){var M=0,L=0,Q=i.xlen,t0=i.xlen,t=0,v=n.l3_enc[E],z=n.l3_enc[E+1];if(v!=0&&(n.xr[E]<0&&t++,M--),_>15){if(v>14){var W=v-15;R0(W<=i.linmax),t|=W<<1,L=Q,v=15}if(z>14){var e0=z-15;R0(e0<=i.linmax),t<<=Q,t|=e0,L+=Q,z=15}t0=16}z!=0&&(t<<=1,n.xr[E+1]<0&&t++,M--),R0((v|z)<16),v=v*t0+z,L-=M,M+=i.hlen[v],R0(M<=Y),R0(L<=Y),I(s,i.table[v],M),I(s,t,L),d+=M+L}return d}function S(s,_){var a=3*s.scalefac_band.s[3];a>_.big_values&&(a=_.big_values);var r=N(s,_.table_select[0],0,a,_);return r+=N(s,_.table_select[1],a,_.big_values,_),r}function w(s,_){var a,r,n,i;a=_.big_values,R0(0<=a&&a<=576);var d=_.region0_count+1;return R0(0<=d),R0(d<s.scalefac_band.l.length),n=s.scalefac_band.l[d],d+=_.region1_count+1,R0(0<=d),R0(d<s.scalefac_band.l.length),i=s.scalefac_band.l[d],n>a&&(n=a),i>a&&(i=a),r=N(s,_.table_select[0],0,n,_),r+=N(s,_.table_select[1],n,i,_),r+=N(s,_.table_select[2],i,a,_),r}function l(s){var _,a,r,n,i=0,d=s.internal_flags,E=d.l3_side;if(s.version==1)for(_=0;_<2;_++)for(a=0;a<d.channels_out;a++){var M=E.tt[_][a],L=zr.slen1_tab[M.scalefac_compress],Q=zr.slen2_tab[M.scalefac_compress];for(n=0,r=0;r<M.sfbdivide;r++)M.scalefac[r]!=-1&&(I(d,M.scalefac[r],L),n+=L);for(;r<M.sfbmax;r++)M.scalefac[r]!=-1&&(I(d,M.scalefac[r],Q),n+=Q);R0(n==M.part2_length),M.block_type==ea.SHORT_TYPE?n+=S(d,M):n+=w(d,M),n+=b(d,M),R0(n==M.part2_3_length+M.part2_length),i+=n}else for(_=0,a=0;a<d.channels_out;a++){var M=E.tt[_][a],t0,t,v=0;if(R0(M.sfb_partition_table!=null),n=0,r=0,t=0,M.block_type==ea.SHORT_TYPE){for(;t<4;t++){var z=M.sfb_partition_table[t]/3,W=M.slen[t];for(t0=0;t0<z;t0++,r++)I(d,Math.max(M.scalefac[r*3+0],0),W),I(d,Math.max(M.scalefac[r*3+1],0),W),I(d,Math.max(M.scalefac[r*3+2],0),W),v+=3*W}n+=S(d,M)}else{for(;t<4;t++){var z=M.sfb_partition_table[t],W=M.slen[t];for(t0=0;t0<z;t0++,r++)I(d,Math.max(M.scalefac[r],0),W),v+=W}n+=w(d,M)}n+=b(d,M),R0(n==M.part2_3_length),R0(v==M.part2_length),i+=v+n}return i}function u(){this.total=0}function B(s,_){var a=s.internal_flags,r,n,i,d,E;return E=a.w_ptr,d=a.h_ptr-1,d==-1&&(d=Ae.MAX_HEADER_BUF-1),r=a.header[d].write_timing-o0,_.total=r,r>=0&&(n=1+d-E,d<E&&(n=1+d-E+Ae.MAX_HEADER_BUF),r-=n*8*a.sideinfo_len),i=F.getframebits(s),r+=i,_.total+=i,_.total%8!=0?_.total=1+_.total/8:_.total=_.total/8,_.total+=V+1,r<0&&J1.err.println(`strange error flushing buffer ... 
`),r}this.flush_bitstream=function(s){var _=s.internal_flags,a,r,n=_.h_ptr-1;if(n==-1&&(n=Ae.MAX_HEADER_BUF-1),a=_.l3_side,!((r=B(s,new u))<0)){if(R(s,r),R0(_.header[n].write_timing+this.getframebits(s)==o0),_.ResvSize=0,a.main_data_begin=0,_.findReplayGain){var i=l0.GetTitleGain(_.rgdata);R0(NEQ(i,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),_.RadioGain=Math.floor(i*10+.5)|0}_.findPeakSample&&(_.noclipGainChange=Math.ceil(Math.log10(_.PeakSample/32767)*20*10)|0,_.noclipGainChange>0&&(EQ(s.scale,1)||EQ(s.scale,0))?_.noclipScale=Math.floor(32767/_.PeakSample*100)/100:_.noclipScale=-1)}},this.add_dummy_byte=function(s,_,a){for(var r=s.internal_flags,n;a-- >0;)for(e(r,_,8),n=0;n<Ae.MAX_HEADER_BUF;++n)r.header[n].write_timing+=8},this.format_bitstream=function(s){var _=s.internal_flags,a;a=_.l3_side;var r=this.getframebits(s);R(s,a.resvDrain_pre),o(s,r);var n=8*_.sideinfo_len;if(n+=l(s),R(s,a.resvDrain_post),n+=a.resvDrain_post,a.main_data_begin+=(r-n)/8,B(s,new u)!=_.ResvSize&&J1.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),a.main_data_begin*8!=_.ResvSize&&(J1.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*a.main_data_begin,_.ResvSize,a.resvDrain_post,a.resvDrain_pre,8*_.sideinfo_len,n-a.resvDrain_post-8*_.sideinfo_len,n,n%8,r),J1.err.println("This is a fatal error.  It has several possible causes:"),J1.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),J1.err.println(" 9%%  Your system is overclocked"),J1.err.println(" 1%%  bug in LAME encoding library"),_.ResvSize=a.main_data_begin*8),R0(o0%8==0),o0>1e9){var i;for(i=0;i<Ae.MAX_HEADER_BUF;++i)_.header[i].write_timing-=o0;o0=0}return 0},this.copy_buffer=function(s,_,a,r,n){var i=V+1;if(i<=0)return 0;if(r!=0&&i>r)return-1;if(J1.arraycopy(n0,0,_,a,i),V=-1,U=0,n!=0){var d=M2(1);if(d[0]=s.nMusicCRC,j.updateMusicCRC(d,_,a,i),s.nMusicCRC=d[0],i>0&&(s.VBR_seek_table.nBytesWritten+=i),s.decode_on_the_fly){for(var E=x2([2,1152]),M=i,L=-1,Q;L!=0;)if(L=q.hip_decode1_unclipped(s.hip,_,a,M,E[0],E[1]),M=0,L==-1&&(L=0),L>0){if(R0(L<=1152),s.findPeakSample){for(Q=0;Q<L;Q++)E[0][Q]>s.PeakSample?s.PeakSample=E[0][Q]:-E[0][Q]>s.PeakSample&&(s.PeakSample=-E[0][Q]);if(s.channels_out>1)for(Q=0;Q<L;Q++)E[1][Q]>s.PeakSample?s.PeakSample=E[1][Q]:-E[1][Q]>s.PeakSample&&(s.PeakSample=-E[1][Q])}if(s.findReplayGain&&l0.AnalyzeSamples(s.rgdata,E[0],0,E[1],0,L,s.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return i},this.init_bit_stream_w=function(s){n0=A2(x.LAME_MAXMP3BUFFER),s.h_ptr=s.w_ptr=0,s.header[s.h_ptr].write_timing=0,V=-1,U=0,o0=0}}jr.exports=aa});var ra=I0((Q_,$r)=>{"use strict";var t1=k0(),R2=t1.System,V0=t1.VbrMode,X_=t1.Float,Ea=t1.ShortBlock,Y_=t1.Util,D_=t1.Arrays,G_=t1.new_array_n,U_=t1.new_byte,K_=t1.new_double,xe=t1.new_float,Z_=t1.new_float_n,P_=t1.new_int,Jr=t1.new_int_n,w2=t1.new_short_n,X1=t1.assert,ya=br(),B2=cr(),qe=Fe(),E2=Nr(),y2=kr(),T2=Ur(),Me=ge(),$1=Je(),K0=a1();function j0(){var x=He(),F=this,G=128*1024;j0.V9=410,j0.V8=420,j0.V7=430,j0.V6=440,j0.V5=450,j0.V4=460,j0.V3=470,j0.V2=480,j0.V1=490,j0.V0=500,j0.R3MIX=1e3,j0.STANDARD=1001,j0.EXTREME=1002,j0.INSANE=1003,j0.STANDARD_FAST=1004,j0.EXTREME_FAST=1005,j0.MEDIUM=1006,j0.MEDIUM_FAST=1007;var Y=16384+G;j0.LAME_MAXMP3BUFFER=Y;var l0,q,r0,j,n0,o0=new ya,V,U,T,I;this.enc=new K0,this.setModules=function(t,v,z,W,e0,s0,b0,u0,d0){l0=t,q=v,r0=z,j=W,n0=e0,V=s0,U=b0,T=u0,I=d0,this.enc.setModules(q,o0,j,V)};function e(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=xe(K0.SBMAX_l),this.bo_s_weight=xe(K0.SBMAX_s)}function R(){this.lowerlimit=0}function m(t,v){this.lowpass=v}var c=4294479419;function o(t){var v;return t.class_id=c,v=t.internal_flags=new qe,t.mode=x.NOT_SET,t.original=1,t.in_samplerate=44100,t.num_channels=2,t.num_samples=-1,t.bWriteVbrTag=!0,t.quality=-1,t.short_blocks=null,v.subblock_gain=-1,t.lowpassfreq=0,t.highpassfreq=0,t.lowpasswidth=-1,t.highpasswidth=-1,t.VBR=V0.vbr_off,t.VBR_q=4,t.ATHcurve=-1,t.VBR_mean_bitrate_kbps=128,t.VBR_min_bitrate_kbps=0,t.VBR_max_bitrate_kbps=0,t.VBR_hard_min=0,v.VBR_min_bitrate=1,v.VBR_max_bitrate=13,t.quant_comp=-1,t.quant_comp_short=-1,t.msfix=-1,v.resample_ratio=1,v.OldValue[0]=180,v.OldValue[1]=180,v.CurrentStep[0]=4,v.CurrentStep[1]=4,v.masking_lower=1,v.nsPsy.attackthre=-1,v.nsPsy.attackthre_s=-1,t.scale=-1,t.athaa_type=-1,t.ATHtype=-1,t.athaa_loudapprox=-1,t.athaa_sensitivity=0,t.useTemporal=null,t.interChRatio=-1,v.mf_samples_to_encode=K0.ENCDELAY+K0.POSTDELAY,t.encoder_padding=0,v.mf_size=K0.ENCDELAY-K0.MDCTDELAY,t.findReplayGain=!1,t.decode_on_the_fly=!1,v.decode_on_the_fly=!1,v.findReplayGain=!1,v.findPeakSample=!1,v.RadioGain=0,v.AudiophileGain=0,v.noclipGainChange=0,v.noclipScale=-1,t.preset=0,t.write_id3tag_automatic=!0,0}this.lame_init=function(){var t=new B2,v=o(t);return v!=0?null:(t.lame_allocated_gfp=1,t)};function b(t){return t>1?0:t<=0?1:Math.cos(Math.PI/2*t)}this.nearestBitrateFullIndex=function(t){var v=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],z=0,W=0,e0=0,s0=0;s0=v[16],e0=16,W=v[16],z=16;for(var b0=0;b0<16;b0++)if(Math.max(t,v[b0+1])!=t){s0=v[b0+1],e0=b0+1,W=v[b0],z=b0;break}return s0-t>t-W?z:e0};function N(t,v){var z=44100;return v>=48e3?z=48e3:v>=44100?z=44100:v>=32e3?z=32e3:v>=24e3?z=24e3:v>=22050?z=22050:v>=16e3?z=16e3:v>=12e3?z=12e3:v>=11025?z=11025:v>=8e3&&(z=8e3),t==-1?z:(t<=15960&&(z=44100),t<=15250&&(z=32e3),t<=11220&&(z=24e3),t<=9970&&(z=22050),t<=7230&&(z=16e3),t<=5420&&(z=12e3),t<=4510&&(z=11025),t<=3970&&(z=8e3),v<z?v>44100?48e3:v>32e3?44100:v>24e3?32e3:v>22050?24e3:v>16e3?22050:v>12e3?16e3:v>11025?12e3:v>8e3?11025:8e3:z)}function S(t,v){switch(t){case 44100:return v.version=1,0;case 48e3:return v.version=1,1;case 32e3:return v.version=1,2;case 22050:return v.version=0,0;case 24e3:return v.version=0,1;case 16e3:return v.version=0,2;case 11025:return v.version=0,0;case 12e3:return v.version=0,1;case 8e3:return v.version=0,2;default:return v.version=0,-1}}function w(t,v,z){z<16e3&&(v=2);for(var W=$1.bitrate_table[v][1],e0=2;e0<=14;e0++)$1.bitrate_table[v][e0]>0&&Math.abs($1.bitrate_table[v][e0]-t)<Math.abs(W-t)&&(W=$1.bitrate_table[v][e0]);return W}function l(t,v,z){z<16e3&&(v=2);for(var W=0;W<=14;W++)if($1.bitrate_table[v][W]>0&&$1.bitrate_table[v][W]==t)return W;return-1}function u(t,v){var z=[new m(8,2e3),new m(16,3700),new m(24,3900),new m(32,5500),new m(40,7e3),new m(48,7500),new m(56,1e4),new m(64,11e3),new m(80,13500),new m(96,15100),new m(112,15600),new m(128,17e3),new m(160,17500),new m(192,18600),new m(224,19400),new m(256,19700),new m(320,20500)],W=F.nearestBitrateFullIndex(v);t.lowerlimit=z[W].lowpass}function B(t){var v=t.internal_flags,z=32,W=-1;if(v.lowpass1>0){for(var e0=999,s0=0;s0<=31;s0++){var b0=s0/31;b0>=v.lowpass2&&(z=Math.min(z,s0)),v.lowpass1<b0&&b0<v.lowpass2&&(e0=Math.min(e0,s0))}e0==999?v.lowpass1=(z-.75)/31:v.lowpass1=(e0-.75)/31,v.lowpass2=z/31}if(v.highpass2>0&&v.highpass2<.9*(.75/31)&&(v.highpass1=0,v.highpass2=0,R2.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),v.highpass2>0){for(var u0=-1,s0=0;s0<=31;s0++){var b0=s0/31;b0<=v.highpass1&&(W=Math.max(W,s0)),v.highpass1<b0&&b0<v.highpass2&&(u0=Math.max(u0,s0))}v.highpass1=W/31,u0==-1?v.highpass2=(W+.75)/31:v.highpass2=(u0+.75)/31}for(var s0=0;s0<32;s0++){var d0,c0,b0=s0/31;v.highpass2>v.highpass1?d0=b((v.highpass2-b0)/(v.highpass2-v.highpass1+1e-20)):d0=1,v.lowpass2>v.lowpass1?c0=b((b0-v.lowpass1)/(v.lowpass2-v.lowpass1+1e-20)):c0=1,v.amp_filter[s0]=d0*c0}}function s(t){var v=t.internal_flags;switch(t.quality){default:case 9:v.psymodel=0,v.noise_shaping=0,v.noise_shaping_amp=0,v.noise_shaping_stop=0,v.use_best_huffman=0,v.full_outer_loop=0;break;case 8:t.quality=7;case 7:v.psymodel=1,v.noise_shaping=0,v.noise_shaping_amp=0,v.noise_shaping_stop=0,v.use_best_huffman=0,v.full_outer_loop=0;break;case 6:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.noise_shaping_amp=0,v.noise_shaping_stop=0,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=0,v.full_outer_loop=0;break;case 5:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.noise_shaping_amp=0,v.noise_shaping_stop=0,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=0,v.full_outer_loop=0;break;case 4:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.noise_shaping_amp=0,v.noise_shaping_stop=0,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=1,v.full_outer_loop=0;break;case 3:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.noise_shaping_amp=1,v.noise_shaping_stop=1,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=1,v.full_outer_loop=0;break;case 2:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.substep_shaping==0&&(v.substep_shaping=2),v.noise_shaping_amp=1,v.noise_shaping_stop=1,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=1,v.full_outer_loop=0;break;case 1:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.substep_shaping==0&&(v.substep_shaping=2),v.noise_shaping_amp=2,v.noise_shaping_stop=1,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=1,v.full_outer_loop=0;break;case 0:v.psymodel=1,v.noise_shaping==0&&(v.noise_shaping=1),v.substep_shaping==0&&(v.substep_shaping=2),v.noise_shaping_amp=2,v.noise_shaping_stop=1,v.subblock_gain==-1&&(v.subblock_gain=1),v.use_best_huffman=1,v.full_outer_loop=0;break}}function _(t){var v=t.internal_flags;t.frameNum=0,t.write_id3tag_automatic&&T.id3tag_write_v2(t),v.bitrate_stereoMode_Hist=Jr([16,5]),v.bitrate_blockType_Hist=Jr([16,6]),v.PeakSample=0,t.bWriteVbrTag&&V.InitVbrTag(t)}this.lame_init_params=function(t){var v=t.internal_flags;if(v.Class_ID=0,v.ATH==null&&(v.ATH=new E2),v.PSY==null&&(v.PSY=new e),v.rgdata==null&&(v.rgdata=new y2),v.channels_in=t.num_channels,v.channels_in==1&&(t.mode=x.MONO),v.channels_out=t.mode==x.MONO?1:2,v.mode_ext=K0.MPG_MD_MS_LR,t.mode==x.MONO&&(t.force_ms=!1),t.VBR==V0.vbr_off&&t.VBR_mean_bitrate_kbps!=128&&t.brate==0&&(t.brate=t.VBR_mean_bitrate_kbps),t.VBR==V0.vbr_off||t.VBR==V0.vbr_mtrh||t.VBR==V0.vbr_mt||(t.free_format=!1),t.VBR==V0.vbr_off&&t.brate==0&&Me.EQ(t.compression_ratio,0)&&(t.compression_ratio=11.025),t.VBR==V0.vbr_off&&t.compression_ratio>0&&(t.out_samplerate==0&&(t.out_samplerate=map2MP3Frequency(int(.97*t.in_samplerate))),t.brate=0|t.out_samplerate*16*v.channels_out/(1e3*t.compression_ratio),v.samplerate_index=S(t.out_samplerate,t),t.free_format||(t.brate=w(t.brate,t.version,t.out_samplerate))),t.out_samplerate!=0&&(t.out_samplerate<16e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,64)):t.out_samplerate<32e3?(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,8),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,160)):(t.VBR_mean_bitrate_kbps=Math.max(t.VBR_mean_bitrate_kbps,32),t.VBR_mean_bitrate_kbps=Math.min(t.VBR_mean_bitrate_kbps,320))),t.lowpassfreq==0){var z=16e3;switch(t.VBR){case V0.vbr_off:{var W=new R;u(W,t.brate),z=W.lowerlimit;break}case V0.vbr_abr:{var W=new R;u(W,t.VBR_mean_bitrate_kbps),z=W.lowerlimit;break}case V0.vbr_rh:{var e0=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=t.VBR_q&&t.VBR_q<=9){var s0=e0[t.VBR_q],b0=e0[t.VBR_q+1],u0=t.VBR_q_frac;z=linear_int(s0,b0,u0)}else z=19500;break}default:{var e0=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=t.VBR_q&&t.VBR_q<=9){var s0=e0[t.VBR_q],b0=e0[t.VBR_q+1],u0=t.VBR_q_frac;z=linear_int(s0,b0,u0)}else z=19500}}t.mode==x.MONO&&(t.VBR==V0.vbr_off||t.VBR==V0.vbr_abr)&&(z*=1.5),t.lowpassfreq=z|0}if(t.out_samplerate==0&&(2*t.lowpassfreq>t.in_samplerate&&(t.lowpassfreq=t.in_samplerate/2),t.out_samplerate=N(t.lowpassfreq|0,t.in_samplerate)),t.lowpassfreq=Math.min(20500,t.lowpassfreq),t.lowpassfreq=Math.min(t.out_samplerate/2,t.lowpassfreq),t.VBR==V0.vbr_off&&(t.compression_ratio=t.out_samplerate*16*v.channels_out/(1e3*t.brate)),t.VBR==V0.vbr_abr&&(t.compression_ratio=t.out_samplerate*16*v.channels_out/(1e3*t.VBR_mean_bitrate_kbps)),t.bWriteVbrTag||(t.findReplayGain=!1,t.decode_on_the_fly=!1,v.findPeakSample=!1),v.findReplayGain=t.findReplayGain,v.decode_on_the_fly=t.decode_on_the_fly,v.decode_on_the_fly&&(v.findPeakSample=!0),v.findReplayGain&&l0.InitGainAnalysis(v.rgdata,t.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return t.internal_flags=null,-6;switch(v.decode_on_the_fly&&!t.decode_only&&(v.hip!=null&&I.hip_decode_exit(v.hip),v.hip=I.hip_decode_init()),v.mode_gr=t.out_samplerate<=24e3?1:2,t.framesize=576*v.mode_gr,t.encoder_delay=K0.ENCDELAY,v.resample_ratio=t.in_samplerate/t.out_samplerate,t.VBR){case V0.vbr_mt:case V0.vbr_rh:case V0.vbr_mtrh:{var d0=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];t.compression_ratio=d0[t.VBR_q]}break;case V0.vbr_abr:t.compression_ratio=t.out_samplerate*16*v.channels_out/(1e3*t.VBR_mean_bitrate_kbps);break;default:t.compression_ratio=t.out_samplerate*16*v.channels_out/(1e3*t.brate);break}if(t.mode==x.NOT_SET&&(t.mode=x.JOINT_STEREO),t.highpassfreq>0?(v.highpass1=2*t.highpassfreq,t.highpasswidth>=0?v.highpass2=2*(t.highpassfreq+t.highpasswidth):v.highpass2=1*2*t.highpassfreq,v.highpass1/=t.out_samplerate,v.highpass2/=t.out_samplerate):(v.highpass1=0,v.highpass2=0),t.lowpassfreq>0?(v.lowpass2=2*t.lowpassfreq,t.lowpasswidth>=0?(v.lowpass1=2*(t.lowpassfreq-t.lowpasswidth),v.lowpass1<0&&(v.lowpass1=0)):v.lowpass1=1*2*t.lowpassfreq,v.lowpass1/=t.out_samplerate,v.lowpass2/=t.out_samplerate):(v.lowpass1=0,v.lowpass2=0),B(t),v.samplerate_index=S(t.out_samplerate,t),v.samplerate_index<0)return t.internal_flags=null,-1;if(t.VBR==V0.vbr_off){if(t.free_format)v.bitrate_index=0;else if(t.brate=w(t.brate,t.version,t.out_samplerate),v.bitrate_index=l(t.brate,t.version,t.out_samplerate),v.bitrate_index<=0)return t.internal_flags=null,-1}else v.bitrate_index=1;t.analysis&&(t.bWriteVbrTag=!1),v.pinfo!=null&&(t.bWriteVbrTag=!1),q.init_bit_stream_w(v);for(var c0=v.samplerate_index+3*t.version+6*(t.out_samplerate<16e3?1:0),i0=0;i0<K0.SBMAX_l+1;i0++)v.scalefac_band.l[i0]=j.sfBandIndex[c0].l[i0];for(var i0=0;i0<K0.PSFB21+1;i0++){var y0=(v.scalefac_band.l[22]-v.scalefac_band.l[21])/K0.PSFB21,Z0=v.scalefac_band.l[21]+i0*y0;v.scalefac_band.psfb21[i0]=Z0}v.scalefac_band.psfb21[K0.PSFB21]=576;for(var i0=0;i0<K0.SBMAX_s+1;i0++)v.scalefac_band.s[i0]=j.sfBandIndex[c0].s[i0];for(var i0=0;i0<K0.PSFB12+1;i0++){var y0=(v.scalefac_band.s[13]-v.scalefac_band.s[12])/K0.PSFB12,Z0=v.scalefac_band.s[12]+i0*y0;v.scalefac_band.psfb12[i0]=Z0}v.scalefac_band.psfb12[K0.PSFB12]=192,t.version==1?v.sideinfo_len=v.channels_out==1?21:36:v.sideinfo_len=v.channels_out==1?13:21,t.error_protection&&(v.sideinfo_len+=2),_(t),v.Class_ID=c;{var T0;for(T0=0;T0<19;T0++)v.nsPsy.pefirbuf[T0]=700*v.mode_gr*v.channels_out;t.ATHtype==-1&&(t.ATHtype=4)}switch(X1(t.VBR_q<=9),X1(t.VBR_q>=0),t.VBR){case V0.vbr_mt:t.VBR=V0.vbr_mtrh;case V0.vbr_mtrh:{t.useTemporal==null&&(t.useTemporal=!1),r0.apply_preset(t,500-t.VBR_q*10,0),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),t.quality<5&&(t.quality=0),t.quality>5&&(t.quality=5),v.PSY.mask_adjust=t.maskingadjust,v.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?v.sfb21_extra=!1:v.sfb21_extra=t.out_samplerate>44e3,v.iteration_loop=new VBRNewIterationLoop(n0);break}case V0.vbr_rh:{r0.apply_preset(t,500-t.VBR_q*10,0),v.PSY.mask_adjust=t.maskingadjust,v.PSY.mask_adjust_short=t.maskingadjust_short,t.experimentalY?v.sfb21_extra=!1:v.sfb21_extra=t.out_samplerate>44e3,t.quality>6&&(t.quality=6),t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),v.iteration_loop=new VBROldIterationLoop(n0);break}default:{var q0;v.sfb21_extra=!1,t.quality<0&&(t.quality=LAME_DEFAULT_QUALITY),q0=t.VBR,q0==V0.vbr_off&&(t.VBR_mean_bitrate_kbps=t.brate),r0.apply_preset(t,t.VBR_mean_bitrate_kbps,0),t.VBR=q0,v.PSY.mask_adjust=t.maskingadjust,v.PSY.mask_adjust_short=t.maskingadjust_short,q0==V0.vbr_off?v.iteration_loop=new T2(n0):v.iteration_loop=new ABRIterationLoop(n0);break}}if(X1(t.scale>=0),t.VBR!=V0.vbr_off){if(v.VBR_min_bitrate=1,v.VBR_max_bitrate=14,t.out_samplerate<16e3&&(v.VBR_max_bitrate=8),t.VBR_min_bitrate_kbps!=0&&(t.VBR_min_bitrate_kbps=w(t.VBR_min_bitrate_kbps,t.version,t.out_samplerate),v.VBR_min_bitrate=l(t.VBR_min_bitrate_kbps,t.version,t.out_samplerate),v.VBR_min_bitrate<0)||t.VBR_max_bitrate_kbps!=0&&(t.VBR_max_bitrate_kbps=w(t.VBR_max_bitrate_kbps,t.version,t.out_samplerate),v.VBR_max_bitrate=l(t.VBR_max_bitrate_kbps,t.version,t.out_samplerate),v.VBR_max_bitrate<0))return-1;t.VBR_min_bitrate_kbps=$1.bitrate_table[t.version][v.VBR_min_bitrate],t.VBR_max_bitrate_kbps=$1.bitrate_table[t.version][v.VBR_max_bitrate],t.VBR_mean_bitrate_kbps=Math.min($1.bitrate_table[t.version][v.VBR_max_bitrate],t.VBR_mean_bitrate_kbps),t.VBR_mean_bitrate_kbps=Math.max($1.bitrate_table[t.version][v.VBR_min_bitrate],t.VBR_mean_bitrate_kbps)}return t.tune&&(v.PSY.mask_adjust+=t.tune_value_a,v.PSY.mask_adjust_short+=t.tune_value_a),s(t),X1(t.scale>=0),t.athaa_type<0?v.ATH.useAdjust=3:v.ATH.useAdjust=t.athaa_type,v.ATH.aaSensitivityP=Math.pow(10,t.athaa_sensitivity/-10),t.short_blocks==null&&(t.short_blocks=Ea.short_block_allowed),t.short_blocks==Ea.short_block_allowed&&(t.mode==x.JOINT_STEREO||t.mode==x.STEREO)&&(t.short_blocks=Ea.short_block_coupled),t.quant_comp<0&&(t.quant_comp=1),t.quant_comp_short<0&&(t.quant_comp_short=0),t.msfix<0&&(t.msfix=0),t.exp_nspsytune=t.exp_nspsytune|1,t.internal_flags.nsPsy.attackthre<0&&(t.internal_flags.nsPsy.attackthre=ya.NSATTACKTHRE),t.internal_flags.nsPsy.attackthre_s<0&&(t.internal_flags.nsPsy.attackthre_s=ya.NSATTACKTHRE_S),X1(t.scale>=0),t.scale<0&&(t.scale=1),t.ATHtype<0&&(t.ATHtype=4),t.ATHcurve<0&&(t.ATHcurve=4),t.athaa_loudapprox<0&&(t.athaa_loudapprox=2),t.interChRatio<0&&(t.interChRatio=0),t.useTemporal==null&&(t.useTemporal=!0),v.slot_lag=v.frac_SpF=0,t.VBR==V0.vbr_off&&(v.slot_lag=v.frac_SpF=(t.version+1)*72e3*t.brate%t.out_samplerate|0),j.iteration_init(t),o0.psymodel_init(t),X1(t.scale>=0),0};function a(t,v){(t.in_buffer_0==null||t.in_buffer_nsamples<v)&&(t.in_buffer_0=xe(v),t.in_buffer_1=xe(v),t.in_buffer_nsamples=v)}this.lame_encode_flush=function(t,v,z,W){var e0=t.internal_flags,s0=w2([2,1152]),b0=0,u0,d0,c0,i0,y0=e0.mf_samples_to_encode-K0.POSTDELAY,Z0=r(t);if(e0.mf_samples_to_encode<1)return 0;for(u0=0,t.in_samplerate!=t.out_samplerate&&(y0+=16*t.out_samplerate/t.in_samplerate),c0=t.framesize-y0%t.framesize,c0<576&&(c0+=t.framesize),t.encoder_padding=c0,i0=(y0+c0)/t.framesize;i0>0&&b0>=0;){var T0=Z0-e0.mf_size,q0=t.frameNum;T0*=t.in_samplerate,T0/=t.out_samplerate,T0>1152&&(T0=1152),T0<1&&(T0=1),d0=W-u0,W==0&&(d0=0),b0=this.lame_encode_buffer(t,s0[0],s0[1],T0,v,z,d0),z+=b0,u0+=b0,i0-=q0!=t.frameNum?1:0}if(e0.mf_samples_to_encode=0,b0<0||(d0=W-u0,W==0&&(d0=0),q.flush_bitstream(t),b0=q.copy_buffer(e0,v,z,d0,1),b0<0))return b0;if(z+=b0,u0+=b0,d0=W-u0,W==0&&(d0=0),t.write_id3tag_automatic){if(T.id3tag_write_v1(t),b0=q.copy_buffer(e0,v,z,d0,0),b0<0)return b0;u0+=b0}return u0},this.lame_encode_buffer=function(t,v,z,W,e0,s0,b0){var u0=t.internal_flags,d0=[null,null];if(u0.Class_ID!=c)return-3;if(W==0)return 0;a(u0,W),d0[0]=u0.in_buffer_0,d0[1]=u0.in_buffer_1;for(var c0=0;c0<W;c0++)d0[0][c0]=v[c0],u0.channels_in>1&&(d0[1][c0]=z[c0]);return n(t,d0[0],d0[1],W,e0,s0,b0)};function r(t){var v=K0.BLKSIZE+t.framesize-K0.FFTOFFSET;return v=Math.max(v,512+t.framesize-32),X1(qe.MFSIZE>=v),v}function n(t,v,z,W,e0,s0,b0){var u0=t.internal_flags,d0=0,c0,i0,y0,Z0,T0,q0=[null,null],X0=[null,null];if(u0.Class_ID!=c)return-3;if(W==0)return 0;if(T0=q.copy_buffer(u0,e0,s0,b0,0),T0<0)return T0;if(s0+=T0,d0+=T0,X0[0]=v,X0[1]=z,Me.NEQ(t.scale,0)&&Me.NEQ(t.scale,1))for(i0=0;i0<W;++i0)X0[0][i0]*=t.scale,u0.channels_out==2&&(X0[1][i0]*=t.scale);if(Me.NEQ(t.scale_left,0)&&Me.NEQ(t.scale_left,1))for(i0=0;i0<W;++i0)X0[0][i0]*=t.scale_left;if(Me.NEQ(t.scale_right,0)&&Me.NEQ(t.scale_right,1))for(i0=0;i0<W;++i0)X0[1][i0]*=t.scale_right;if(t.num_channels==2&&u0.channels_out==1)for(i0=0;i0<W;++i0)X0[0][i0]=.5*(X0[0][i0]+X0[1][i0]),X0[1][i0]=0;Z0=r(t),q0[0]=u0.mfbuf[0],q0[1]=u0.mfbuf[1];for(var P0=0;W>0;){var $0=[null,null],K1=0,n1=0;$0[0]=X0[0],$0[1]=X0[1];var i1=new d;if(t0(t,q0,$0,P0,W,i1),K1=i1.n_in,n1=i1.n_out,u0.findReplayGain&&!u0.decode_on_the_fly&&l0.AnalyzeSamples(u0.rgdata,q0[0],u0.mf_size,q0[1],u0.mf_size,n1,u0.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(W-=K1,P0+=K1,u0.channels_out==2,u0.mf_size+=n1,X1(u0.mf_size<=qe.MFSIZE),u0.mf_samples_to_encode<1&&(u0.mf_samples_to_encode=K0.ENCDELAY+K0.POSTDELAY),u0.mf_samples_to_encode+=n1,u0.mf_size>=Z0){var Z1=b0-d0;if(b0==0&&(Z1=0),c0=i(t,q0[0],q0[1],e0,s0,Z1),c0<0)return c0;for(s0+=c0,d0+=c0,u0.mf_size-=t.framesize,u0.mf_samples_to_encode-=t.framesize,y0=0;y0<u0.channels_out;y0++)for(i0=0;i0<u0.mf_size;i0++)q0[y0][i0]=q0[y0][i0+t.framesize]}}return X1(W==0),d0}function i(t,v,z,W,e0,s0){var b0=F.enc.lame_encode_mp3_frame(t,v,z,W,e0,s0);return t.frameNum++,b0}function d(){this.n_in=0,this.n_out=0}function E(){this.num_used=0}function M(t,v){return v!=0?M(v,t%v):t}function L(t,v,z){var W=Math.PI*v;t/=z,t<0&&(t=0),t>1&&(t=1);var e0=t-.5,s0=.42-.5*Math.cos(2*t*Math.PI)+.08*Math.cos(4*t*Math.PI);return Math.abs(e0)<1e-9?W/Math.PI:s0*Math.sin(z*W*e0)/(Math.PI*z*e0)}function Q(t,v,z,W,e0,s0,b0,u0,d0){var c0=t.internal_flags,i0,y0=0,Z0,T0=t.out_samplerate/M(t.out_samplerate,t.in_samplerate);T0>qe.BPC&&(T0=qe.BPC);var q0=Math.abs(c0.resample_ratio-Math.floor(.5+c0.resample_ratio))<1e-4?1:0,X0=1/c0.resample_ratio;X0>1&&(X0=1);var P0=31;P0%2==0&&--P0,P0+=q0;var $0=P0+1;if(c0.fill_buffer_resample_init==0){for(c0.inbuf_old[0]=xe($0),c0.inbuf_old[1]=xe($0),i0=0;i0<=2*T0;++i0)c0.blackfilt[i0]=xe($0);for(c0.itime[0]=0,c0.itime[1]=0,y0=0;y0<=2*T0;y0++){var K1=0,n1=(y0-T0)/(2*T0);for(i0=0;i0<=P0;i0++)K1+=c0.blackfilt[y0][i0]=L(i0-n1,X0,P0);for(i0=0;i0<=P0;i0++)c0.blackfilt[y0][i0]/=K1}c0.fill_buffer_resample_init=1}var i1=c0.inbuf_old[d0];for(Z0=0;Z0<W;Z0++){var Z1,se;if(Z1=Z0*c0.resample_ratio,y0=0|Math.floor(Z1-c0.itime[d0]),P0+y0-P0/2>=b0)break;var n1=Z1-c0.itime[d0]-(y0+.5*(P0%2));X1(Math.abs(n1)<=.501),se=0|Math.floor(n1*2*T0+T0+.5);var _e=0;for(i0=0;i0<=P0;++i0){var s1=0|i0+y0-P0/2,_1;X1(s1<b0),X1(s1+$0>=0),_1=s1<0?i1[$0+s1]:e0[s0+s1],_e+=_1*c0.blackfilt[se][i0]}v[z+Z0]=_e}if(u0.num_used=Math.min(b0,P0+y0-P0/2),c0.itime[d0]+=u0.num_used-Z0*c0.resample_ratio,u0.num_used>=$0)for(i0=0;i0<$0;i0++)i1[i0]=e0[s0+u0.num_used+i0-$0];else{var le=$0-u0.num_used;for(i0=0;i0<le;++i0)i1[i0]=i1[i0+u0.num_used];for(y0=0;i0<$0;++i0,++y0)i1[i0]=e0[s0+y0];X1(y0==u0.num_used)}return Z0}function t0(t,v,z,W,e0,s0){var b0=t.internal_flags;if(b0.resample_ratio<.9999||b0.resample_ratio>1.0001)for(var u0=0;u0<b0.channels_out;u0++){var d0=new E;s0.n_out=Q(t,v[u0],b0.mf_size,t.framesize,z[u0],W,e0,d0,u0),s0.n_in=d0.num_used}else{s0.n_out=Math.min(t.framesize,e0),s0.n_in=s0.n_out;for(var c0=0;c0<s0.n_out;++c0)v[0][b0.mf_size+c0]=z[0][W+c0],b0.channels_out==2&&(v[1][b0.mf_size+c0]=z[1][W+c0])}}}$r.exports=j0});var et=I0((W_,gr)=>{"use strict";function I2(){var x,F;this.setModules=function(G,Y){x=G,F=Y}}gr.exports=I2});var rt=I0((z_,at)=>{"use strict";function p2(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}at.exports=p2});var it=I0((J_,nt)=>{"use strict";var Ta=k0(),tt=Ta.new_float,L2=Ta.new_int,j_=Ta.assert;function V2(){this.global_gain=0,this.sfb_count1=0,this.step=L2(39),this.noise=tt(39),this.noise_log=tt(39)}nt.exports=V2});var ot=I0((s3,vt)=>{"use strict";var L1=k0(),ie=L1.System,st=L1.VbrMode,$_=L1.Float,g_=L1.ShortBlock,Ia=L1.Util,Te=L1.Arrays,e3=L1.new_array_n,a3=L1.new_byte,r3=L1.new_double,Xe=L1.new_float,t3=L1.new_float_n,n3=L1.new_int,i3=L1.new_int_n,U1=L1.assert,N2=et(),pa=rt(),H2=it(),L0=a1(),_t=Pe(),lt=Ce();function O2(){var x;this.rv=null;var F;this.qupvt=null;var G,Y=new N2,l0;this.setModules=function(c,o,b,N){x=c,F=o,this.rv=o,G=b,this.qupvt=b,l0=N,Y.setModules(G,l0)},this.ms_convert=function(c,o){for(var b=0;b<576;++b){var N=c.tt[o][0].xr[b],S=c.tt[o][1].xr[b];c.tt[o][0].xr[b]=(N+S)*(Ia.SQRT2*.5),c.tt[o][1].xr[b]=(N-S)*(Ia.SQRT2*.5)}};function q(c,o,b,N){N=0;for(var S=0;S<=b;++S){var w=Math.abs(c.xr[S]);N+=w,o[S]=Math.sqrt(w*Math.sqrt(w)),o[S]>c.xrpow_max&&(c.xrpow_max=o[S])}return N}this.init_xrpow=function(c,o,b){var N=0,S=0|o.max_nonzero_coeff;if(U1(b!=null),o.xrpow_max=0,U1(0<=S&&S<=575),Te.fill(b,S,576,0),N=q(o,b,S,N),N>1e-20){var w=0;(c.substep_shaping&2)!=0&&(w=1);for(var l=0;l<o.psymax;l++)c.pseudohalf[l]=w;return!0}return Te.fill(o.l3_enc,0,576,0),!1};function r0(c,o){var b=c.ATH,N=o.xr;if(o.block_type!=L0.SHORT_TYPE)for(var S=!1,w=L0.PSFB21-1;w>=0&&!S;w--){var l=c.scalefac_band.psfb21[w],u=c.scalefac_band.psfb21[w+1],B=G.athAdjust(b.adjust,b.psfb21[w],b.floor);c.nsPsy.longfact[21]>1e-12&&(B*=c.nsPsy.longfact[21]);for(var s=u-1;s>=l;s--)if(Math.abs(N[s])<B)N[s]=0;else{S=!0;break}}else for(var _=0;_<3;_++)for(var S=!1,w=L0.PSFB12-1;w>=0&&!S;w--){var l=c.scalefac_band.s[12]*3+(c.scalefac_band.s[13]-c.scalefac_band.s[12])*_+(c.scalefac_band.psfb12[w]-c.scalefac_band.psfb12[0]),u=l+(c.scalefac_band.psfb12[w+1]-c.scalefac_band.psfb12[w]),a=G.athAdjust(b.adjust,b.psfb12[w],b.floor);c.nsPsy.shortfact[12]>1e-12&&(a*=c.nsPsy.shortfact[12]);for(var s=u-1;s>=l;s--)if(Math.abs(N[s])<a)N[s]=0;else{S=!0;break}}}this.init_outer_loop=function(c,o){o.part2_3_length=0,o.big_values=0,o.count1=0,o.global_gain=210,o.scalefac_compress=0,o.table_select[0]=0,o.table_select[1]=0,o.table_select[2]=0,o.subblock_gain[0]=0,o.subblock_gain[1]=0,o.subblock_gain[2]=0,o.subblock_gain[3]=0,o.region0_count=0,o.region1_count=0,o.preflag=0,o.scalefac_scale=0,o.count1table_select=0,o.part2_length=0,o.sfb_lmax=L0.SBPSY_l,o.sfb_smin=L0.SBPSY_s,o.psy_lmax=c.sfb21_extra?L0.SBMAX_l:L0.SBPSY_l,o.psymax=o.psy_lmax,o.sfbmax=o.sfb_lmax,o.sfbdivide=11;for(var b=0;b<L0.SBMAX_l;b++)o.width[b]=c.scalefac_band.l[b+1]-c.scalefac_band.l[b],o.window[b]=3;if(o.block_type==L0.SHORT_TYPE){var N=Xe(576);o.sfb_smin=0,o.sfb_lmax=0,o.mixed_block_flag!=0&&(o.sfb_smin=3,o.sfb_lmax=c.mode_gr*2+4),o.psymax=o.sfb_lmax+3*((c.sfb21_extra?L0.SBMAX_s:L0.SBPSY_s)-o.sfb_smin),o.sfbmax=o.sfb_lmax+3*(L0.SBPSY_s-o.sfb_smin),o.sfbdivide=o.sfbmax-18,o.psy_lmax=o.sfb_lmax;var S=c.scalefac_band.l[o.sfb_lmax];ie.arraycopy(o.xr,0,N,0,576);for(var b=o.sfb_smin;b<L0.SBMAX_s;b++)for(var w=c.scalefac_band.s[b],l=c.scalefac_band.s[b+1],u=0;u<3;u++)for(var B=w;B<l;B++)o.xr[S++]=N[3*B+u];for(var s=o.sfb_lmax,b=o.sfb_smin;b<L0.SBMAX_s;b++)o.width[s]=o.width[s+1]=o.width[s+2]=c.scalefac_band.s[b+1]-c.scalefac_band.s[b],o.window[s]=0,o.window[s+1]=1,o.window[s+2]=2,s+=3}o.count1bits=0,o.sfb_partition_table=G.nr_of_sfb_block[0][0],o.slen[0]=0,o.slen[1]=0,o.slen[2]=0,o.slen[3]=0,o.max_nonzero_coeff=575,Te.fill(o.scalefac,0),r0(c,o)};function j(c){this.ordinal=c}j.BINSEARCH_NONE=new j(0),j.BINSEARCH_UP=new j(1),j.BINSEARCH_DOWN=new j(2);function n0(c,o,b,N,S){var w,l=c.CurrentStep[N],u=!1,B=c.OldValue[N],s=j.BINSEARCH_NONE;for(o.global_gain=B,b-=o.part2_length,U1(l!=0);;){var _;if(w=l0.count_bits(c,S,o,null),l==1||w==b)break;w>b?(s==j.BINSEARCH_DOWN&&(u=!0),u&&(l/=2),s=j.BINSEARCH_UP,_=l):(s==j.BINSEARCH_UP&&(u=!0),u&&(l/=2),s=j.BINSEARCH_DOWN,_=-l),o.global_gain+=_,o.global_gain<0&&(o.global_gain=0,u=!0),o.global_gain>255&&(o.global_gain=255,u=!0)}for(U1(o.global_gain>=0),U1(o.global_gain<256);w>b&&o.global_gain<255;)o.global_gain++,w=l0.count_bits(c,S,o,null);return c.CurrentStep[N]=B-o.global_gain>=4?4:2,c.OldValue[N]=o.global_gain,o.part2_3_length=w,w}this.trancate_smallspectrums=function(c,o,b,N){var S=Xe(lt.SFBMAX);if(!((c.substep_shaping&4)==0&&o.block_type==L0.SHORT_TYPE||(c.substep_shaping&128)!=0)){G.calc_noise(o,b,S,new pa,null);for(var l=0;l<576;l++){var w=0;o.l3_enc[l]!=0&&(w=Math.abs(o.xr[l])),N[l]=w}var l=0,u=8;o.block_type==L0.SHORT_TYPE&&(u=6);do{var B,s,_,a,r=o.width[u];if(l+=r,!(S[u]>=1)&&(Te.sort(N,l-r,r),!BitStream.EQ(N[l-1],0))){B=(1-S[u])*b[u],s=0,a=0;do{var n;for(_=1;a+_<r&&!BitStream.NEQ(N[a+l-r],N[a+l+_-r]);_++);if(n=N[a+l-r]*N[a+l-r]*_,B<n){a!=0&&(s=N[a+l-r-1]);break}B-=n,a+=_}while(a<r);if(!BitStream.EQ(s,0))do Math.abs(o.xr[l-r])<=s&&(o.l3_enc[l-r]=0);while(--r>0)}}while(++u<o.psymax);o.part2_3_length=l0.noquant_count_bits(c,o,null)}};function o0(c){for(var o=0;o<c.sfbmax;o++)if(c.scalefac[o]+c.subblock_gain[c.window[o]]==0)return!1;return!0}function V(c){return Ia.FAST_LOG10(.368+.632*c*c*c)}function U(c,o){for(var b=1e-37,N=0;N<o.psymax;N++)b+=V(c[N]);return Math.max(1e-20,b)}function T(c,o,b,N,S){var w;switch(c){default:case 9:{o.over_count>0?(w=b.over_SSD<=o.over_SSD,b.over_SSD==o.over_SSD&&(w=b.bits<o.bits)):w=b.max_noise<0&&b.max_noise*10+b.bits<=o.max_noise*10+o.bits;break}case 0:w=b.over_count<o.over_count||b.over_count==o.over_count&&b.over_noise<o.over_noise||b.over_count==o.over_count&&BitStream.EQ(b.over_noise,o.over_noise)&&b.tot_noise<o.tot_noise;break;case 8:b.max_noise=U(S,N);case 1:w=b.max_noise<o.max_noise;break;case 2:w=b.tot_noise<o.tot_noise;break;case 3:w=b.tot_noise<o.tot_noise&&b.max_noise<o.max_noise;break;case 4:w=b.max_noise<=0&&o.max_noise>.2||b.max_noise<=0&&o.max_noise<0&&o.max_noise>b.max_noise-.2&&b.tot_noise<o.tot_noise||b.max_noise<=0&&o.max_noise>0&&o.max_noise>b.max_noise-.2&&b.tot_noise<o.tot_noise+o.over_noise||b.max_noise>0&&o.max_noise>-.05&&o.max_noise>b.max_noise-.1&&b.tot_noise+b.over_noise<o.tot_noise+o.over_noise||b.max_noise>0&&o.max_noise>-.1&&o.max_noise>b.max_noise-.15&&b.tot_noise+b.over_noise+b.over_noise<o.tot_noise+o.over_noise+o.over_noise;break;case 5:w=b.over_noise<o.over_noise||BitStream.EQ(b.over_noise,o.over_noise)&&b.tot_noise<o.tot_noise;break;case 6:w=b.over_noise<o.over_noise||BitStream.EQ(b.over_noise,o.over_noise)&&(b.max_noise<o.max_noise||BitStream.EQ(b.max_noise,o.max_noise)&&b.tot_noise<=o.tot_noise);break;case 7:w=b.over_count<o.over_count||b.over_noise<o.over_noise;break}return o.over_count==0&&(w=w&&b.bits<o.bits),w}function I(c,o,b,N,S){var w=c.internal_flags,l;o.scalefac_scale==0?l=1.2968395546510096:l=1.6817928305074292;for(var u=0,B=0;B<o.sfbmax;B++)u<b[B]&&(u=b[B]);var s=w.noise_shaping_amp;switch(s==3&&(S?s=2:s=1),s){case 2:break;case 1:u>1?u=Math.pow(u,.5):u*=.95;break;case 0:default:u>1?u=1:u*=.95;break}for(var _=0,B=0;B<o.sfbmax;B++){var a=o.width[B],r;if(_+=a,!(b[B]<u)){if((w.substep_shaping&2)!=0&&(w.pseudohalf[B]=w.pseudohalf[B]==0?1:0,w.pseudohalf[B]==0&&w.noise_shaping_amp==2))return;for(o.scalefac[B]++,r=-a;r<0;r++)N[_+r]*=l,N[_+r]>o.xrpow_max&&(o.xrpow_max=N[_+r]);if(w.noise_shaping_amp==2)return}}}function e(c,o){for(var b=1.2968395546510096,N=0,S=0;S<c.sfbmax;S++){var w=c.width[S],l=c.scalefac[S];if(c.preflag!=0&&(l+=G.pretab[S]),N+=w,(l&1)!=0){l++;for(var u=-w;u<0;u++)o[N+u]*=b,o[N+u]>c.xrpow_max&&(c.xrpow_max=o[N+u])}c.scalefac[S]=l>>1}c.preflag=0,c.scalefac_scale=1}function R(c,o,b){var N,S=o.scalefac;for(N=0;N<o.sfb_lmax;N++)if(S[N]>=16)return!0;for(var w=0;w<3;w++){var l=0,u=0;for(N=o.sfb_lmax+w;N<o.sfbdivide;N+=3)l<S[N]&&(l=S[N]);for(;N<o.sfbmax;N+=3)u<S[N]&&(u=S[N]);if(!(l<16&&u<8)){if(o.subblock_gain[w]>=7)return!0;o.subblock_gain[w]++;var B=c.scalefac_band.l[o.sfb_lmax];for(N=o.sfb_lmax+w;N<o.sfbmax;N+=3){var s,_=o.width[N],a=S[N];if(U1(a>=0),a=a-(4>>o.scalefac_scale),a>=0){S[N]=a,B+=_*3;continue}S[N]=0;{var r=210+(a<<o.scalefac_scale+1);s=G.IPOW20(r)}B+=_*(w+1);for(var n=-_;n<0;n++)b[B+n]*=s,b[B+n]>o.xrpow_max&&(o.xrpow_max=b[B+n]);B+=_*(3-w-1)}{var s=G.IPOW20(202);B+=o.width[N]*(w+1);for(var n=-o.width[N];n<0;n++)b[B+n]*=s,b[B+n]>o.xrpow_max&&(o.xrpow_max=b[B+n])}}}return!1}function m(c,o,b,N,S){var w=c.internal_flags;I(c,o,b,N,S);var l=o0(o);return l?!1:(w.mode_gr==2?l=l0.scale_bitcount(o):l=l0.scale_bitcount_lsf(w,o),l?(w.noise_shaping>1&&(Te.fill(w.pseudohalf,0),o.scalefac_scale==0?(e(o,N),l=!1):o.block_type==L0.SHORT_TYPE&&w.subblock_gain>0&&(l=R(w,o,N)||o0(o))),l||(w.mode_gr==2?l=l0.scale_bitcount(o):l=l0.scale_bitcount_lsf(w,o)),!l):!0)}this.outer_loop=function(c,o,b,N,S,w){var l=c.internal_flags,u=new _t,B=Xe(576),s=Xe(lt.SFBMAX),_=new pa,a,r=new H2,n=9999999,i=!1,d=!1,E=0;if(n0(l,o,w,S,N),l.noise_shaping==0)return 100;G.calc_noise(o,b,s,_,r),_.bits=o.part2_3_length,u.assign(o);var M=0;for(ie.arraycopy(N,0,B,0,576);!i;){do{var L=new pa,Q,t0=255;if((l.substep_shaping&2)!=0?Q=20:Q=3,l.sfb21_extra&&(s[u.sfbmax]>1||u.block_type==L0.SHORT_TYPE&&(s[u.sfbmax+1]>1||s[u.sfbmax+2]>1))||!m(c,u,s,N,d))break;u.scalefac_scale!=0&&(t0=254);var t=w-u.part2_length;if(t<=0)break;for(;(u.part2_3_length=l0.count_bits(l,N,u,r))>t&&u.global_gain<=t0;)u.global_gain++;if(u.global_gain>t0)break;if(_.over_count==0){for(;(u.part2_3_length=l0.count_bits(l,N,u,r))>n&&u.global_gain<=t0;)u.global_gain++;if(u.global_gain>t0)break}if(G.calc_noise(u,b,s,L,r),L.bits=u.part2_3_length,o.block_type!=L0.SHORT_TYPE?a=c.quant_comp:a=c.quant_comp_short,a=T(a,_,L,u,s)?1:0,a!=0)n=o.part2_3_length,_=L,o.assign(u),M=0,ie.arraycopy(N,0,B,0,576);else if(l.full_outer_loop==0&&(++M>Q&&_.over_count==0||l.noise_shaping_amp==3&&d&&M>30||l.noise_shaping_amp==3&&d&&u.global_gain-E>15))break}while(u.global_gain+u.scalefac_scale<255);l.noise_shaping_amp==3?d?i=!0:(u.assign(o),ie.arraycopy(B,0,N,0,576),M=0,E=u.global_gain,d=!0):i=!0}return U1(o.global_gain+o.scalefac_scale<=255),c.VBR==st.vbr_rh||c.VBR==st.vbr_mtrh?ie.arraycopy(B,0,N,0,576):(l.substep_shaping&1)!=0&&trancate_smallspectrums(l,o,b,N),_.over_count},this.iteration_finish_one=function(c,o,b){var N=c.l3_side,S=N.tt[o][b];l0.best_scalefac_store(c,o,b,N),c.use_best_huffman==1&&l0.best_huffman_divide(c,S),F.ResvAdjust(c,S)},this.VBR_encode_granule=function(c,o,b,N,S,w,l){var u=c.internal_flags,B=new _t,s=Xe(576),_=l,a=l+1,r=(l+w)/2,n,i,d=0,E=u.sfb21_extra;U1(_<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Te.fill(B.l3_enc,0);do U1(r>=w),U1(r<=l),U1(w<=l),r>_-42?u.sfb21_extra=!1:u.sfb21_extra=E,i=outer_loop(c,o,b,N,S,r),i<=0?(d=1,a=o.part2_3_length,B.assign(o),ie.arraycopy(N,0,s,0,576),l=a-32,n=l-w,r=(l+w)/2):(w=r+32,n=l-w,r=(l+w)/2,d!=0&&(d=2,o.assign(B),ie.arraycopy(s,0,N,0,576)));while(n>12);u.sfb21_extra=E,d==2&&ie.arraycopy(B.l3_enc,0,o.l3_enc,0,576),U1(o.part2_3_length<=_)},this.get_framebits=function(c,o){var b=c.internal_flags;b.bitrate_index=b.VBR_min_bitrate;var N=x.getframebits(c);b.bitrate_index=1,N=x.getframebits(c);for(var S=1;S<=b.VBR_max_bitrate;S++){b.bitrate_index=S;var w=new MeanBits(N);o[S]=F.ResvFrameBegin(c,w),N=w.bits}},this.VBR_old_prepare=function(c,o,b,N,S,w,l,u,B){var s=c.internal_flags,_,a=0,r=1,n=0;s.bitrate_index=s.VBR_max_bitrate;var i=F.ResvFrameBegin(c,new MeanBits(0))/s.mode_gr;get_framebits(c,w);for(var d=0;d<s.mode_gr;d++){var E=G.on_pe(c,o,u[d],i,d,0);s.mode_ext==L0.MPG_MD_MS_LR&&(ms_convert(s.l3_side,d),G.reduce_side(u[d],b[d],i,E));for(var M=0;M<s.channels_out;++M){var L=s.l3_side.tt[d][M];L.block_type!=L0.SHORT_TYPE?(a=1.28/(1+Math.exp(3.5-o[d][M]/300))-.05,_=s.PSY.mask_adjust-a):(a=2.56/(1+Math.exp(3.5-o[d][M]/300))-.14,_=s.PSY.mask_adjust_short-a),s.masking_lower=Math.pow(10,_*.1),init_outer_loop(s,L),B[d][M]=G.calc_xmin(c,N[d][M],L,S[d][M]),B[d][M]!=0&&(r=0),l[d][M]=126,n+=u[d][M]}}for(var d=0;d<s.mode_gr;d++)for(var M=0;M<s.channels_out;M++)n>w[s.VBR_max_bitrate]&&(u[d][M]*=w[s.VBR_max_bitrate],u[d][M]/=n),l[d][M]>u[d][M]&&(l[d][M]=u[d][M]);return r},this.bitpressure_strategy=function(c,o,b,N){for(var S=0;S<c.mode_gr;S++)for(var w=0;w<c.channels_out;w++){for(var l=c.l3_side.tt[S][w],u=o[S][w],B=0,s=0;s<l.psy_lmax;s++)u[B++]*=1+.029*s*s/L0.SBMAX_l/L0.SBMAX_l;if(l.block_type==L0.SHORT_TYPE)for(var s=l.sfb_smin;s<L0.SBMAX_s;s++)u[B++]*=1+.029*s*s/L0.SBMAX_s/L0.SBMAX_s,u[B++]*=1+.029*s*s/L0.SBMAX_s/L0.SBMAX_s,u[B++]*=1+.029*s*s/L0.SBMAX_s/L0.SBMAX_s;N[S][w]=0|Math.max(b[S][w],.9*N[S][w])}},this.VBR_new_prepare=function(c,o,b,N,S,w){var l=c.internal_flags,u=1,B=0,s=0,_;if(c.free_format){l.bitrate_index=0;var a=new MeanBits(B);_=F.ResvFrameBegin(c,a),B=a.bits,S[0]=_}else{l.bitrate_index=l.VBR_max_bitrate;var a=new MeanBits(B);F.ResvFrameBegin(c,a),B=a.bits,get_framebits(c,S),_=S[l.VBR_max_bitrate]}for(var r=0;r<l.mode_gr;r++){G.on_pe(c,o,w[r],B,r,0),l.mode_ext==L0.MPG_MD_MS_LR&&ms_convert(l.l3_side,r);for(var n=0;n<l.channels_out;++n){var i=l.l3_side.tt[r][n];l.masking_lower=Math.pow(10,l.PSY.mask_adjust*.1),init_outer_loop(l,i),G.calc_xmin(c,b[r][n],i,N[r][n])!=0&&(u=0),s+=w[r][n]}}for(var r=0;r<l.mode_gr;r++)for(var n=0;n<l.channels_out;n++)s>_&&(w[r][n]*=_,w[r][n]/=s);return u},this.calc_target_bits=function(c,o,b,N,S,w){var l=c.internal_flags,u=l.l3_side,B,s,_,a,r=0;l.bitrate_index=l.VBR_max_bitrate;var n=new MeanBits(r);for(w[0]=F.ResvFrameBegin(c,n),r=n.bits,l.bitrate_index=1,r=x.getframebits(c)-l.sideinfo_len*8,S[0]=r/(l.mode_gr*l.channels_out),r=c.VBR_mean_bitrate_kbps*c.framesize*1e3,(l.substep_shaping&1)!=0&&(r*=1.09),r/=c.out_samplerate,r-=l.sideinfo_len*8,r/=l.mode_gr*l.channels_out,B=.93+.07*(11-c.compression_ratio)/(11-5.5),B<.9&&(B=.9),B>1&&(B=1),s=0;s<l.mode_gr;s++){var i=0;for(_=0;_<l.channels_out;_++){if(N[s][_]=int(B*r),o[s][_]>700){var d=int((o[s][_]-700)/1.4),E=u.tt[s][_];N[s][_]=int(B*r),E.block_type==L0.SHORT_TYPE&&d<r/2&&(d=r/2),d>r*3/2?d=r*3/2:d<0&&(d=0),N[s][_]+=d}N[s][_]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(N[s][_]=LameInternalFlags.MAX_BITS_PER_CHANNEL),i+=N[s][_]}if(i>LameInternalFlags.MAX_BITS_PER_GRANULE)for(_=0;_<l.channels_out;++_)N[s][_]*=LameInternalFlags.MAX_BITS_PER_GRANULE,N[s][_]/=i}if(l.mode_ext==L0.MPG_MD_MS_LR)for(s=0;s<l.mode_gr;s++)G.reduce_side(N[s],b[s],r*l.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(a=0,s=0;s<l.mode_gr;s++)for(_=0;_<l.channels_out;_++)N[s][_]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(N[s][_]=LameInternalFlags.MAX_BITS_PER_CHANNEL),a+=N[s][_];if(a>w[0])for(s=0;s<l.mode_gr;s++)for(_=0;_<l.channels_out;_++)N[s][_]*=w[0],N[s][_]/=a}}vt.exports=O2});var ft=I0((m3,ht)=>{"use strict";var V1=k0(),C2=V1.System,La=V1.VbrMode,_3=V1.Float,ut=V1.ShortBlock,l3=V1.Util,F2=V1.Arrays,v3=V1.new_array_n,ta=V1.new_byte,o3=V1.new_double,u3=V1.new_float,h3=V1.new_float_n,f3=V1.new_int,b3=V1.new_int_n,k2=V1.assert;Ye.NUMTOCENTRIES=100;Ye.MAXFRAMESIZE=2880;function Ye(){var x,F,G;this.setModules=function(r,n,i){x=r,F=n,G=i};var Y=1,l0=2,q=4,r0=8,j=Ye.NUMTOCENTRIES,n0=Ye.MAXFRAMESIZE,o0=j+4+4+4+4+4,V=o0+9+1+1+8+1+1+3+1+1+2+4+2+2,U=128,T=64,I=32,e=null,R="Xing",m="Info",c=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function o(r,n){if(r.nVbrNumFrames++,r.sum+=n,r.seen++,!(r.seen<r.want)&&(r.pos<r.size&&(r.bag[r.pos]=r.sum,r.pos++,r.seen=0),r.pos==r.size)){for(var i=1;i<r.size;i+=2)r.bag[i/2]=r.bag[i];r.want*=2,r.pos/=2}}function b(r,n){if(!(r.pos<=0))for(var i=1;i<j;++i){var d=i/j,E,M,L=0|Math.floor(d*r.pos);L>r.pos-1&&(L=r.pos-1),E=r.bag[L],M=r.sum;var Q=0|256*E/M;Q>255&&(Q=255),n[i]=255&Q}}this.addVbrFrame=function(r){var n=r.internal_flags,i=Tables.bitrate_table[r.version][n.bitrate_index];k2(n.VBR_seek_table.bag!=null),o(n.VBR_seek_table,i)};function N(r,n){var i=r[n+0]&255;return i<<=8,i|=r[n+1]&255,i<<=8,i|=r[n+2]&255,i<<=8,i|=r[n+3]&255,i}function S(r,n,i){r[n+0]=255&(i>>24&255),r[n+1]=255&(i>>16&255),r[n+2]=255&(i>>8&255),r[n+3]=255&(i&255)}function w(r,n,i){r[n+0]=255&(i>>8&255),r[n+1]=255&(i&255)}function l(r,n){return new String(r,n,R.length(),e).equals(R)||new String(r,n,m.length(),e).equals(m)}function u(r,n,i){return 255&(r<<n|i&~(-1<<n))}function B(r,n){var i=r.internal_flags;n[0]=u(n[0],8,255),n[1]=u(n[1],3,7),n[1]=u(n[1],1,r.out_samplerate<16e3?0:1),n[1]=u(n[1],1,r.version),n[1]=u(n[1],2,1),n[1]=u(n[1],1,r.error_protection?0:1),n[2]=u(n[2],4,i.bitrate_index),n[2]=u(n[2],2,i.samplerate_index),n[2]=u(n[2],1,0),n[2]=u(n[2],1,r.extension),n[3]=u(n[3],2,r.mode.ordinal()),n[3]=u(n[3],2,i.mode_ext),n[3]=u(n[3],1,r.copyright),n[3]=u(n[3],1,r.original),n[3]=u(n[3],2,r.emphasis),n[0]=255;var d=255&(n[1]&241),E;r.version==1?E=U:r.out_samplerate<16e3?E=I:E=T,r.VBR==La.vbr_off&&(E=r.brate);var M;r.free_format?M=0:M=255&16*x.BitrateIndex(E,r.version,r.out_samplerate),r.version==1?(n[1]=255&(d|10),d=255&(n[2]&13),n[2]=255&(M|d)):(n[1]=255&(d|2),d=255&(n[2]&13),n[2]=255&(M|d))}this.getVbrTag=function(r){var n=new VBRTagData,i=0;n.flags=0;var d=r[i+1]>>3&1,E=r[i+2]>>2&3,M=r[i+3]>>6&3,L=r[i+2]>>4&15;if(L=Tables.bitrate_table[d][L],r[i+1]>>4==14?n.samprate=Tables.samplerate_table[2][E]:n.samprate=Tables.samplerate_table[d][E],d!=0?M!=3?i+=36:i+=21:M!=3?i+=21:i+=13,!l(r,i))return null;i+=4,n.hId=d;var Q=n.flags=N(r,i);if(i+=4,(Q&Y)!=0&&(n.frames=N(r,i),i+=4),(Q&l0)!=0&&(n.bytes=N(r,i),i+=4),(Q&q)!=0){if(n.toc!=null)for(var t0=0;t0<j;t0++)n.toc[t0]=r[i+t0];i+=j}n.vbrScale=-1,(Q&r0)!=0&&(n.vbrScale=N(r,i),i+=4),n.headersize=(d+1)*72e3*L/n.samprate,i+=21;var t=r[i+0]<<4;t+=r[i+1]>>4;var v=(r[i+1]&15)<<8;return v+=r[i+2]&255,(t<0||t>3e3)&&(t=-1),(v<0||v>3e3)&&(v=-1),n.encDelay=t,n.encPadding=v,n},this.InitVbrTag=function(r){var n=r.internal_flags,i;r.version==1?i=U:r.out_samplerate<16e3?i=I:i=T,r.VBR==La.vbr_off&&(i=r.brate);var d=(r.version+1)*72e3*i/r.out_samplerate,E=n.sideinfo_len+V;if(n.VBR_seek_table.TotalFrameSize=d,d<E||d>n0){r.bWriteVbrTag=!1;return}n.VBR_seek_table.nVbrNumFrames=0,n.VBR_seek_table.nBytesWritten=0,n.VBR_seek_table.sum=0,n.VBR_seek_table.seen=0,n.VBR_seek_table.want=1,n.VBR_seek_table.pos=0,n.VBR_seek_table.bag==null&&(n.VBR_seek_table.bag=new int[400],n.VBR_seek_table.size=400);var M=ta(n0);B(r,M);for(var L=n.VBR_seek_table.TotalFrameSize,Q=0;Q<L;++Q)F.add_dummy_byte(r,M[Q]&255,1)};function s(r,n){var i=n^r;return n=n>>8^c[i&255],n}this.updateMusicCRC=function(r,n,i,d){for(var E=0;E<d;++E)r[0]=s(n[i+E],r[0])};function _(r,n,i,d,E){var M=r.internal_flags,L=0,Q=r.encoder_delay,t0=r.encoder_padding,t=100-10*r.VBR_q-r.quality,v=G.getLameVeryShortVersion(),z,W=0,e0,s0=[1,5,3,2,4,0,3],b0=0|(r.lowpassfreq/100+.5>255?255:r.lowpassfreq/100+.5),u0=0,d0=0,c0=0,i0=r.internal_flags.noise_shaping,y0=0,Z0=0,T0=0,q0=0,X0=0,P0=(r.exp_nspsytune&1)!=0,$0=(r.exp_nspsytune&2)!=0,K1=!1,n1=!1,i1=r.internal_flags.nogap_total,Z1=r.internal_flags.nogap_current,se=r.ATHtype,_e=0,s1;switch(r.VBR){case vbr_abr:s1=r.VBR_mean_bitrate_kbps;break;case vbr_off:s1=r.brate;break;default:s1=r.VBR_min_bitrate_kbps}switch(r.VBR.ordinal()<s0.length?z=s0[r.VBR.ordinal()]:z=0,e0=16*W+z,M.findReplayGain&&(M.RadioGain>510&&(M.RadioGain=510),M.RadioGain<-510&&(M.RadioGain=-510),d0=8192,d0|=3072,M.RadioGain>=0?d0|=M.RadioGain:(d0|=512,d0|=-M.RadioGain)),M.findPeakSample&&(u0=Math.abs(0|M.PeakSample/32767*Math.pow(2,23)+.5)),i1!=-1&&(Z1>0&&(n1=!0),Z1<i1-1&&(K1=!0)),_e=se+((P0?1:0)<<4)+(($0?1:0)<<5)+((K1?1:0)<<6)+((n1?1:0)<<7),t<0&&(t=0),r.mode){case MONO:y0=0;break;case STEREO:y0=1;break;case DUAL_CHANNEL:y0=2;break;case JOINT_STEREO:r.force_ms?y0=4:y0=3;break;case NOT_SET:default:y0=7;break}r.in_samplerate<=32e3?T0=0:r.in_samplerate==48e3?T0=2:r.in_samplerate>48e3?T0=3:T0=1,(r.short_blocks==ut.short_block_forced||r.short_blocks==ut.short_block_dispensed||r.lowpassfreq==-1&&r.highpassfreq==-1||r.scale_left<r.scale_right||r.scale_left>r.scale_right||r.disable_reservoir&&r.brate<320||r.noATH||r.ATHonly||se==0||r.in_samplerate<=32e3)&&(Z0=1),q0=i0+(y0<<2)+(Z0<<5)+(T0<<6),X0=M.nMusicCRC,S(i,d+L,t),L+=4;for(var _1=0;_1<9;_1++)i[d+L+_1]=255&v.charAt(_1);L+=9,i[d+L]=255&e0,L++,i[d+L]=255&b0,L++,S(i,d+L,u0),L+=4,w(i,d+L,d0),L+=2,w(i,d+L,c0),L+=2,i[d+L]=255&_e,L++,s1>=255?i[d+L]=255:i[d+L]=255&s1,L++,i[d+L]=255&Q>>4,i[d+L+1]=255&(Q<<4)+(t0>>8),i[d+L+2]=255&t0,L+=3,i[d+L]=255&q0,L++,i[d+L++]=0,w(i,d+L,r.preset),L+=2,S(i,d+L,n),L+=4,w(i,d+L,X0),L+=2;for(var le=0;le<L;le++)E=s(i[d+le],E);return w(i,d+L,E),L+=2,L}function a(r){r.seek(0);var n=ta(10);r.readFully(n);var i;return new String(n,"ISO-8859-1").startsWith("ID3")?i=0:i=((n[6]&127)<<21|(n[7]&127)<<14|(n[8]&127)<<7|n[9]&127)+n.length,i}this.getLameTagFrame=function(r,n){var i=r.internal_flags;if(!r.bWriteVbrTag||i.Class_ID!=Lame.LAME_ID||i.VBR_seek_table.pos<=0)return 0;if(n.length<i.VBR_seek_table.TotalFrameSize)return i.VBR_seek_table.TotalFrameSize;F2.fill(n,0,i.VBR_seek_table.TotalFrameSize,0),B(r,n);var d=ta(j);if(r.free_format)for(var E=1;E<j;++E)d[E]=255&255*E/100;else b(i.VBR_seek_table,d);var M=i.sideinfo_len;r.error_protection&&(M-=2),r.VBR==La.vbr_off?(n[M++]=255&m.charAt(0),n[M++]=255&m.charAt(1),n[M++]=255&m.charAt(2),n[M++]=255&m.charAt(3)):(n[M++]=255&R.charAt(0),n[M++]=255&R.charAt(1),n[M++]=255&R.charAt(2),n[M++]=255&R.charAt(3)),S(n,M,Y+l0+q+r0),M+=4,S(n,M,i.VBR_seek_table.nVbrNumFrames),M+=4;var L=i.VBR_seek_table.nBytesWritten+i.VBR_seek_table.TotalFrameSize;S(n,M,0|L),M+=4,C2.arraycopy(d,0,n,M,d.length),M+=d.length,r.error_protection&&F.CRC_writeheader(i,n);for(var Q=0,E=0;E<M;E++)Q=s(n[E],Q);return M+=_(r,L,n,M,Q),i.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(r,n){var i=r.internal_flags;if(i.VBR_seek_table.pos<=0||(n.seek(n.length()),n.length()==0))return-1;var d=a(n);n.seek(d);var E=ta(n0),M=getLameTagFrame(r,E);return M>E.length?-1:(M<1||n.write(E,0,M),0)}}ht.exports=Ye});var mt=I0((c3,bt)=>{"use strict";function q2(){var x="http://www.mp3dev.org/",F=3,G=98,Y=4,l0=0,q=93;this.getLameVersion=function(){return F+"."+G+"."+Y},this.getLameShortVersion=function(){return F+"."+G+"."+Y},this.getLameVeryShortVersion=function(){return"LAME"+F+"."+G+"r"},this.getPsyVersion=function(){return l0+"."+q},this.getLameUrl=function(){return x},this.getLameOsBitness=function(){return"32bits"}}bt.exports=q2});var ct=I0(()=>{"use strict"});var dt=I0((A3,St)=>{"use strict";var X2=k0(),na=X2.assert;function Y2(){var x;this.setModules=function(F){x=F},this.ResvFrameBegin=function(F,G){var Y=F.internal_flags,l0,q=Y.l3_side,r0=x.getframebits(F);G.bits=(r0-Y.sideinfo_len*8)/Y.mode_gr;var j=8*256*Y.mode_gr-8;F.brate>320?l0=8*int(F.brate*1e3/(F.out_samplerate/1152)/8+.5):(l0=8*1440,F.strict_ISO&&(l0=8*int(32e4/(F.out_samplerate/1152)/8+.5))),Y.ResvMax=l0-r0,Y.ResvMax>j&&(Y.ResvMax=j),(Y.ResvMax<0||F.disable_reservoir)&&(Y.ResvMax=0);var n0=G.bits*Y.mode_gr+Math.min(Y.ResvSize,Y.ResvMax);return n0>l0&&(n0=l0),na(Y.ResvMax%8==0),na(Y.ResvMax>=0),q.resvDrain_pre=0,Y.pinfo!=null&&(Y.pinfo.mean_bits=G.bits/2,Y.pinfo.resvsize=Y.ResvSize),n0},this.ResvMaxBits=function(F,G,Y,l0){var q=F.internal_flags,r0,j=q.ResvSize,n0=q.ResvMax;l0!=0&&(j+=G),(q.substep_shaping&1)!=0&&(n0*=.9),Y.bits=G,j*10>n0*9?(r0=j-n0*9/10,Y.bits+=r0,q.substep_shaping|=128):(r0=0,q.substep_shaping&=127,!F.disable_reservoir&&(q.substep_shaping&1)==0&&(Y.bits-=.1*G));var o0=j<q.ResvMax*6/10?j:q.ResvMax*6/10;return o0-=r0,o0<0&&(o0=0),o0},this.ResvAdjust=function(F,G){F.ResvSize-=G.part2_3_length+G.part2_length},this.ResvFrameEnd=function(F,G){var Y,l0=F.l3_side;F.ResvSize+=G*F.mode_gr;var q=0;l0.resvDrain_post=0,l0.resvDrain_pre=0,(Y=F.ResvSize%8)!=0&&(q+=Y),Y=F.ResvSize-q-F.ResvMax,Y>0&&(na(Y%8==0),na(Y>=0),q+=Y);{var r0=Math.min(l0.main_data_begin*8,q)/8;l0.resvDrain_pre+=8*r0,q-=8*r0,F.ResvSize-=8*r0,l0.main_data_begin-=r0}l0.resvDrain_post+=q,F.ResvSize-=q}}St.exports=Y2});var xt=I0((H3,At)=>{"use strict";var N1=k0(),x3=N1.System,g1=N1.VbrMode,M3=N1.Float,R3=N1.ShortBlock,w3=N1.Util,B3=N1.Arrays,E3=N1.new_array_n,y3=N1.new_byte,T3=N1.new_double,I3=N1.new_float,p3=N1.new_float_n,L3=N1.new_int,V3=N1.new_int_n,N3=N1.assert;function D2(){var x=ra();function F(V,U,T,I,e,R,m,c,o,b,N,S,w,l,u){this.vbr_q=V,this.quant_comp=U,this.quant_comp_s=T,this.expY=I,this.st_lrm=e,this.st_s=R,this.masking_adj=m,this.masking_adj_short=c,this.ath_lower=o,this.ath_curve=b,this.ath_sensitivity=N,this.interch=S,this.safejoint=w,this.sfb21mod=l,this.msfix=u}function G(V,U,T,I,e,R,m,c,o,b,N,S,w,l){this.quant_comp=U,this.quant_comp_s=T,this.safejoint=I,this.nsmsfix=e,this.st_lrm=R,this.st_s=m,this.nsbass=c,this.scale=o,this.masking_adj=b,this.ath_lower=N,this.ath_curve=S,this.interch=w,this.sfscale=l}var Y;this.setModules=function(V){Y=V};var l0=[new F(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new F(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new F(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new F(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new F(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new F(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new F(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new F(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new F(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new F(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new F(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],q=[new F(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new F(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new F(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new F(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new F(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new F(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new F(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new F(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new F(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new F(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new F(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function r0(V,U,T){var I=V.VBR==g1.vbr_rh?l0:q,e=V.VBR_q_frac,R=I[U],m=I[U+1],c=R;R.st_lrm=R.st_lrm+e*(m.st_lrm-R.st_lrm),R.st_s=R.st_s+e*(m.st_s-R.st_s),R.masking_adj=R.masking_adj+e*(m.masking_adj-R.masking_adj),R.masking_adj_short=R.masking_adj_short+e*(m.masking_adj_short-R.masking_adj_short),R.ath_lower=R.ath_lower+e*(m.ath_lower-R.ath_lower),R.ath_curve=R.ath_curve+e*(m.ath_curve-R.ath_curve),R.ath_sensitivity=R.ath_sensitivity+e*(m.ath_sensitivity-R.ath_sensitivity),R.interch=R.interch+e*(m.interch-R.interch),R.msfix=R.msfix+e*(m.msfix-R.msfix),o0(V,c.vbr_q),T!=0?V.quant_comp=c.quant_comp:Math.abs(V.quant_comp- -1)>0||(V.quant_comp=c.quant_comp),T!=0?V.quant_comp_short=c.quant_comp_s:Math.abs(V.quant_comp_short- -1)>0||(V.quant_comp_short=c.quant_comp_s),c.expY!=0&&(V.experimentalY=c.expY!=0),T!=0?V.internal_flags.nsPsy.attackthre=c.st_lrm:Math.abs(V.internal_flags.nsPsy.attackthre- -1)>0||(V.internal_flags.nsPsy.attackthre=c.st_lrm),T!=0?V.internal_flags.nsPsy.attackthre_s=c.st_s:Math.abs(V.internal_flags.nsPsy.attackthre_s- -1)>0||(V.internal_flags.nsPsy.attackthre_s=c.st_s),T!=0?V.maskingadjust=c.masking_adj:Math.abs(V.maskingadjust-0)>0||(V.maskingadjust=c.masking_adj),T!=0?V.maskingadjust_short=c.masking_adj_short:Math.abs(V.maskingadjust_short-0)>0||(V.maskingadjust_short=c.masking_adj_short),T!=0?V.ATHlower=-c.ath_lower/10:Math.abs(-V.ATHlower*10-0)>0||(V.ATHlower=-c.ath_lower/10),T!=0?V.ATHcurve=c.ath_curve:Math.abs(V.ATHcurve- -1)>0||(V.ATHcurve=c.ath_curve),T!=0?V.athaa_sensitivity=c.ath_sensitivity:Math.abs(V.athaa_sensitivity- -1)>0||(V.athaa_sensitivity=c.ath_sensitivity),c.interch>0&&(T!=0?V.interChRatio=c.interch:Math.abs(V.interChRatio- -1)>0||(V.interChRatio=c.interch)),c.safejoint>0&&(V.exp_nspsytune=V.exp_nspsytune|c.safejoint),c.sfb21mod>0&&(V.exp_nspsytune=V.exp_nspsytune|c.sfb21mod<<20),T!=0?V.msfix=c.msfix:Math.abs(V.msfix- -1)>0||(V.msfix=c.msfix),T==0&&(V.VBR_q=U,V.VBR_q_frac=e)}var j=[new G(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new G(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new G(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new G(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new G(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new G(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new G(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new G(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new G(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new G(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new G(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new G(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new G(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new G(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new G(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new G(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new G(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function n0(V,U,T){var I=U,e=Y.nearestBitrateFullIndex(U);if(V.VBR=g1.vbr_abr,V.VBR_mean_bitrate_kbps=I,V.VBR_mean_bitrate_kbps=Math.min(V.VBR_mean_bitrate_kbps,320),V.VBR_mean_bitrate_kbps=Math.max(V.VBR_mean_bitrate_kbps,8),V.brate=V.VBR_mean_bitrate_kbps,V.VBR_mean_bitrate_kbps>320&&(V.disable_reservoir=!0),j[e].safejoint>0&&(V.exp_nspsytune=V.exp_nspsytune|2),j[e].sfscale>0&&(V.internal_flags.noise_shaping=2),Math.abs(j[e].nsbass)>0){var R=int(j[e].nsbass*4);R<0&&(R+=64),V.exp_nspsytune=V.exp_nspsytune|R<<2}return T!=0?V.quant_comp=j[e].quant_comp:Math.abs(V.quant_comp- -1)>0||(V.quant_comp=j[e].quant_comp),T!=0?V.quant_comp_short=j[e].quant_comp_s:Math.abs(V.quant_comp_short- -1)>0||(V.quant_comp_short=j[e].quant_comp_s),T!=0?V.msfix=j[e].nsmsfix:Math.abs(V.msfix- -1)>0||(V.msfix=j[e].nsmsfix),T!=0?V.internal_flags.nsPsy.attackthre=j[e].st_lrm:Math.abs(V.internal_flags.nsPsy.attackthre- -1)>0||(V.internal_flags.nsPsy.attackthre=j[e].st_lrm),T!=0?V.internal_flags.nsPsy.attackthre_s=j[e].st_s:Math.abs(V.internal_flags.nsPsy.attackthre_s- -1)>0||(V.internal_flags.nsPsy.attackthre_s=j[e].st_s),T!=0?V.scale=j[e].scale:Math.abs(V.scale- -1)>0||(V.scale=j[e].scale),T!=0?V.maskingadjust=j[e].masking_adj:Math.abs(V.maskingadjust-0)>0||(V.maskingadjust=j[e].masking_adj),j[e].masking_adj>0?T!=0?V.maskingadjust_short=j[e].masking_adj*.9:Math.abs(V.maskingadjust_short-0)>0||(V.maskingadjust_short=j[e].masking_adj*.9):T!=0?V.maskingadjust_short=j[e].masking_adj*1.1:Math.abs(V.maskingadjust_short-0)>0||(V.maskingadjust_short=j[e].masking_adj*1.1),T!=0?V.ATHlower=-j[e].ath_lower/10:Math.abs(-V.ATHlower*10-0)>0||(V.ATHlower=-j[e].ath_lower/10),T!=0?V.ATHcurve=j[e].ath_curve:Math.abs(V.ATHcurve- -1)>0||(V.ATHcurve=j[e].ath_curve),T!=0?V.interChRatio=j[e].interch:Math.abs(V.interChRatio- -1)>0||(V.interChRatio=j[e].interch),U}this.apply_preset=function(V,U,T){switch(U){case x.R3MIX:{U=x.V3,V.VBR=g1.vbr_mtrh;break}case x.MEDIUM:{U=x.V4,V.VBR=g1.vbr_rh;break}case x.MEDIUM_FAST:{U=x.V4,V.VBR=g1.vbr_mtrh;break}case x.STANDARD:{U=x.V2,V.VBR=g1.vbr_rh;break}case x.STANDARD_FAST:{U=x.V2,V.VBR=g1.vbr_mtrh;break}case x.EXTREME:{U=x.V0,V.VBR=g1.vbr_rh;break}case x.EXTREME_FAST:{U=x.V0,V.VBR=g1.vbr_mtrh;break}case x.INSANE:return U=320,V.preset=U,n0(V,U,T),V.VBR=g1.vbr_off,U}switch(V.preset=U,U){case x.V9:return r0(V,9,T),U;case x.V8:return r0(V,8,T),U;case x.V7:return r0(V,7,T),U;case x.V6:return r0(V,6,T),U;case x.V5:return r0(V,5,T),U;case x.V4:return r0(V,4,T),U;case x.V3:return r0(V,3,T),U;case x.V2:return r0(V,2,T),U;case x.V1:return r0(V,1,T),U;case x.V0:return r0(V,0,T),U;default:break}return 8<=U&&U<=320?n0(V,U,T):(V.preset=0,U)};function o0(V,U){var T=0;return 0>U&&(T=-1,U=0),9<U&&(T=-1,U=9),V.VBR_q=U,V.VBR_q_frac=0,T}}At.exports=D2});var fa=(q=>(q[q.STEREO=0]="STEREO",q[q.JOINT_STEREO=1]="JOINT_STEREO",q[q.DUAL_CHANNEL=2]="DUAL_CHANNEL",q[q.MONO=3]="MONO",q[q.NOT_SET=4]="NOT_SET",q))(fa||{});var G2=ra(),U2=ge(),K2=da(),Z2=ot(),P2=ft(),Q2=mt(),W2=ct(),z2=dt(),j2=wa(),J2=Ma(),$2=xt(),Va=class{constructor(F){let G=new G2,Y=new K2,l0=new U2,q=new $2,r0=new J2,j=new Z2,n0=new P2,o0=new Q2,V=new W2,U=new z2,T=new j2;if(G.setModules(Y,l0,q,r0,j,n0,o0,V),l0.setModules(Y,o0,n0),V.setModules(l0,o0),q.setModules(G),j.setModules(l0,U,r0,T),r0.setModules(T,U,G.enc.psy),U.setModules(l0),T.setModules(r0),n0.setModules(G,l0,o0),this.lame=G,this.gfp=G.lame_init(),this.gfp.num_channels=F.channels,this.gfp.in_samplerate=F.sampleRate,this.gfp.brate=F.bitRate,this.gfp.mode=F.mode||0,this.gfp.quality=F.quality||3,this.gfp.bWriteVbrTag=!1,this.gfp.disable_reservoir=!0,this.gfp.write_id3tag_automatic=!1,G.lame_init_params(this.gfp)!==0)throw new Error("Failed to initialize LAME encoder");this.maxSamples=F.maxBuffer||1152,this.mp3buf_size=Math.floor(1.25*this.maxSamples+7200),this.mp3buf=new Uint8Array(this.mp3buf_size)}encodeBuffer(F,G){if(this.gfp.num_channels===1&&(G=F),!G)throw new Error("Right channel required for stereo");if(F.length!==G.length)throw new Error("Left and right channels must be same length");F.length>this.maxSamples&&(this.maxSamples=F.length,this.mp3buf_size=Math.floor(1.25*this.maxSamples+7200),this.mp3buf=new Uint8Array(this.mp3buf_size));let Y=this.lame.lame_encode_buffer(this.gfp,F,G,F.length,this.mp3buf,0,this.mp3buf_size);return new Int8Array(this.mp3buf.subarray(0,Y))}flush(){let F=this.lame.lame_encode_flush(this.gfp,this.mp3buf,0,this.mp3buf_size);return new Int8Array(this.mp3buf.subarray(0,F))}close(){this.gfp&&(this.lame.lame_close(this.gfp),this.gfp=null)}};export{fa as MPEGMode,Va as Mp3Encoder};
//# sourceMappingURL=index.mjs.map